Rules by Product and UseCase
============================
Vendor: Amazon
--------------
### Product: [AWS CloudTrail](../ds_amazon_aws_cloudtrail.md)
### Use-Case: [Privilege Escalation](../../../../UseCases/uc_privilege_escalation.md)

| Rules | Models | MITRE ATT&CK® TTPs | Activity Types | Parsers |
|:-----:|:------:|:------------------:|:--------------:|:-------:|
|  21   |   14   |         5          |       9        |    9    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| app-activity    | <b>T1098.002 - Account Manipulation: Exchange Email Delegate Permissions</b><br> ↳ <b>EM-InB-Ex</b>: A user has been given mailbox permissions for an executive user<br> ↳ <b>EM-InB-Perm-N-F</b>: First time a user has given mailbox permissions on another mailbox that is not their own<br> ↳ <b>EM-InB-Perm-N-A</b>: Abnormal for user to give mailbox permissions    |  • <b>EM-InB-Perm-N</b>: Models users who give mailbox permissions    |
| aws-policy-attach    | <b>TA0004 - TA0004</b><br> ↳ <b>AWS-AdminPolicyAttach</b>: A critical policy with admin permissions was attached to an identity in AWS    |    |
| aws-policy-write    | <b>TA0004 - TA0004</b><br> ↳ <b>AWS-AdminPolicy</b>: A critical policy with admin permissions was created in AWS<br> ↳ <b>AWS-UserCreatePolicyAdmin-Org-F</b>: First time this user created an administrative policy in AWS    |  • <b>AWS-UserCreatePolicyAdmin-Org</b>: AWS users who created a critical policy    |
| aws-role-assume    | <b>TA0004 - TA0004</b><br> ↳ <b>AWS-AssumedRoles-User-F</b>: First time this user assumed this role in AWS<br> ↳ <b>AWS-AssumingUsers-Role-F</b>: First time this role was assumed by this user in AWS    |  • <b>AWS-AssumingUsers-Role</b>: AWS user that assumed a role<br> • <b>AWS-AssumedRoles-User</b>: AWS roles the user assumed/switched    |
| aws-role-assumepolicy          | <b>TA0004 - TA0004</b><br> ↳ <b>AWS-RolePublicPolicy-Org-F</b>: First time this role was made public in AWS    |  • <b>AWS-RolePublicPolicy-Org</b>: AWS roles who were given a public assume policy    |
| failed-logon    | <b>T1210 - Exploitation of Remote Services</b><br> ↳ <b>A-Suspicious-Zerologon</b>: Failed authentication attempt on this asset.    |    |
| gcp-policy-write    | <b>TA0004 - TA0004</b><br> ↳ <b>GCP-SetIAMAdmin</b>: A cloud resource policy in GCP was modified with high permissions<br> ↳ <b>GCP-UserSetPolicy-Org-F</b>: First time IAM policy modification for user<br> ↳ <b>GCP-UserSetPolicyCritical-Org-F</b>: First time critical IAM policy modification for user<br> ↳ <b>GCP-ResourceSetPolicy-Org-F</b>: First time IAM policy modification for resource<br> ↳ <b>GCP-ResourceSetPolicyCritical-Org-F</b>: First time critical IAM policy modification for resource<br> ↳ <b>GCP-UserSetPolicy-Resource-F</b>: First time IAM policy modification for user on this resource<br> ↳ <b>GCP-DomainSetPolicy-Org-F</b>: First time domain seen in IAM policy modification<br> ↳ <b>GCP-MemberTypeSetPolicy-Org-F</b>: First time user type seen in IAM policy modification<br><br><b>T1530 - Data from Cloud Storage Object</b><br> ↳ <b>GCP-SetIAMPublic</b>: A cloud resource in GCP was set to public<br> ↳ <b>GCP-IAMPublicFound</b>: A public IAM policy was found on cloud resource in GCP |  • <b>GCP-MemberTypeSetPolicy-Org</b>: User type in GCP policy modifications<br> • <b>GCP-DomainSetPolicy-Org</b>: User domains in GCP policy modifications<br> • <b>GCP-UserSetPolicy-Resource</b>: Users who modified IAM policies of resource in GCP<br> • <b>GCP-ResourceSetPolicyCritical-Org</b>: IAM policy critically modified for GCP resources<br> • <b>GCP-ResourceSetPolicy-Org</b>: IAM policy modified for GCP resources<br> • <b>GCP-UserSetPolicyCritical-Org</b>: Users who modified IAM policies in GCP and added critical roles<br> • <b>GCP-UserSetPolicy-Org</b>: Users who modified IAM policies in GCP |
| gcp-role-list    | <b>TA0007 - TA0007</b><br> ↳ <b>GCP-UserRoleList-Org-F</b>: First time role enumeration for user    |  • <b>GCP-UserRoleList-Org</b>: Users who enumerated IAM roles in GCP    |
| gcp-serviceaccount-creds-write | <b>TA0004 - TA0004</b><br> ↳ <b>GCP-UserCreateServiceAccountCreds-Org-F</b>: First time service account key/token creation for user    |  • <b>GCP-UserCreateServiceAccountCreds-Org</b>: Users who created/uploaded service acccount keys and tokens in GCP    |