Rules by Product and UseCase
============================
Vendor: Microsoft
-----------------
### Product: [Sysmon](../ds_microsoft_sysmon.md)
### Use-Case: [Account Manipulation](../../../../UseCases/uc_account_manipulation.md)

| Rules | Models | MITRE ATT&CK® TTPs | Activity Types | Parsers |
|:-----:|:------:|:------------------:|:--------------:|:-------:|
|  47   |   23   |         19         |       3        |   33    |

| Event Type      | Rules    | Models    |
| ---- | ---- | ---- |
| app-activity    | <b>T1098 - Account Manipulation</b><br> ↳ <b>EM-InB-Ex</b>: A user has been given mailbox permissions for an executive user<br> ↳ <b>EM-InB-Perm-N-F</b>: First time a user has given mailbox permissions on another mailbox that is not their own<br> ↳ <b>EM-InB-Perm-N-A</b>: Abnormal for user to give mailbox permissions<br><br><b>T1098.002 - Account Manipulation: Exchange Email Delegate Permissions</b><br> ↳ <b>EM-InB-Ex</b>: A user has been given mailbox permissions for an executive user<br> ↳ <b>EM-InB-Perm-N-F</b>: First time a user has given mailbox permissions on another mailbox that is not their own<br> ↳ <b>EM-InB-Perm-N-A</b>: Abnormal for user to give mailbox permissions    |  • <b>EM-InB-Perm-N</b>: Models users who give mailbox permissions    |
| ds-access       | <b>T1207 - Rogue Domain Controller</b><br> ↳ <b>DS-DCSh-Add</b>: Directory service server object added<br> ↳ <b>DS-DCSh-Del</b>: Directory service server object created and deleted<br> ↳ <b>A-DS-Replication</b>: First time a new server replicated itself on this asset<br><br><b>T1484 - Group Policy Modification</b><br> ↳ <b>DS-OU-F</b>: First directory service event for user in the organization<br> ↳ <b>DS-OG-F</b>: First directory service event for user in the peer group<br> ↳ <b>DS-OAT-F</b>: First directory service activity type for object class<br> ↳ <b>DS-OAT-A</b>: Abnormal directory service activity type for object class<br> ↳ <b>DS-UAT-F</b>: First directory service activity type for user per object class<br> ↳ <b>DS-UAT-A</b>: Abnormal directory service activity type for user per object class<br> ↳ <b>DS-OOC-F</b>: First directory service object class for organization<br> ↳ <b>DS-OOC-A</b>: Abnormal directory service object class for organization<br> ↳ <b>DS-GOC-F</b>: First directory service object class for peer group<br> ↳ <b>DS-GOC-A</b>: Abnormal directory service object class for peer group<br> ↳ <b>DS-UOC-F</b>: First directory service object class for user<br> ↳ <b>DS-UOC-A</b>: Abnormal directory service object class for user<br> ↳ <b>DS-APRIV</b>: Non-Privileged user accessing privileged directory service attribute<br> ↳ <b>DS-UA</b>: First access to attribute for privileged user<br> ↳ <b>DS-OH-F</b>: First directory service activity on host for organization<br> ↳ <b>DS-OH-A</b>: Abnormal directory service activity on host for organization<br> ↳ <b>DS-GH-F</b>: First directory service activity on host for peer group<br> ↳ <b>DS-GH-A</b>: Abnormal directory service activity on host for peer group<br> ↳ <b>DS-UH-F</b>: First directory service activity on host for user<br> ↳ <b>DS-UH-A</b>: Abnormal directory service activity on host for user<br> ↳ <b>DS-OSZ-F</b>: First directory service activity from source zone for organization<br> ↳ <b>DS-OSZ-A</b>: Abnormal directory service activity from source zone for organization<br> ↳ <b>DS-GSZ-F</b>: First directory service activity from source zone for peer group<br> ↳ <b>DS-GSZ-A</b>: Abnormal directory service activity from source zone for peer group<br> ↳ <b>DS-USZ-F</b>: First directory service activity from source zone for user<br> ↳ <b>DS-USZ-A</b>: Abnormal directory service activity from source zone for user<br> ↳ <b>DS-USH-F</b>: First directory service activity on source host for user<br> ↳ <b>DS-USH-A</b>: Abnormal directory service activity on source host for user    |  • <b>DS-USH</b>: Source hosts with directory service activity for user<br> • <b>DS-USZ</b>: Source network zones with directory service activity for the user<br> • <b>DS-GSZ</b>: Source network zones with directory service activity in the peer group<br> • <b>DS-OSZ</b>: Source network zones with directory service activity in the organization<br> • <b>DS-UH</b>: Hosts with directory service activity in the user<br> • <b>DS-GH</b>: Hosts with directory service activity in the peer group<br> • <b>DS-OH</b>: Hosts with directory service activity in the organization<br> • <b>DS-UA</b>: Attributes per privileged user<br> • <b>DS-APRIV</b>: Privileged user attributes<br> • <b>DS-UOC</b>: Directory service object classes for user<br> • <b>DS-GOC</b>: Directory service object classes in the peer group<br> • <b>DS-OOC</b>: Directory service object classes in the organization<br> • <b>DS-UAT-new</b>: Directory services activity types for user per object class<br> • <b>DS-OAT-new</b>: Directory services activity types per object class<br> • <b>DS-OG</b>: Users with directory service activity in the peer group<br> • <b>DS-OU</b>: Users with directory service activity in the organization |
| process-created | <b>T1021 - Remote Services</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1021.003 - T1021.003</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1059 - Command and Scripting Interperter</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1059.001 - Command and Scripting Interperter: PowerShell</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1059.003 - T1059.003</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1218 - Signed Binary Proxy Execution</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1218.010 - Signed Binary Proxy Execution: Regsvr32</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1559 - Inter-Process Communication</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1559.002 - T1559.002</b><br> ↳ <b>A-MMC-Spawn-Win-Shell</b>: MMC (Microsoft Management Console) started a Windows command line executable on this asset.<br><br><b>T1003 - OS Credential Dumping</b><br> ↳ <b>A-AD-Diagnostic-Tool</b>: Invocation of Active Directory Diagnostic Tool (ntdsutil.exe) on this asset<br> ↳ <b>A-ShadowCP-SymLink</b>: Shadow Copies Access via Symlink on this asset<br><br><b>T1003.003 - T1003.003</b><br> ↳ <b>A-AD-Diagnostic-Tool</b>: Invocation of Active Directory Diagnostic Tool (ntdsutil.exe) on this asset<br><br><b>T1136 - Create Account</b><br> ↳ <b>NET-EXE-ADD-ORG-F</b>: First time net.exe has been used to create a user account by this user.<br> ↳ <b>NET-EXE-ADD-ORG-A</b>: Abnormal usage of net.exe to create a user account by this user.<br> ↳ <b>NET-EXE-ADD-GRP-ORG-F</b>: First time net.exe has been used to create/add to a group by this user.<br> ↳ <b>NET-EXE-ADD-GRP-ORG-A</b>: Abnormal usage of net.exe to create/add to a group by this user.<br> ↳ <b>AC-OZ-CLI-F</b>: First zone on which account was created using CLI command<br> ↳ <b>AC-OH-CLI-F</b>: First host on which account was created using CLI command<br><br><b>T1136.001 - Create Account: Create: Local Account</b><br> ↳ <b>NET-EXE-ADD-ORG-F</b>: First time net.exe has been used to create a user account by this user.<br> ↳ <b>NET-EXE-ADD-ORG-A</b>: Abnormal usage of net.exe to create a user account by this user.<br> ↳ <b>AC-OZ-CLI-F</b>: First zone on which account was created using CLI command<br> ↳ <b>AC-OH-CLI-F</b>: First host on which account was created using CLI command<br><br><b>T1531 - Account Access Removal</b><br> ↳ <b>NET-EXE-DELETE-ORG-F</b>: First time net.exe has been used to delete a user account by this user.<br> ↳ <b>NET-EXE-DELETE-ORG-A</b>: Abnormal usage of net.exe to delete a user account by this user.<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>NET-EXE-ADD-GRP-ORG-F</b>: First time net.exe has been used to create/add to a group by this user.<br> ↳ <b>NET-EXE-ADD-GRP-ORG-A</b>: Abnormal usage of net.exe to create/add to a group by this user.<br> ↳ <b>NET-EXE-ACTIVE-ORG-F</b>: First time net.exe has been used to disable/enable a user account by this user.<br> ↳ <b>NET-EXE-ACTIVE-ORG-A</b>: Abnormal usage of net.exe to disable/enable a user account by this user.<br><br><b>T1098 - Account Manipulation</b><br> ↳ <b>NET-EXE-ADD-GRP-ORG-F</b>: First time net.exe has been used to create/add to a group by this user.<br> ↳ <b>NET-EXE-ADD-GRP-ORG-A</b>: Abnormal usage of net.exe to create/add to a group by this user.<br> ↳ <b>NET-EXE-ACTIVE-ORG-F</b>: First time net.exe has been used to disable/enable a user account by this user.<br> ↳ <b>NET-EXE-ACTIVE-ORG-A</b>: Abnormal usage of net.exe to disable/enable a user account by this user. |  • <b>AC-OH-CLI</b>: Hosts on which account was created using CLI command<br> • <b>AC-OZ-CLI</b>: Zones on which account was created using CLI command<br> • <b>NET-EXE-DELETE-ORG</b>: Using net.exe to delete a user account<br> • <b>NET-EXE-ACTIVE-ORG</b>: Using net.exe to disable/enable a user account<br> • <b>NET-EXE-ADD-GRP-ORG</b>: Using net.exe to add a group account<br> • <b>NET-EXE-ADD-ORG</b>: Using net.exe to add a user account    |