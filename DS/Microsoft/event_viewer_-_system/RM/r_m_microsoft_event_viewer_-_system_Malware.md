Rules by Product and UseCase
============================
Vendor: Microsoft
-----------------
### Product: [Event Viewer - System](../ds_microsoft_event_viewer_-_system.md)
### Use-Case: [Malware](../../../../UseCases/uc_malware.md)

| Rules | Models | MITRE ATT&CK® TTPs | Activity Types | Parsers |
|:-----:|:------:|:------------------:|:--------------:|:-------:|
|  29   |   15   |         12         |       2        |    2    |

| Event Type      | Rules    | Models    |
| ---- | ---- | ---- |
| service-created | <b>T1574 - Hijack Execution Flow</b><br> ↳ <b>A-ServiceName-ServiceCmdline-F</b>: First time binary command line for this service on this asset.<br> ↳ <b>A-ServiceName-ServiceCmdline-A</b>: Abnormal binary command line for this service<br><br><b>T1574.010 - T1574.010</b><br> ↳ <b>A-ServiceName-ServiceCmdline-F</b>: First time binary command line for this service on this asset.<br> ↳ <b>A-ServiceName-ServiceCmdline-A</b>: Abnormal binary command line for this service<br><br><b>T1574.011 - T1574.011</b><br> ↳ <b>A-ServiceName-ServiceCmdline-F</b>: First time binary command line for this service on this asset.<br> ↳ <b>A-ServiceName-ServiceCmdline-A</b>: Abnormal binary command line for this service<br><br><b>TA0002 - TA0002</b><br> ↳ <b>DEF-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user<br> ↳ <b>DEF-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user<br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br><br><b>T1543 - Create or Modify System Process</b><br> ↳ <b>WSC-OH-F</b>: First service installation on host in the organization<br> ↳ <b>WSC-GH-F</b>: First service installation on host in the peer group<br> ↳ <b>WSC-UH-F</b>: First service installation on host by the user<br> ↳ <b>WSC-SP-POWERSHELL</b>: Service created to execute sensitive process<br> ↳ <b>WSC-OZ-F</b>: First service installation in zone for organization<br> ↳ <b>WSC-RANDOM-SERVICE</b>: Random service name found for this user<br> ↳ <b>ChaferAPT-Activity-ServiceCreated</b>: Chafer APT related activity observed, a suspicious service was created<br> ↳ <b>A-WSC-OS-A</b>: Unusual service name installed on the asset in the organization<br> ↳ <b>A-WSC-SP-F</b>: First process executed by the service on this asset<br> ↳ <b>A-WSC-SP-A</b>: Unusual process executed by the service on this asset<br> ↳ <b>A-WSC-UZ-F</b>: First service installation in zone on this asset<br> ↳ <b>A-WSC-F</b>: First service installation activity on asset<br> ↳ <b>A-WSC-DhU-F</b>: First user installing service on this asset<br> ↳ <b>A-WSC-DhU-A</b>: Abnormal user installing service on this asset asset<br> ↳ <b>A-WSC-DhA-F</b>: First account to execute service on this asset<br> ↳ <b>A-WSC-DhA-A</b>: Abnormal account executing service on this asset<br> ↳ <b>A-WSC-SERVICE-PARAMS</b>: Suspicious parameters in service installation process for this asset<br> ↳ <b>A-WSC-SP-Temp</b>: Service created from temporary or cached internet files for this asset<br><br><b>T1543.003 - Create or Modify System Process: Windows Service</b><br> ↳ <b>WSC-OH-F</b>: First service installation on host in the organization<br> ↳ <b>WSC-GH-F</b>: First service installation on host in the peer group<br> ↳ <b>WSC-UH-F</b>: First service installation on host by the user<br> ↳ <b>WSC-GS-A</b>: Unusual service name in the peer group<br> ↳ <b>WSC-US-A</b>: Unusual service name in the user<br> ↳ <b>WSC-SP-POWERSHELL</b>: Service created to execute sensitive process<br> ↳ <b>WSC-OZ-F</b>: First service installation in zone for organization<br> ↳ <b>WSC-RANDOM-SERVICE</b>: Random service name found for this user<br> ↳ <b>ChaferAPT-Activity-ServiceCreated</b>: Chafer APT related activity observed, a suspicious service was created<br> ↳ <b>A-WSC-OS-A</b>: Unusual service name installed on the asset in the organization<br> ↳ <b>A-WSC-SP-F</b>: First process executed by the service on this asset<br> ↳ <b>A-WSC-SP-A</b>: Unusual process executed by the service on this asset<br> ↳ <b>A-WSC-UZ-F</b>: First service installation in zone on this asset<br> ↳ <b>A-WSC-F</b>: First service installation activity on asset<br> ↳ <b>A-WSC-DhU-F</b>: First user installing service on this asset<br> ↳ <b>A-WSC-DhU-A</b>: Abnormal user installing service on this asset asset<br> ↳ <b>A-WSC-DhA-F</b>: First account to execute service on this asset<br> ↳ <b>A-WSC-DhA-A</b>: Abnormal account executing service on this asset<br> ↳ <b>A-WSC-SERVICE-PARAMS</b>: Suspicious parameters in service installation process for this asset<br> ↳ <b>A-WSC-SP-Temp</b>: Service created from temporary or cached internet files for this asset<br><br><b>T1569 - System Services</b><br> ↳ <b>WSC-PSEXEC-F</b>: First service installation Psexec for the user<br> ↳ <b>WSC-PSEXEC-A</b>: Abnormal service installation Psexec for the user<br><br><b>T1569.002 - T1569.002</b><br> ↳ <b>WSC-PSEXEC-F</b>: First service installation Psexec for the user<br> ↳ <b>WSC-PSEXEC-A</b>: Abnormal service installation Psexec for the user<br><br><b>T1036 - Masquerading</b><br> ↳ <b>WSC-RANDOM-SERVICE</b>: Random service name found for this user<br><br><b>T1059 - Command and Scripting Interperter</b><br> ↳ <b>WSC-SP-POWERSHELL</b>: Service created to execute sensitive process<br><br><b>T1059.001 - Command and Scripting Interperter: PowerShell</b><br> ↳ <b>WSC-SP-POWERSHELL</b>: Service created to execute sensitive process<br><br><b>T1053 - Scheduled Task/Job</b><br> ↳ <b>WSC-GS-A</b>: Unusual service name in the peer group<br> ↳ <b>WSC-US-A</b>: Unusual service name in the user |  • <b>A-ServiceName-ServiceCmdline</b>: Service Executable Files on the asset<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset<br> • <b>A-WSC-DhA</b>: Accounts executing services on this asset<br> • <b>A-WSC-DhU</b>: Users installing services on this asset<br> • <b>A-AE-AEtype</b>: Event types per asset<br> • <b>A-WSC-UZ</b>: Zones with service installation on the asset<br> • <b>A-WSC-SP</b>: Processes executed by the service on this asset<br> • <b>A-WSC-OS</b>: Services installed on the asset in the organization<br> • <b>WSC-US</b>: Services that are installed in the user<br> • <b>WSC-OZ</b>: Zones with service installation for organization<br> • <b>AE-UP-TEMP</b>: Process executable TEMP directories for this user during a session<br> • <b>WSC-GS</b>: Services that are installed in the peer group<br> • <b>WSC-UH</b>: Hosts on which a new service is installed by the user<br> • <b>WSC-GH</b>: Hosts on which a new service is installed in the peer group<br> • <b>WSC-OH</b>: Hosts on which a new service is installed in the organization |
| share-access    | <b>T1569 - System Services</b><br> ↳ <b>A-ATP-PSexec</b>: PSExec service was run on the asset.    |    |