Rules by Product and UseCase
============================
Vendor: Microsoft
-----------------
### Product: [Event Viewer - System](../ds_microsoft_event_viewer_-_system.md)
### Use-Case: [Lateral Movement](../../../../UseCases/uc_lateral_movement.md)

| Rules | Models | MITRE ATT&CK® TTPs | Activity Types | Parsers |
|:-----:|:------:|:------------------:|:--------------:|:-------:|
|  31   |   5    |         13         |       3        |    5    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| dcom-activation-failed | <b>T1021 - Remote Services</b><br> ↳ <b>A-DCOMFailure-Known</b>: Remote DCOM activation failure on this asset.<br><br><b>T1021.003 - T1021.003</b><br> ↳ <b>A-DCOMFailure-Known</b>: Remote DCOM activation failure on this asset.    |    |
| process-created        | <b>T1021 - Remote Services</b><br> ↳ <b>A-Suspicious-RDP-TSCON</b>: Suspicious usage of RDP using tscon.exe on this asset<br> ↳ <b>A-Remote-Powershell-Session</b>: Remote Powershell session was detected by monitoring for wsmprovhost as a parent or child process on this asset.<br> ↳ <b>A-Netsh-RDP-Port-Fwd</b>: Netsh commands used to configure port forwarding for port 3389, used for RDP, were detected on this asset.<br> ↳ <b>A-Impacket-Lateral-Detection</b>: Activity related to Impacket framework using wmiexec, dcomexe, or smbexec processes via command line have been found on this asset.<br> ↳ <b>A-PC-ParentName-ProcessName-DCOM-F</b>: First time child process creation for DCOM associated process on this asset.<br> ↳ <b>A-PC-ParentName-ProcessName-DCOM-A</b>: Abnormal child process creation for DCOM associated process on the asset.<br> ↳ <b>A-DCOMActivation-Known</b>: Remote DCOM activation under DcomLaunch service on this asset.<br><br><b>T1021.003 - T1021.003</b><br> ↳ <b>A-Impacket-Lateral-Detection</b>: Activity related to Impacket framework using wmiexec, dcomexe, or smbexec processes via command line have been found on this asset.<br> ↳ <b>A-PC-ParentName-ProcessName-DCOM-F</b>: First time child process creation for DCOM associated process on this asset.<br> ↳ <b>A-PC-ParentName-ProcessName-DCOM-A</b>: Abnormal child process creation for DCOM associated process on the asset.<br> ↳ <b>A-DCOMActivation-Known</b>: Remote DCOM activation under DcomLaunch service on this asset.<br><br><b>T1210 - Exploitation of Remote Services</b><br> ↳ <b>A-Terminal-Svc-Proc-Spawn</b>: Process spawned by the terminal service server on this asset.<br><br><b>T1219 - Remote Access Software</b><br> ↳ <b>A-EPA-RAT-TSS</b>: TeamViewer remote desktop access service started on this asset<br> ↳ <b>A-EPA-RAT-SSI</b>: Splashtop remote desktop access service installed on this asset<br> ↳ <b>A-EPA-RAT-TI</b>: TeamViewer remote desktop access agent installed on this asset<br> ↳ <b>A-EPA-RAT-SSS</b>: Splashtop remote desktop access service started on this asset<br> ↳ <b>A-EPA-RAT-SI</b>: Splashtop remote desktop access agent installed on this asset<br> ↳ <b>A-EPA-RAT-GSS</b>: GoToMyPC remote desktop access service started on this asset<br> ↳ <b>A-EPA-RAT-GSI</b>: GoToMyPC remote desktop access service installed on this asset<br> ↳ <b>A-EPA-RAT-TSI</b>: TeamViewer remote desktop access service installed on this asset<br> ↳ <b>A-EPA-RAT-LSS</b>: LogMeIn remote desktop access service started on this asset<br> ↳ <b>A-EPA-RAT-LSI</b>: LogMeIn remote desktop access service installed on this asset<br> ↳ <b>A-EPA-RAT-LI</b>: LogMeIn remote desktop access agent installed on this asset<br> ↳ <b>A-EPA-RAT-GI</b>: GoToMyPC remote desktop access agent installed on this asset<br> ↳ <b>A-TSCON-LocalSystem</b>: Tscon.exe was executed as Local System on this asset<br><br><b>T1563 - Remote Service Session Hijacking</b><br> ↳ <b>A-TSCON-LocalSystem</b>: Tscon.exe was executed as Local System on this asset<br><br><b>T1563.002 - T1563.002</b><br> ↳ <b>A-TSCON-LocalSystem</b>: Tscon.exe was executed as Local System on this asset<br><br><b>T1047 - Windows Management Instrumentation</b><br> ↳ <b>A-Impacket-Lateral-Detection</b>: Activity related to Impacket framework using wmiexec, dcomexe, or smbexec processes via command line have been found on this asset.<br><br><b>T1021.001 - Remote Services: Remote Desktop Protocol</b><br> ↳ <b>A-Suspicious-RDP-TSCON</b>: Suspicious usage of RDP using tscon.exe on this asset<br> ↳ <b>A-Netsh-RDP-Port-Fwd</b>: Netsh commands used to configure port forwarding for port 3389, used for RDP, were detected on this asset.<br><br><b>T1090 - Proxy</b><br> ↳ <b>A-Netsh-Port-Fwd</b>: Netsh commands were used to configure port forwarding on this asset.<br><br><b>T1021.006 - T1021.006</b><br> ↳ <b>A-Remote-Powershell-Session</b>: Remote Powershell session was detected by monitoring for wsmprovhost as a parent or child process on this asset.<br><br><b>T1059 - Command and Scripting Interperter</b><br> ↳ <b>A-Remote-Powershell-Session</b>: Remote Powershell session was detected by monitoring for wsmprovhost as a parent or child process on this asset.<br><br><b>T1059.001 - Command and Scripting Interperter: PowerShell</b><br> ↳ <b>A-Remote-Powershell-Session</b>: Remote Powershell session was detected by monitoring for wsmprovhost as a parent or child process on this asset. |  • <b>A-PC-ParentName-ProcessName</b>: Processes for parent parent processes.    |
| share-access    | <b>T1021 - Remote Services</b><br> ↳ <b>A-SA-OU-F</b>: First admin share access to asset for this user in the organization<br> ↳ <b>A-SA-OU-A</b>: Abnormal admin share access to asset for the user in the organization<br> ↳ <b>A-SA-OH-F</b>: First admin share on asset for organization<br> ↳ <b>A-SA-OH-A</b>: Abnormal admin share on asset in organization<br> ↳ <b>A-SA-ZH-F</b>: First admin share on asset in the zone<br> ↳ <b>A-SA-ZH-A</b>: Abnormal admin share on asset for zone<br> ↳ <b>A-SA-AsU-F</b>: First access of admin share on asset<br> ↳ <b>A-SA-AsU-A</b>: Abnormal access of admin share on the asset<br><br><b>T1021.002 - Remote Services: SMB/Windows Admin Shares</b><br> ↳ <b>A-SA-OU-F</b>: First admin share access to asset for this user in the organization<br> ↳ <b>A-SA-OU-A</b>: Abnormal admin share access to asset for the user in the organization<br> ↳ <b>A-SA-OH-F</b>: First admin share on asset for organization<br> ↳ <b>A-SA-OH-A</b>: Abnormal admin share on asset in organization<br> ↳ <b>A-SA-ZH-F</b>: First admin share on asset in the zone<br> ↳ <b>A-SA-ZH-A</b>: Abnormal admin share on asset for zone<br> ↳ <b>A-SA-AsU-F</b>: First access of admin share on asset<br> ↳ <b>A-SA-AsU-A</b>: Abnormal access of admin share on the asset    |  • <b>A-SA-AsU</b>: Users per Admin share<br> • <b>A-SA-ZH</b>: Dest zones on which admin shares are accessed<br> • <b>A-SA-OH</b>: Assets on which admin shares are accessed in organization<br> • <b>A-SA-OU</b>: Admin Share users in organization |