Vendor: Microsoft
=================
### Product: [Microsoft Defender for Endpoint](../ds_microsoft_microsoft_defender_for_endpoint.md)
### Use-Case: [Malware](../../../../UseCases/uc_malware.md)

| Rules | Models | MITRE TTPs | Activity Types | Parsers |
|:-----:|:------:|:----------:|:--------------:|:-------:|
|  33   |   14   |     21     |       19       |   19    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| app-activity    | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Blacklist-Shost</b>: User authentication or login from a known blacklisted IP    |    |
| image-loaded    | <b>T1546.003 - T1546.003</b><br> ↳ <b>A-WMI-Suspicious-Process</b>: WMI provider service is used to invoke CMD/PowerShell on this asset.<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-SW-UDLL</b>: DLL loaded in unusual location on the system on this asset.<br><br><b>T1072 - Software Deployment Tools</b><br> ↳ <b>A-SW-FW</b>: Unusual image loaded by Solar Wind Executable on this asset.    |    |
| process-created-failed | <b>T1190 - Exploit Public Fasing Application</b><br> ↳ <b>A-EPA-Log4j-String-Command-2</b>: There was an attempt via process creation to exploit the CVE-2021-44228 vulnerability using known keywords on this asset.<br> ↳ <b>EPA-Log4j-String-Command-2</b>: There was an attempt via process creation to exploit the CVE-2021-44228 vulnerability using known keywords.<br><br><b>T1059.005 - T1059.005</b><br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1059.007 - T1059.007</b><br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1218.005 - T1218.005</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1047 - Windows Management Instrumentation</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1127.001 - Trusted Developer Utilities Proxy Execution: MSBuild</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1218.004 - Signed Binary Proxy Execution: InstallUtil</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1218.010 - Signed Binary Proxy Execution: Regsvr32</b><br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>EPA-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user during endpoint activity<br> ↳ <b>EPA-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user during endpoint activity<br><br><b>T1562.004 - Impair Defenses: Disable or Modify System Firewall</b><br> ↳ <b>A-KnownFirewallDisable-Log4j</b>: FireWall disable arguments via command line were detected on this asset.<br><br><b>T1218.001 - Signed Binary Proxy Execution: Compiled HTML File</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset. |  • <b>PC-ParentName-ProcessName</b>: Child processes created by a parent process<br> • <b>EPA-UP-TEMP</b>: Process executable TEMP directories for this user during endpoint activity<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset    |
| registry-write         | <b>T1112 - Modify Registry</b><br> ↳ <b>A-RA-LogonRunKeys-OH-F</b>: A program was added to the registry run key on this asset at the first time<br> ↳ <b>A-RA-LogonRunKeys-OH-A</b>: Abnormal addition of a program to the registry run key on this asset<br> ↳ <b>RA-LogonRunKeys-OU-F</b>: A program was added to the registry run key for the first time by the user<br> ↳ <b>RA-LogonRunKeys-OU-A</b>: Abnormal addition of a program to the registry run key by the user<br><br><b>T1547.001 - T1547.001</b><br> ↳ <b>A-RA-LogonRunKeys-OH-F</b>: A program was added to the registry run key on this asset at the first time<br> ↳ <b>A-RA-LogonRunKeys-OH-A</b>: Abnormal addition of a program to the registry run key on this asset<br> ↳ <b>RA-LogonRunKeys-OU-F</b>: A program was added to the registry run key for the first time by the user<br> ↳ <b>RA-LogonRunKeys-OU-A</b>: Abnormal addition of a program to the registry run key by the user<br><br><b>T1574.010 - T1574.010</b><br> ↳ <b>A-ServiceName-ServiceCmdline-F</b>: First time binary command line for this service on this asset.<br> ↳ <b>A-ServiceName-ServiceCmdline-A</b>: Abnormal binary command line for this service<br><br><b>T1574.011 - T1574.011</b><br> ↳ <b>A-ServiceName-ServiceCmdline-F</b>: First time binary command line for this service on this asset.<br> ↳ <b>A-ServiceName-ServiceCmdline-A</b>: Abnormal binary command line for this service    |  • <b>RA-LogonRunKeys-OU</b>: Users that add programs to the registry run keys<br> • <b>A-RA-LogonRunKeys-OH</b>: Hosts where programs add to the registry run keys in the organization.<br> • <b>A-ServiceName-ServiceCmdline</b>: Service Executable Files on the asset    |
| task-created    | <b>T1053 - Scheduled Task/Job</b><br> ↳ <b>ChaferAPT-Activity-TaskCreated</b>: Chafer APT related activity observed, a suspicious task was created<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>DEF-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user<br> ↳ <b>DEF-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user<br><br><b>T1053.005 - Scheduled Task/Job: Scheduled Task</b><br> ↳ <b>WTC-OH-F</b>: First scheduled task on host in the organization<br> ↳ <b>WTC-GH-F</b>: First scheduled task on host in the peer group<br> ↳ <b>WTC-UH-F</b>: First scheduled task on host for the user<br> ↳ <b>WTC-OT-A</b>: Unusual task name in the organization<br> ↳ <b>WTC-GT-A</b>: Unusual task name in the peer group<br> ↳ <b>WTC-UT-A</b>: Unusual task name in the user<br> ↳ <b>WTC-TP-A</b>: Unusual process for scheduled task<br> ↳ <b>WTC-TP-POWERSHELL</b>: Scheduled task created to execute sensitive process<br><br><b>T1059.001 - Command and Scripting Interperter: PowerShell</b><br> ↳ <b>WTC-TP-POWERSHELL</b>: Scheduled task created to execute sensitive process    |  • <b>AE-UP-TEMP</b>: Process executable TEMP directories for this user during a session<br> • <b>WTC-TP</b>: Processes that are executed by the scheduled task<br> • <b>WTC-UT</b>: Scheduled tasks that are created in the user<br> • <b>WTC-GT</b>: Scheduled tasks that are created in the peer group<br> • <b>WTC-OT</b>: Scheduled tasks that are created in the organization<br> • <b>WTC-UH</b>: Hosts on which scheduled tasks are created by the user<br> • <b>WTC-GH</b>: Hosts on which scheduled tasks are created in the peer group<br> • <b>WTC-OH</b>: Hosts on which scheduled tasks are created in the organization<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset |