Rules by Product and UseCase
============================
Vendor: Microsoft
-----------------
### Product: [Event Viewer - AzureADPasswordProtection-DCAgent](../ds_microsoft_event_viewer_-_azureadpasswordprotection-dcagent.md)
### Use-Case: [Malware](../../../../UseCases/uc_malware.md)

| Rules | Models | MITRE ATT&CK® TTPs | Activity Types | Parsers |
|:-----:|:------:|:------------------:|:--------------:|:-------:|
|  18   |   4    |         11         |       6        |    8    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| authentication-failed     | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Blacklist-Shost-Failed</b>: User authentication or login failure from a known blacklisted IP    |    |
| authentication-successful | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Blacklist-Shost</b>: User authentication or login from a known blacklisted IP    |    |
| dns-query    | <b>T1583.001 - T1583.001</b><br> ↳ <b>A-DNS-SW-MALDOM</b>: DNS query for SUNBURST malware from this asset<br><br><b>T1071 - Application Layer Protocol</b><br> ↳ <b>A-DNS-MALDOM-QUERY</b>: DNS query for blacklisted domain from this asset<br> ↳ <b>A-DNS-DGADOM-QUERY</b>: DNS query for DGA domain from this asset<br><br><b>T1568.002 - Dynamic Resolution: Domain Generation Algorithms</b><br> ↳ <b>A-DNS-DGADOM-QUERY</b>: DNS query for DGA domain from this asset    |    |
| failed-logon    | <b>T1210 - Exploitation of Remote Services</b><br> ↳ <b>A-Suspicious-Bluekeep1</b>: The account AAAAAAA failed to logon on this asset.<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Blacklist-Shost-Failed</b>: User authentication or login failure from a known blacklisted IP    |    |
| file-write    | <b>T1505.003 - Server Software Component: Web Shell</b><br> ↳ <b>A-FW-UMWorkerProcess-FileName-F</b>: First time file creation for Exchange Unified Messaging service UMWorkerProcess.exe<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-Suspicious-LNK</b>: A suspicious .lnk file used, possible ATP activity on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br><br><b>T1547.001 - T1547.001</b><br> ↳ <b>FA-StartupFolder-OU-F</b>: A program was added to the startup folder for the first time by the user<br> ↳ <b>FA-StartupFolder-OU-A</b>: Abnormal program addition to the startup folder by the user.<br> ↳ <b>A-FA-StartupFolder-OH-F</b>: A program was added to the startup folder for the first time on this asset<br> ↳ <b>A-FA-StartupFolder-OH-A</b>: Abnormal addition of a program to the startup folder on the asset<br><br><b>T1003.002 - T1003.002</b><br> ↳ <b>A-ATP-Tool-FGDump</b>: Malicious exe/dll.<br> ↳ <b>A-ATP-Tool-PSTGDump</b>: Malicious pstgdump.exe was run from a temp folder on this asset. |  • <b>A-FW-ProcessName-FileName</b>: File creations for process<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset<br> • <b>A-FA-StartupFolder-OH</b>: Hosts where programs were added to startup folders in the organization<br> • <b>FA-StartupFolder-OU</b>: Users that add programs to the startup folders |
| image-loaded    | <b>T1546.003 - T1546.003</b><br> ↳ <b>A-WMI-Suspicious-Process</b>: WMI provider service is used to invoke CMD/PowerShell on this asset.<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-SW-UDLL</b>: DLL loaded in unusual location on the system on this asset.<br><br><b>T1072 - Software Deployment Tools</b><br> ↳ <b>A-SW-FW</b>: Unusual image loaded by Solar Wind Executable on this asset.    |    |