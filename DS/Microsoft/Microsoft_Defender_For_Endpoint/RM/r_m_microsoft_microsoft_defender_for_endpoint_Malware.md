Vendor: Microsoft
=================
### Product: [Microsoft Defender For Endpoint](../ds_microsoft_microsoft_defender_for_endpoint.md)
### Use-Case: [Malware](../../../../UseCases/uc_malware.md)

| Rules | Models | MITRE TTPs | Activity Types | Parsers |
|:-----:|:------:|:----------:|:--------------:|:-------:|
|  24   |   12   |     12     |       10       |   10    |

| Event Type     | Rules    | Models    |
| ---- | ---- | ---- |
| dns-response   | <b>T1071 - Application Layer Protocol</b><br> ↳ <b>A-DNS-MALDOM-RESPONSE</b>: DNS query for blacklisted domain was successful from this asset<br> ↳ <b>A-DNS-DGADOM-RESPONSE</b>: DNS query for DGA domain was successful from this asset<br><br><b>T1568.002 - Dynamic Resolution: Domain Generation Algorithms</b><br> ↳ <b>A-DNS-DGADOM-RESPONSE</b>: DNS query for DGA domain was successful from this asset    |    |
| image-loaded   | <b>T1546.003 - T1546.003</b><br> ↳ <b>A-WMI-Suspicious-Process</b>: WMI provider service is used to invoke CMD/PowerShell on this asset.<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-SW-UDLL</b>: DLL loaded in unusual location on the system on this asset.<br><br><b>T1072 - Software Deployment Tools</b><br> ↳ <b>A-SW-FW</b>: Unusual image loaded by Solar Wind Executable on this asset.    |    |
| registry-write | <b>T1112 - Modify Registry</b><br> ↳ <b>A-RA-LogonRunKeys-OH-F</b>: A program was added to the registry run key on this asset at the first time<br> ↳ <b>A-RA-LogonRunKeys-OH-A</b>: Abnormal addition of a program to the registry run key on this asset<br> ↳ <b>RA-LogonRunKeys-OU-F</b>: A program was added to the registry run key for the first time by the user<br> ↳ <b>RA-LogonRunKeys-OU-A</b>: Abnormal addition of a program to the registry run key by the user<br><br><b>T1547.001 - T1547.001</b><br> ↳ <b>A-RA-LogonRunKeys-OH-F</b>: A program was added to the registry run key on this asset at the first time<br> ↳ <b>A-RA-LogonRunKeys-OH-A</b>: Abnormal addition of a program to the registry run key on this asset<br> ↳ <b>RA-LogonRunKeys-OU-F</b>: A program was added to the registry run key for the first time by the user<br> ↳ <b>RA-LogonRunKeys-OU-A</b>: Abnormal addition of a program to the registry run key by the user<br><br><b>T1574.010 - T1574.010</b><br> ↳ <b>A-ServiceName-ServiceCmdline-F</b>: First time binary command line for this service on this asset.<br> ↳ <b>A-ServiceName-ServiceCmdline-A</b>: Abnormal binary command line for this service<br><br><b>T1574.011 - T1574.011</b><br> ↳ <b>A-ServiceName-ServiceCmdline-F</b>: First time binary command line for this service on this asset.<br> ↳ <b>A-ServiceName-ServiceCmdline-A</b>: Abnormal binary command line for this service |  • <b>RA-LogonRunKeys-OU</b>: Users that add programs to the registry run keys<br> • <b>A-RA-LogonRunKeys-OH</b>: Hosts where programs add to the registry run keys in the organization.<br> • <b>A-ServiceName-ServiceCmdline</b>: Service Executable Files on the asset    |
| task-created   | <b>T1053 - Scheduled Task/Job</b><br> ↳ <b>ChaferAPT-Activity-TaskCreated</b>: Chafer APT related activity observed, a suspicious task was created<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>DEF-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user<br> ↳ <b>DEF-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user<br><br><b>T1053.005 - Scheduled Task/Job: Scheduled Task</b><br> ↳ <b>WTC-OH-F</b>: First scheduled task on host in the organization<br> ↳ <b>WTC-GH-F</b>: First scheduled task on host in the peer group<br> ↳ <b>WTC-UH-F</b>: First scheduled task on host for the user<br> ↳ <b>WTC-OT-A</b>: Unusual task name in the organization<br> ↳ <b>WTC-GT-A</b>: Unusual task name in the peer group<br> ↳ <b>WTC-UT-A</b>: Unusual task name in the user<br> ↳ <b>WTC-TP-A</b>: Unusual process for scheduled task<br> ↳ <b>WTC-TP-POWERSHELL</b>: Scheduled task created to execute sensitive process<br><br><b>T1059.001 - Command and Scripting Interperter: PowerShell</b><br> ↳ <b>WTC-TP-POWERSHELL</b>: Scheduled task created to execute sensitive process    |  • <b>AE-UP-TEMP</b>: Process executable TEMP directories for this user during a session<br> • <b>WTC-TP</b>: Processes that are executed by the scheduled task<br> • <b>WTC-UT</b>: Scheduled tasks that are created in the user<br> • <b>WTC-GT</b>: Scheduled tasks that are created in the peer group<br> • <b>WTC-OT</b>: Scheduled tasks that are created in the organization<br> • <b>WTC-UH</b>: Hosts on which scheduled tasks are created by the user<br> • <b>WTC-GH</b>: Hosts on which scheduled tasks are created in the peer group<br> • <b>WTC-OH</b>: Hosts on which scheduled tasks are created in the organization<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset |