Rules by Product and UseCase
============================
Vendor: FireEye
---------------
### Product: [FireEye Endpoint Security (HX)](../ds_fireeye_fireeye_endpoint_security_(hx).md)
### Use-Case: [Malware](../../../../UseCases/uc_malware.md)

| Rules | Models | MITRE ATT&CK® TTPs | Activity Types | Parsers |
|:-----:|:------:|:------------------:|:--------------:|:-------:|
|  35   |   11   |         12         |       4        |    8    |

| Event Type     | Rules    | Models    |
| ---- | ---- | ---- |
| file-write     | <b>T1505 - Server Software Component</b><br> ↳ <b>A-FW-UMWorkerProcess-FileName-F</b>: First time file creation for Exchange Unified Messaging service UMWorkerProcess.exe<br><br><b>T1505.003 - Server Software Component: Web Shell</b><br> ↳ <b>A-FW-UMWorkerProcess-FileName-F</b>: First time file creation for Exchange Unified Messaging service UMWorkerProcess.exe<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-Suspicious-LNK</b>: A suspicious .lnk file used, possible ATP activity on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br><br><b>T1547 - Boot or Logon Autostart Execution</b><br> ↳ <b>FA-StartupFolder-OU-F</b>: A program was added to the startup folder for the first time by the user<br> ↳ <b>FA-StartupFolder-OU-A</b>: Abnormal program addition to the startup folder by the user.<br> ↳ <b>A-FA-StartupFolder-OH-F</b>: A program was added to the startup folder for the first time on this asset<br> ↳ <b>A-FA-StartupFolder-OH-A</b>: Abnormal addition of a program to the startup folder on the asset<br><br><b>T1547.001 - T1547.001</b><br> ↳ <b>FA-StartupFolder-OU-F</b>: A program was added to the startup folder for the first time by the user<br> ↳ <b>FA-StartupFolder-OU-A</b>: Abnormal program addition to the startup folder by the user.<br> ↳ <b>A-FA-StartupFolder-OH-F</b>: A program was added to the startup folder for the first time on this asset<br> ↳ <b>A-FA-StartupFolder-OH-A</b>: Abnormal addition of a program to the startup folder on the asset<br><br><b>T1003 - OS Credential Dumping</b><br> ↳ <b>A-ATP-Tool-FGDump</b>: Malicious exe/dll.<br> ↳ <b>A-ATP-Tool-PSTGDump</b>: Malicious pstgdump.exe was run from a temp folder on this asset.<br><br><b>T1003.002 - T1003.002</b><br> ↳ <b>A-ATP-Tool-FGDump</b>: Malicious exe/dll.<br> ↳ <b>A-ATP-Tool-PSTGDump</b>: Malicious pstgdump.exe was run from a temp folder on this asset.    |  • <b>A-FW-ProcessName-FileName</b>: File creations for process<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset<br> • <b>A-FA-StartupFolder-OH</b>: Hosts where programs were added to startup folders in the organization<br> • <b>FA-StartupFolder-OU</b>: Users that add programs to the startup folders    |
| network-alert  | <b>TA0002 - TA0002</b><br> ↳ <b>DEF-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user<br> ↳ <b>DEF-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user<br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory    |  • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset<br> • <b>AE-UP-TEMP</b>: Process executable TEMP directories for this user during a session    |
| process-alert  | <b>T1053 - Scheduled Task/Job</b><br> ↳ <b>EPA-UP-CrontabMod-F</b>: First execution of process which contains commands for crontab modification for user.<br> ↳ <b>EPA-UP-CrontabMod-A</b>: Abnormal execution of of process which contains commands for crontab modification for user.<br> ↳ <b>A-EPA-HP-CrontabMod-F</b>: First execution of process on asset and the command of the process is crontab modification<br> ↳ <b>A-EPA-HP-CrontabMod-A</b>: Abnormal execution of process on asset and the command of the process is crontab modification<br><br><b>T1053.003 - T1053.003</b><br> ↳ <b>EPA-UP-CrontabMod-F</b>: First execution of process which contains commands for crontab modification for user.<br> ↳ <b>EPA-UP-CrontabMod-A</b>: Abnormal execution of of process which contains commands for crontab modification for user.<br> ↳ <b>A-EPA-HP-CrontabMod-F</b>: First execution of process on asset and the command of the process is crontab modification<br> ↳ <b>A-EPA-HP-CrontabMod-A</b>: Abnormal execution of process on asset and the command of the process is crontab modification<br><br><b>TA0002 - TA0002</b><br> ↳ <b>EPA-UP-A</b>: Abnormal execution of process for user<br> ↳ <b>EPA-GP-F</b>: First execution of process for this peer group<br> ↳ <b>EPA-GP-A</b>: Abnormal execution of process for this peer group<br> ↳ <b>EPA-PDir-F</b>: First execution of a process in this directory for the organization<br> ↳ <b>EPA-HDir-Server-F</b>: First execution of a process in this directory on a server<br> ↳ <b>EPA-F-CLI</b>: Suspicious Windows process executed<br> ↳ <b>EPA-UH-Pen-F</b>: Known pentest tool used<br> ↳ <b>EPA-UP-Commands-F</b>: First execution of this process for user and the command of the process is curl/wget<br> ↳ <b>EPA-UP-Commands-A</b>: Abnormal process execution containing wget or curl commands for the user.<br> ↳ <b>A-EPA-HP-F</b>: First execution of process on asset<br> ↳ <b>A-EPA-HP-A</b>: Abnormal execution of process on asset<br> ↳ <b>A-EPA-ZP-A</b>: Abnormal execution of process for the asset in this zone<br> ↳ <b>A-EPA-ZP-F</b>: First execution of process for the asset in this zone<br> ↳ <b>A-EPA-OP-F</b>: First execution of process for the asset in this organization<br> ↳ <b>A-EPA-OP-A</b>: Abnormal execution of process for the asset in this organization<br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>A-EPA-HP-Commands-F</b>: First execution of process on asset and the command of the process is curl/wget<br> ↳ <b>A-EPA-HP-Commands-A</b>: Abnormal execution of process on asset and the command of the process is curl/wget<br><br><b>T1562 - Impair Defenses</b><br> ↳ <b>A-KnownFirewallDisable-Log4j</b>: FireWall disable arguments via command line were detected on this asset.<br><br><b>T1562.004 - Impair Defenses: Disable or Modify System Firewall</b><br> ↳ <b>A-KnownFirewallDisable-Log4j</b>: FireWall disable arguments via command line were detected on this asset.<br><br><b>T1190 - Exploit Public Fasing Application</b><br> ↳ <b>A-EPA-Log4j-String-Command-2</b>: There was an attempt via process creation to exploit the CVE-2021-44228 vulnerability using known keywords on this asset. |  • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset<br> • <b>A-EPA-OP</b>: Processes in the organization on asset<br> • <b>A-EPA-ZP</b>: Processes in the zone on asset<br> • <b>A-EPA-HP</b>: Processes on this asset<br> • <b>EPA-UH-Pen</b>: Malicious tools used by user<br> • <b>EPA-PDir</b>: Process executable directories in the organization<br> • <b>EPA-GP</b>: Processes for the peer group |
| security-alert | <b>TA0002 - TA0002</b><br> ↳ <b>DEF-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user<br> ↳ <b>DEF-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user<br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory    |  • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset<br> • <b>AE-UP-TEMP</b>: Process executable TEMP directories for this user during a session    |