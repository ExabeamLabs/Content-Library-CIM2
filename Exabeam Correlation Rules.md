Exabeam Prebuilt Correlation Rules
==================================

The following table lists the prebuilt supported correlation rules.

| Rule Name                                                                                                                                         | Description                                                                                                                                                                                                                                                                                                                                                                           | Use Case                                                                                                                | MITRE tactics                                                      | Severity |
| ------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ | -------- |
| Disable windows recovery mode with bcdedit<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                 | Automatic windows recovery features have been disabled by modifying boot configuration                                                                                                                                                                                                                                                                                                | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| UAC bypass using event viewer                                                                                                                     | A User Account Control (UAC) bypass has been executed using the event viewer process.                                                                                                                                                                                                                                                                                                 | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 1        |
| User added to an administrative AD group                                                                                                          | A user has been added to an administrative Active Directory group.                                                                                                                                                                                                                                                                                                                    | [Account Manipulation](UseCases/uc_account_manipulation.md)                                                             | Persistence                                                        | 3        |
| SUSEFireWall2 disabled<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                                     | The SUSEFireWall2 firewall script has been stopped. This enables potentially malicious network communications to be allowed into and out of the endpoint.                                                                                                                                                                                                                             | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| MFA request generation: Large amount of OKTA push denies for this user                                                                            | This email address has generated 5 or more failed multi-factor OKTA push authentication requests in 10 minutes.                                                                                                                                                                                                                                                                       | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| SQL injection                                                                                                                                     | Detect inbound HTTP requests that suggest SQL injection activity                                                                                                                                                                                                                                                                                                                      | [](UseCases/uc_.md)                                                                                                     | Initial Access                                                     | 1        |
| Arbitrary command assigned to a file association via the registry                                                                                 | Arbitrary command was assigned to a file association via the registry. Attackers can modify the command key values and cause arbitrary commands to execute during file access.                                                                                                                                                                                                        | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| AWS CloudWatch log stream deleted                                                                                                                 | Attackers can delete AWS CloudWatch streams to stop logs from being sent to those streams, thus removing evidence of their presence in the system.                                                                                                                                                                                                                                    | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 1        |
| DLL executed using 'odbcconf.exe'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                          | The Open Database Connectivity configuration utility ('odbcconfig.exe') has been used to register and execute an arbitrary DLL.                                                                                                                                                                                                                                                       | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Direct access to a drive granted using PowerShell                                                                                                 | Windows allows programs to directly access physical volumes and drives. Using PowerShell, attackers can gain direct access to the filesystem, bypassing ACLs and file monitoring applications.                                                                                                                                                                                        | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| WinRM enabled using PowerShell                                                                                                                    | WinRM has been enabled using PowerShell. Windows Remote Management (WinRM) allows users to interact with remote systems to run executables or modify services. Adversaries can leverage it to act as a logged-on user.                                                                                                                                                                | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| Failed logins for a large number of users to this endpoint<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                 | Failed logins have been observed for 10 or more different users to this endpoint in 10 minutes.                                                                                                                                                                                                                                                                                       | [Abnormal Authentication Access, brute Force Attack](UseCases/uc_abnormal_authentication_access, brute_force_attack.md) | Credential Access                                                  | 2        |
| Recycle bin autostart persistency through the registry                                                                                            | The shell configuration of the recycle bin application has been modified through the registry. This enables the execution of arbitrary code whenever the recycle bin is opened.                                                                                                                                                                                                       | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Security log disabled by creating the 'MiniNt' registry key using the registry command tool                                                       | The Windows Security Log has been disabled by creating the 'MiniNt' registry key using the registry command tool. This key causes Windows to malfunction and stop auditing events in the security log. Disabling Windows event logs limits the information recorded by the system, hindering detection efforts.                                                                       | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 3        |
| Large amount of outgoing bytes sent from this IP address                                                                                          | 100 MB or more data have been sent over the network from this IP address in 1 minute.                                                                                                                                                                                                                                                                                                 | [Data Exfiltration](UseCases/uc_data_exfiltration.md)                                                                   | Exfiltration                                                       | 2        |
| Base64 encoded data with PowerShell in the command line<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                    | Base64 is a basic encoding that can be used with PowerShell to edit malicious files. Encoded data can be used by attackers to hide their presence in the system and sneak by scans security services.                                                                                                                                                                                 | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| XDG file edited                                                                                                                                   | XDG files contain autostart entries that allow an application to automatically start during the startup of a desktop environment after user logon. Attackers can modify the file to include their own malicious entries, gaining persistence in the system.                                                                                                                           | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 1        |
| Audit log has been cleared                                                                                                                        | An audit log has been cleared which could be an indication of defense evasion.                                                                                                                                                                                                                                                                                                        | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Windows event viewer cleared using PowerShell<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                              | Windows event viewer has been cleared using PowerShell.                                                                                                                                                                                                                                                                                                                               | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| IIS HTTP logging was disabled                                                                                                                     | IIS HTTP logging was disabled using the Applicaiton Command Prompt, which can prevent the server from recording HTTP activity. This may indicate an attempt at defense evasion by impairing logging and monitoring capabilities.                                                                                                                                                      | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 1        |
| Sysmon service was stopped                                                                                                                        | The Sysmon service has been stopped. This causes Sysmon to stop auditing logs which could be used by attackers to evade detection.                                                                                                                                                                                                                                                    | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| HTA file executed using 'mshta.exe'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                        | The Microsoft HTML Applications ('mshta.exe') utility has been used to execute an HTML application script file ('.hta').                                                                                                                                                                                                                                                              | [Malware](UseCases/uc_malware.md)                                                                                       | Defense Evasion                                                    | 2        |
| Shadow copy creation using 'vssadmin.exe'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                  | A Shadow Copy has been created using the Volume Shadow Copy Service Administration ('vssadmin.exe') process.                                                                                                                                                                                                                                                                          | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| ETW session disabled through the autorlogger registry path                                                                                        | Event Tracing for Windows (ETW) logs events for applications and services like Microsoft Defender, PowerShell, and other event viewer logs. Attackers can disable ETW by modifying keys under the 'AutoLogger' registry path, preventing logs from being audited and allowing them to evade detection.                                                                                | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| PowerShell command history disabled                                                                                                               | PowerShell automatically records command history and stores them in a system file. This configuration can be disabled with PowerShell command, allowing malicious command to avoid being tracked by the program.                                                                                                                                                                      | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| File added to the winlogon helper dll autorun registry key                                                                                        | A file has been added to the Winlogon helper DLL autorun registry key, which could indicate malware persistence.                                                                                                                                                                                                                                                                      | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| AWS compute resource (snapshot\image) made public<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                          | AWS compute resources (snapshot or image) were modified to be public to every user. Now public resources can be read and downloaded by everyone.                                                                                                                                                                                                                                      | [Cloud Data Protection](UseCases/uc_cloud_data_protection.md)                                                           | Collection                                                         | 2        |
| Microsoft Defender firewall disabled using 'netsh.exe'                                                                                            | The command line tool netsh.exe allows attackers do disable the Microsoft Defender firewall, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                                                                                                                                                        | [Evasion](UseCases/uc_evasion.md)                                                                                       | Evasion                                                            | 2        |
| File permissions granted using 'icacls.exe'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                | Attackers can use the 'icacls.exe' process to grant themselves permissions to specific directories and files, effectively bypassing ACLs and gaining full control over the data.                                                                                                                                                                                                      | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| DPAPI backup master key recovery attempted                                                                                                        | A recovery attempt of the DPAPI master key has been observed.                                                                                                                                                                                                                                                                                                                         | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Wreset UAC bypass by modifying shell configuration in the registry using the registry command tool                                                | A User Account Control (UAC) bypass has been set up by modifying the shell configuration of Wreset in the registry using the registry command tool. Bypassing UAC can be used to elevate privileges.                                                                                                                                                                                  | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 3        |
| Windows Defender service disabled using the 'DisableAntiSpyware' registry value                                                                   | The Windows Defender service has been disabled by enabling the 'DisableAntiSpyware' registry value. This causes all Defender operations to stop.                                                                                                                                                                                                                                      | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| SilentCleanup UAC bypass by manually activating the SilentCleanup task                                                                            | A User Account Control (UAC) bypass has been executed by manually activating the SilentCleanup task.                                                                                                                                                                                                                                                                                  | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 1        |
| DLL added to the time providers registry key using the registry command tool                                                                      | A DLL was added to the Time Providers registry key using the reg command-line tool, which may indicate an attempt to establish malware persistence.                                                                                                                                                                                                                                   | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| UAC bypass by masquerading trusted directories                                                                                                    | A User Account Control (UAC) bypass has been executed by masquerading trusted default Windows system directories.                                                                                                                                                                                                                                                                     | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| Installation of a password filter DLL using the notification packages registry configuration                                                      | A password filter DLL was installed through the Notification Packages registry key. Attackers can exploit these filters to capture user credentials from individual computers or entire domains.                                                                                                                                                                                      | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Large number of emails sent to this email address                                                                                                 | 50 or more emails have been sent to this email address in 5 hours.                                                                                                                                                                                                                                                                                                                    | [Data Leak](UseCases/uc_data_leak.md)                                                                                   | Exfiltration                                                       | 2        |
| File added to the registry run key using the registry command tool<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                         | A file has been added to the registry run key using a registry command tool, which could indicate malware persistence.                                                                                                                                                                                                                                                                | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Lsass process dump with rundll minidump library                                                                                                   | LSASS can store credentials and the memory can be dumped to harvest encrypted or plaintext passwords.                                                                                                                                                                                                                                                                                 | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 4        |
| Allow RDP locally using 'netsh.exe'                                                                                                               | Local Remote Desktop Protocol (RDP) port has been enabled using netsh command                                                                                                                                                                                                                                                                                                         | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| Exchange mailbox exported using PowerShell<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                 | An exchange mailbox has been exported using a PowerShell script.                                                                                                                                                                                                                                                                                                                      | [Data Access](UseCases/uc_data_access.md)                                                                               | Collection                                                         | 1        |
| Process executed from an ADS                                                                                                                      | Alternate Data Streams (ADS) are a windows file system attribute that can be used to store hidden information inside a seemingly regular file. Attackers can use data streams to hide and execute malware.                                                                                                                                                                            | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 3        |
| Failed logins for a large number of users from this endpoint<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                               | Failed logins have been observed to 10 or more different users from this endpoint in 10 minutes.                                                                                                                                                                                                                                                                                      | [Abnormal Authentication Access, brute Force Attack](UseCases/uc_abnormal_authentication_access, brute_force_attack.md) | Credential Access                                                  | 2        |
| System Restore disabled through the registry                                                                                                      | System Restore has been disabled by modifying the registry.                                                                                                                                                                                                                                                                                                                           | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| Remote compiled HTML file executed using 'hh.exe'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                          | Attackers can use compiled HTML ('.chm') files to hide malicious code and execute it using native Windows commands like 'hh.exe'.                                                                                                                                                                                                                                                     | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 3        |
| File added to the port monitor registry key using the registry command tool                                                                       | A file has been added to the port monitor registry key using a registry command tool, which could indicate malware persistence.                                                                                                                                                                                                                                                       | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| AWS logging trail was deleted                                                                                                                     | A AWS logging trail was deleted which could be an indication of defense evasion.                                                                                                                                                                                                                                                                                                      | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Opera login data file database access                                                                                                             | User is trying to access encrypted credentials from Opera browser                                                                                                                                                                                                                                                                                                                     | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Windows backup catalog deleted using the Windows backup administration tool<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                | Windows backup catalog has been deleted using 'wbadmin' (Windows backup administration).                                                                                                                                                                                                                                                                                              | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| Sysmon driver was unloaded using the minifilter management console<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                         | The Sysmon driver has been unloaded using the minifilter management console. This causes Sysmon to stop auditing logs which could be used by attackers to evade detection.                                                                                                                                                                                                            | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| File added to the print processors registry key using the registry command tool                                                                   | A file has been added to the print processors registry key using a registry command tool, which could indicate malware persistence.                                                                                                                                                                                                                                                   | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| SAM copied from a shadow copy                                                                                                                     | The Security Accounts Manager (SAM) registry hive has been copied from a shadow copy. The SAM file contains password hashes for local user accounts, this activity may indicate a credential dumping attempt.                                                                                                                                                                         | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| Shadow copy creation using PowerShell                                                                                                             | A Shadow Copy has been created using the PowerShell process.                                                                                                                                                                                                                                                                                                                          | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Startup folder location changed through the registry                                                                                              | The location of startup folder has been modified through the registry. Attackers can leverage start up folders to gain persistency by executing arbitrary malicious code whenever the system performs a startup.                                                                                                                                                                      | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| WMI targeting remote endpoint                                                                                                                     | Windows Management Instrumentation (WMI) was executed on a remote endpoint                                                                                                                                                                                                                                                                                                            | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| SCF file created on a network share<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                        | An SCF (Shell Command File) has been created on a network share, which could be used to trigger remote code execution when accessed by other users.                                                                                                                                                                                                                                   | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Failed logins from multiple endpoints for this user                                                                                               | This user has failed to login from 10 or more different source endpoints in 10 minutes.                                                                                                                                                                                                                                                                                               | [Brute Force Attack, lateral Movement](UseCases/uc_brute_force_attack, lateral_movement.md)                             | Credential Access                                                  | 3        |
| Failed logins to a large number of endpoints for this user                                                                                        | This user has failed to login to 10 or more different source endpoints in 10 minutes.                                                                                                                                                                                                                                                                                                 | [Brute Force Attack, lateral Movement](UseCases/uc_brute_force_attack, lateral_movement.md)                             | Credential Access                                                  | 3        |
| Microsoft Defender firewall disabled through the registry using the registry command tool                                                         | Microsoft Defender firewall in the registry was disabled via the registry command tool. The Defender firewall registry value 'EnableFirewall' allows attackers to disable the Microsoft Defender firewall by setting it to 0, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                       | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| DLL added to the security packages registry key                                                                                                   | A DLL has been added to the security packages registry key, which could indicate malware persistence.                                                                                                                                                                                                                                                                                 | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 3        |
| PsExec targeted a remote endpoint                                                                                                                 | PsExec has been used to access a Windows admin share through the network.                                                                                                                                                                                                                                                                                                             | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 2        |
| NTDS dump with ntds utility                                                                                                                       | The ntds.dit was dumped via ntdsutil.exe. NTDS file acts as a database for Active Directory and stores all its data including all the credentials and this activity could be an indication of credentials dumping.                                                                                                                                                                    | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| Azure diagnostic settings deleted                                                                                                                 | Attackers can delete Azure diagnostic settings to reset the audit policy on certain resources. This activity allows them to disable certain activities from being recorded, thus removing evidence of their presence in the system.                                                                                                                                                   | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 1        |
| Windows event viewer disabled using Windows event viewer utility<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                           | Windows event logs can be disabled by attackers to limit the information that’s being recorded by the system and used for detections. One way to achieve this is by using the event viewer utility process ‘wevutil.exe’, which can directly disable or limit important event logs such as security.                                                                                  | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 3        |
| Disable windows crash dumps through the registry using the registry command tool                                                                  | Windows crash dumps was disable through the registry via the registry command tool. Crash dumps are created whenever the system experiences a crash, and contain a dump of the its memory. Attackers can disable crash dumps through the 'CrashDumpEnabled' registry value, thus making sure no traces are left when or if a crash will occurs.                                       | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| Disable windows crash dumps through the registry                                                                                                  | Windows crash dumps was disabled through the registry. Crash dumps are created whenever the system experiences a crash, and contain a dump of the its memory. Attackers can disable crash dumps through the 'CrashDumpEnabled' registry value, thus making sure no traces are left when or if a crash will occurs.                                                                    | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| DLL added to the authentication package registry key                                                                                              | A DLL has been added to the authentication package registry key, which could indicate malware persistence.                                                                                                                                                                                                                                                                            | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Microsoft Defender firewall disabled using PowerShell                                                                                             | The PowerShell command “Set-NetFirewallProfile” allows attackers do disable the Microsoft Defender firewall, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                                                                                                                                        | [Evasion](UseCases/uc_evasion.md)                                                                                       | Evasion                                                            | 2        |
| Web credentials accessed using the vault command tool                                                                                             | Web credentials stored in Windows Credential Manager have been accessed using the vault command tool.                                                                                                                                                                                                                                                                                 | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| LSA plugin load failed due to LSA protection                                                                                                      | An attempt to install an LSA plugin was made, which could indicate malware persistence. However, the attempt failed due to LSA protection.                                                                                                                                                                                                                                            | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 1        |
| Microsoft Defender firewall disabled through the registry                                                                                         | Microsoft Defender firewall in the registry was disabled. The Defender firewall registry value 'EnableFirewall' allows attackers to disable the Microsoft Defender firewall by setting it to 0, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                                                     | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Powershell keylogging using SetWindowsHookEx API                                                                                                  | PowerShell has been used to set up a keyboard monitor using Powershell SetWindowsHookEx API.                                                                                                                                                                                                                                                                                          | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| File added to the active setup registry key                                                                                                       | Active Setup is a Windows mechanism used to execute programs when a user logs in. An attacker can modify the program list via the registry, gaining persistence by causing their malicious programs to run at logon.                                                                                                                                                                  | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 1        |
| DLL added to the security packages registry key using the registry command tool                                                                   | A DLL has been added to the security packages registry key using the registry command tool, which could indicate malware persistence.                                                                                                                                                                                                                                                 | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 3        |
| User added to the local administrators Windows group using the net command                                                                        | A user has been added to the local administrators Windows group using the net command.                                                                                                                                                                                                                                                                                                | [Account Manipulation](UseCases/uc_account_manipulation.md)                                                             | Persistence                                                        | 2        |
| Windows Defender service stopped using the service console                                                                                        | The Windows Defender service has been stopped using the service console. This causes all Defender operations to stop.                                                                                                                                                                                                                                                                 | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Disable UAC through the registry using the registry command tool                                                                                  | User access control(UAC) has been disabled by modifying the corresponding registries using registry command tool                                                                                                                                                                                                                                                                      | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 3        |
| File association changed using 'assoc.exe'                                                                                                        | File association has been changed using 'assoc.exe'. Attackers can alter file associations to execute malicious code when a normal file is opened.                                                                                                                                                                                                                                    | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 1        |
| Large number of successful file write events for this user                                                                                        | This user has written 10 or more files in 1 minute.                                                                                                                                                                                                                                                                                                                                   | [Discovery](UseCases/uc_discovery.md)                                                                                   | Discovery                                                          | 2        |
| Login hook file created using the defaults command                                                                                                | A login hook file has been created using the 'defaults' command. A login hook is a file that points to a specific script to execute with root privileges upon user logon. Attackers can modify the login hook file ('com.apple.loginwindow.plist') to include their own malicious scripts in the login execution, gaining persistence in the system.                                  | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| NTDS copied from shadow copy<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                               | A shadowcopy command was used to change the location of the NTDS database via file activity. This activity may be an attempt at credential dumping.                                                                                                                                                                                                                                   | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| Scheduled task distribution using a GPO                                                                                                           | A scheduled task has been distributed using a Group Policy Object (GPO). GPO are domain-level policies that control the configuration of user and computer settings across the network. If compromised, attackers can modify GPOs to deploy malicious scheduled tasks, enabling code execution on multiple domain-joined machines.                                                    | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| Firefox login data file accessed                                                                                                                  | The Firefox login information database file has been accessed.                                                                                                                                                                                                                                                                                                                        | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Shadow copies deleted using the Windows Management Instrumentation command line tool<br><br>&#x26A0; Overlaps with Advanced Analytics rule.       | Volume shadow copies have been deleted using the Windows Management Instrumentation command line ('wmic.exe') process.                                                                                                                                                                                                                                                                | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| Large number of successful VPN logins from a single IP address                                                                                    | 10 successful VPN logins have been observed from a single IP address within 1 minute.                                                                                                                                                                                                                                                                                                 | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Sensitive database copy using the Extensible Storage Engine Utility process                                                                       | A sensitive database file has been copied using the Extensible Storage Engine Utility (esentutl.exe) process, a utility typically used for managing and backing up extensible storage engine databases. This activity may indicate an attempt to exfiltrate or tamper with critical data.                                                                                             | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| Setup UAC bypass by modifying sdclt.exe related shell configuration in the registry                                                               | A User Account Control (UAC) bypass has been configured by modifying the 'sdclt.exe' process shell configuration in the registry.                                                                                                                                                                                                                                                     | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| User hidden from the login screen through the registry<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                     | The UserList registry key can be modified to hide specific user accounts from the Windows login screen, concealing the presence of malicious users on the system.                                                                                                                                                                                                                     | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| Disable Windows Defender ETW through the registry using the registry command tool                                                                 | Windows Defender maintains an ETW (event tracing for Windows) component that logs security event for the Defender application. Disabling it through the 'WINEVT' registry path hinders Defender's capabilities and allows attackers to sneak by its detections.                                                                                                                       | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| AWS role brute force: Large amount of rule assumption events for this user                                                                        | More than 10 roles have been assumed by this user in 1 minute                                                                                                                                                                                                                                                                                                                         | [Discovery](UseCases/uc_discovery.md)                                                                                   | Discovery                                                          | 2        |
| Large amount of emails sent by this user                                                                                                          | This user has sent 50 or more emails in 5 hours.                                                                                                                                                                                                                                                                                                                                      | [Data Leak](UseCases/uc_data_leak.md)                                                                                   | Exfiltration                                                       | 2        |
| Powershell targeted remote endpoint                                                                                                               | PowerShell has been used to access a remote endpoint.                                                                                                                                                                                                                                                                                                                                 | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| Large number of unknown users failed to authenticate using Kerberos from this IP address                                                          | 5 or more unknown user names have requested a Kerberos authentication from this IP address in 10 minutes. Requesting Kerberos authentication tickets using multiple user names from the same source IP is an indication of Kerberos account enumeration.                                                                                                                              | [Abnormal Authentication Access](UseCases/uc_abnormal_authentication_access.md)                                         | Credential Access                                                  | 2        |
| File added to the startup folder                                                                                                                  | A file has been added to a startup folder, which could indicate malware persistence.                                                                                                                                                                                                                                                                                                  | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Windows event viewer service disabled using the service console                                                                                   | Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by directly shutting down the event logging service, causing event viewer auditing operation to stop.                                                                                                                | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 3        |
| File hidden using 'chflags'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                                | The 'chflags' Unix process can be used to hide files by modifying their attributes, ensuring they remain undetected by users.                                                                                                                                                                                                                                                         | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| Recycle bin autostart persistency through the registry using the registry command tool                                                            | The shell configuration of the recycle bin application has been modified through the registry using the registry command tool. This enables the execution of arbitrary code whenever the recycle bin is opened.                                                                                                                                                                       | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Setup UAC bypass by modifying MS settings shell configuration in the registry                                                                     | A User Account Control (UAC) bypass has been configured by modifying the Microsoft shell configuration in the registry.                                                                                                                                                                                                                                                               | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| User added to the RDP users Windows group with net command                                                                                        | A user has been added to the RDP users Windows group using the net command.                                                                                                                                                                                                                                                                                                           | [Account Manipulation](UseCases/uc_account_manipulation.md)                                                             | Persistence                                                        | 2        |
| File added to the active setup registry key using the registry command tool                                                                       | Active Setup is a Windows mechanism used to execute programs when a user logs in. An attacker can modify the program list via the registry, gaining persistence by causing their malicious programs to run at logon.                                                                                                                                                                  | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 1        |
| Ransom Note Dropped                                                                                                                               | Detects the creation of ransom notes indicative of internal system defacement by attackers.                                                                                                                                                                                                                                                                                           | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| Directory traversal                                                                                                                               | Identify requests attempting to access unauthorized directories using traversal sequences                                                                                                                                                                                                                                                                                             | [](UseCases/uc_.md)                                                                                                     | Initial Access                                                     | 1        |
| Disable history collection in Unix                                                                                                                | History collection can be disabled in unix shells by modifying the history environment variables. With the history disabled, attackers can perform malicious commands that will not be tracked by the collector.                                                                                                                                                                      | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| User added to the RDP users Windows group                                                                                                         | A user has been added to the RDP users Windows group.                                                                                                                                                                                                                                                                                                                                 | [Account Manipulation](UseCases/uc_account_manipulation.md)                                                             | Persistence                                                        | 2        |
| Create symbolic link for a shadow copy using mklink.exe<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                    | Attacker can create symbolic link to shadow copy and used this symbolic link for access files in the shadow copy including sensitive files , System Boot Key and browser offline credentials.                                                                                                                                                                                         | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Windows event viewer audit policy reverted to default state using the audit policy CLI                                                            | Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by using the 'auditpol.exe', which can clear the logging policy, stopping critical logs there were enabled beforehand from being recorded by the event viewer.                                                       | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 1        |
| Sysmon service was stopped using the service console                                                                                              | The Sysmon service has been stopped using the service console. This causes Sysmon to stop auditing logs which could be used by attackers to evade detection.                                                                                                                                                                                                                          | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Disable Windows Defender ETW through the registry                                                                                                 | Windows Defender maintains an ETW (event tracing for Windows) component that logs security event for the Defender application. Disabling it through the 'WINEVT' registry path hinders Defender's capabilities and allows attackers to sneak by its detections.                                                                                                                       | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Setup UAC bypass by modifying MSC shell configuration in the registry using the registry command tool                                             | A User Account Control (UAC) bypass has been configured by modifying the MSC (Microsoft Management Console) shell configuration in the registry using the registry command tool.                                                                                                                                                                                                      | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 3        |
| GCP logging bucket deleted                                                                                                                        | A GCP bucket containing logs has been successfuly deleted, which could indicate defense evasion.                                                                                                                                                                                                                                                                                      | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Plist startup file written                                                                                                                        | Attacker can modify property list files (plist files) to execute their code, gaining persistence in the system.                                                                                                                                                                                                                                                                       | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 1        |
| SAM copied from a shadow copy using 'copy.exe'                                                                                                    | The Security Accounts Manager (SAM) registry hive has been copied from a shadow copy using the 'copy.exe' process. The SAM file contains password hashes for local user accounts, this activity may indicate a credential dumping attempt.                                                                                                                                            | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| AWS CloudWatch log group deleted                                                                                                                  | Attackers can delete AWS CloudWatch groups to stop logs from being sent to those groups, thus removing evidence of their presence in the system.                                                                                                                                                                                                                                      | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 1        |
| Windows logon script added to the registry                                                                                                        | The 'UserInitLogonScript' is a registry key that stores initialization scripts intended to execute when a user logs in. Attackers can insert their own malicious script to this key, gaining persistence on the system.                                                                                                                                                               | [Malware](UseCases/uc_malware.md)                                                                                       | Malware                                                            | 2        |
| Windows system backup deletion with WBAdmin                                                                                                       | Windows system backup has been deleted using the Windows Backup Administrator (WBAdmin)                                                                                                                                                                                                                                                                                               | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| Large number of failed VPN logins from a single IP address                                                                                        | 10 failed VPN logins have been observed from a single IP address within 1 minute.                                                                                                                                                                                                                                                                                                     | [Brute Force Attack](UseCases/uc_brute_force_attack.md)                                                                 | Credential Access                                                  | 3        |
| Lsass dump with process dump tools                                                                                                                | LSASS can store credentials and the memory can be dumped to harvest encrypted or plaintext passwords.                                                                                                                                                                                                                                                                                 | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 4        |
| AWS powerful policy creation<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                               | Policy was created with critical permissions. Policies in AWS are the documents that dictates what permissions are granted to identites and resources. By creating a new policy or modifying existing one, an attacker might provide himself arbitrary permissions and perform privilege escalation.                                                                                  | [Account Manipulation](UseCases/uc_account_manipulation.md)                                                             | Persistence                                                        | 2        |
| Domain controller SPN added to an AD endpoint object<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                       | A new Active Directory object has been created, indicating the establishment of a new domain controller. When this happens, all Active Directory information and secrets are copied to the new domain controller. This is notable because the specific events observed are not common.                                                                                                | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Windows Defender service disabled                                                                                                                 | The Windows Defender service has been disabled disabled. This causes all Defender operations to stop.                                                                                                                                                                                                                                                                                 | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Passwd or Shadow file unshadowed                                                                                                                  | Passwd or Shadow file was unshadowed. The Unshadow tool combines user account details and user's password details.                                                                                                                                                                                                                                                                    | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 4        |
| Windows Credential Manager vault file accessed                                                                                                    | A Windows Credential Manager vault file has been accessed                                                                                                                                                                                                                                                                                                                             | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Directory ownership changed using 'takeown.exe'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                            | Attackers can use the 'takeown.exe' process to take ownership of desired directories, effectively disabling and evading ACLs and getting full control over the data.                                                                                                                                                                                                                  | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| Setup UAC bypass by modifying MSC shell configuration in the registry                                                                             | A User Account Control (UAC) bypass has been configured by modifying the MSC (Microsoft Management Console) shell configuration in the registry.                                                                                                                                                                                                                                      | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| Login with remote command tools                                                                                                                   | User logged on to a remote endpoint using remote command tools                                                                                                                                                                                                                                                                                                                        | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| Web activity associated with CVE-2021-44228 was observed<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                   | Web activity containing a URL, user agent, mime or referrer with JNDI strings related to CVE-2021-44228 has been observed.                                                                                                                                                                                                                                                            | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Initial Access                                                     | 1        |
| GCP instance logon script created<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                          | GCP instances can be assigned a logon script from the compute service by modifying the instance's metadata keys. Attackers can exploit this feature to include their malicious script, gaining elevated permissions and persistence on the instance.                                                                                                                                  | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence , Privilege Escalation                                 | 2        |
| Bitsadmin remote download with powershell via the command line<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                             | User downloaded BITSAdmin tool remotely using Powershell. BITS jobs could be used for persisting or evading detection after executing malicious payloads.                                                                                                                                                                                                                             | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| PowerCat downloaded using PowerShell<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                       | The PowerCat tool has been downloaded using a PowerShell script.                                                                                                                                                                                                                                                                                                                      | [Malware](UseCases/uc_malware.md)                                                                                       | Execution                                                          | 1        |
| Sysmon was uninstalled                                                                                                                            | Sysmon has been uninstalled. This causes Sysmon to stop auditing logs which could be used by attackers to evade detection.                                                                                                                                                                                                                                                            | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 1        |
| File added to the winlogon helper dll autorun registry key using the registry command tool<br><br>&#x26A0; Overlaps with Advanced Analytics rule. | A file has been added to the Winlogon helper DLL autorun registry key using a registry command tool, which could indicate malware persistence.                                                                                                                                                                                                                                        | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Bitsadmin persistency setup with setnotifycmdline                                                                                                 | User setup Bitsadmin persistency using setnotifycmdline. BITS jobs could be used for persisting or evading detection after executing malicious payloads.                                                                                                                                                                                                                              | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Network scan: Network communication to a large number of endpoints from this endpoint<br><br>&#x26A0; Overlaps with Advanced Analytics rule.      | This endopint has communicated with 20 destination endpoints over the network in 1 minute. This may be an indication of a network scan.                                                                                                                                                                                                                                               | [Discovery](UseCases/uc_discovery.md)                                                                                   | Discovery                                                          | 2        |
| System Restore scheduled task disabled using the scheduled tasks command                                                                          | The System Restore task has been disabled using the scheduled tasks command.                                                                                                                                                                                                                                                                                                          | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| SilentCleanup UAC bypass by windir registry modification using the registry command tool                                                          | A User Account Control (UAC) bypass has been executed by modifying the 'WinDir' registry value using the registry command tool.                                                                                                                                                                                                                                                       | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 3        |
| Large number of failed logins to this platform for this user                                                                                      | This user has failed to login to this platform 10 or more times in 1 minute.                                                                                                                                                                                                                                                                                                          | [Brute Force Attack](UseCases/uc_brute_force_attack.md)                                                                 | Credential Access                                                  | 3        |
| Modify RDP local port number through the registry using the registry command tool                                                                 | Remote Desktop Protocol (RDP) local port has been modified via registry using registry command tool                                                                                                                                                                                                                                                                                   | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| MMC Dll hijacking and UAC bypass via COR_PROFILER registry modification using the registry command tool                                           | MMC Dll hijacking and UAC bypass via COR_PROFILER registry modification using the registry command tool.                                                                                                                                                                                                                                                                              | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 3        |
| CrowdStrike Falcon uninstallation process was initiated                                                                                           | The CrowdStrike Falcon uninstallation process was initiated. This can disable the EDR defenses on the system which could be an indication of defense evasion and impaired defenses.                                                                                                                                                                                                   | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Large number of failed logins to this endpoint for this user                                                                                      | This user has failed to login to this endpoint 10 or more times in 1 minute.                                                                                                                                                                                                                                                                                                          | [Brute Force Attack](UseCases/uc_brute_force_attack.md)                                                                 | Credential Access                                                  | 3        |
| Windows hidden file creation using 'attrib.exe'                                                                                                   | The 'attrib.exe' windows process can be used to make files hidden by modifying their attributes, making sure they remain undetected by users.                                                                                                                                                                                                                                         | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Cross-site Scripting                                                                                                                              | Monitor for web requests containing suspicious input patterns which may indicate cross-site scripting attempts                                                                                                                                                                                                                                                                        | [](UseCases/uc_.md)                                                                                                     | Initial Access                                                     | 1        |
| Disable .Net ETW through the registry                                                                                                             | The .NET framework maintains an ETW (event tracing for Windows) component that logs .NET related events. Disabling it through the “ETWEnabled” registry value allows attackers to sneak by .NET detections.                                                                                                                                                                           | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| AWS root login without MFA                                                                                                                        | A user has logged in to AWS as root without Multi Factor Authentication(MFA)                                                                                                                                                                                                                                                                                                          | [Abnormal Authentication Access](UseCases/uc_abnormal_authentication_access.md)                                         | Defense Evasion, Persistence, Privilege Escalation, Initial Access | 2        |
| File hidden using 'setfile'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                                | The 'setfile' Unix process can be used to hide files by modifying their attributes, ensuring they remain undetected by users.                                                                                                                                                                                                                                                         | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| Native Windows network sniffing using 'netsh.exe'                                                                                                 | Native windows network sniffing with netsh was performed which could be an indicator of credentials being compromised.                                                                                                                                                                                                                                                                | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 1        |
| Windows event viewer disabled by modifying the audit policy using the audit policy CLI                                                            | Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by using the 'auditpol.exe', which can directly disable or limit important event logs such as security.                                                                                                              | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Lateral Movement                                                   | 3        |
| UFW disabled                                                                                                                                      | The UFW (Uncomplicated Firewall) has been disabled using the UFW command line tool. This enables potentially malicious network communications to be allowed into and out of the endpoint.                                                                                                                                                                                             | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| Azure event hub deleted                                                                                                                           | Azure event hub was deleted. Attackers can delete Azure event hubs to stop logs from being sent to those hubs, thus removing evidence of their presence in the system.                                                                                                                                                                                                                | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Windows event viewer service stopped                                                                                                              | Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by directly shutting down the event logging service, causing event viewer auditing operation to stop.                                                                                                                | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 3        |
| File added to the port monitor registry key                                                                                                       | A file has been added to the port monitor registry key, which could indicate malware persistence.                                                                                                                                                                                                                                                                                     | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Bitsadmin remote download                                                                                                                         | User downloaded BITSAdmin tool remotely. BITS jobs could be used for persisting or evading detection after executing malicious payloads.                                                                                                                                                                                                                                              | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| AWS instance logon script creation<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                         | AWS instances can be assigned a logon script from the EC2 service by modifying the 'userdata' property in the instance attributes. Attackers can leverage this feature to include their own malicious script and gain elevated permissions and persistency on the instance.                                                                                                           | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence , Privilege Escalation                                 | 2        |
| SAM registry hive download using the registry command tool                                                                                        | The Security Accounts Manager (SAM) registry hive has been extracted using the registry command tool. The SAM file contains password hashes for local user accounts, this activity may indicate a credential dumping attempt.                                                                                                                                                         | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| Bitsadmin persistent task executed                                                                                                                | Bitsadmin persistence task was executed.                                                                                                                                                                                                                                                                                                                                              | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion, Persistence                                       | 1        |
| Cached Credential Dump via Cmdkey<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                          | Cmdkey.exe was used to look for cached credentials. Attackers may dump credentials to get account logins from the operation system and software to perform lateral movement.                                                                                                                                                                                                          | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Software and data integrity failures web root                                                                                                     | Detect unauthorized changes to critical files, unsigned software updates, or tampering with CI/CD pipelines.                                                                                                                                                                                                                                                                          | [](UseCases/uc_.md)                                                                                                     | Initial Access                                                     | 1        |
| File system utility journal was deleted using 'fsutil.exe'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                 | A file system utility journal has been deleted using the file system utility tool, which could indicate defense evasion.                                                                                                                                                                                                                                                              | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Bit job creation                                                                                                                                  | User created a bit job. BITS jobs could be used for persisting or evading detection after executing malicious payloads.                                                                                                                                                                                                                                                               | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| TGT ticket obtained with weak encryption<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                   | Weak encryption protocols have been used to obtain Kerberos tickets. These tickets are vulnerable to offline brute force attacks and may result in compromised credentials.                                                                                                                                                                                                           | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| AWS public access block was removed                                                                                                               | AWS public access block was removed from bucket. This allows public access to the bucket which can lead to leaked credentials, logs, or other cloud storage objects without proper permissions.                                                                                                                                                                                       | [Cloud Data Protection](UseCases/uc_cloud_data_protection.md)                                                           | Collection                                                         | 2        |
| Lsass dump creation with taskmgr                                                                                                                  | LSASS can store credentials and the memory can be dumped by taskmgr.exe to harvest encrypted or plaintext passwords.                                                                                                                                                                                                                                                                  | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 4        |
| Bitsadmin remote download with powershell                                                                                                         | User downloaded BITSAdmin tool remotely using Powershell. BITS jobs could be used for persisting or evading detection after executing malicious payloads.                                                                                                                                                                                                                             | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| RC script file modified                                                                                                                           | RC scripts are script files that are used by the Unix system to manage custom services are are executed during startup. Attackers can modify these files (named 'rc.local' and 'rc.common') to gain persistency on in the system and cause malicious code to execute automatically.                                                                                                   | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 1        |
| Large number of share ports accessed by this user                                                                                                 | This user has accessed shares from 24 or more source ports in 1 day.                                                                                                                                                                                                                                                                                                                  | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation, Discovery                                    | 3        |
| DLL added to the authentication package registry key using the registry command tool                                                              | A DLL has been added to the authentication package registry key using the registry command tool, which could indicate malware persistence.                                                                                                                                                                                                                                            | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Setup UAC bypass by modifying MS settings shell configuration in the registry using the registry command tool                                     | A User Account Control (UAC) bypass has been configured by modifying the Microsoft shell configuration in the registry using the registry command tool.                                                                                                                                                                                                                               | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 3        |
| Service Stop                                                                                                                                      | Monitors for the stopping of services, which could indicate attempts to disrupt system operations or evade detection.                                                                                                                                                                                                                                                                 | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 1        |
| 'Show hidden' feature disabled through registry<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                            | Setting these registry values to 0 disables the ability for windows users to view hidden files, potentially ensuring the stealthiness of malicious files                                                                                                                                                                                                                              | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Port forwarding configured using 'netsh.exe'<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                               | Port forwarding has been configured using the Network Shell command line utility.                                                                                                                                                                                                                                                                                                     | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Command and Control                                                | 2        |
| GCP log sink deleted                                                                                                                              | Attackers can delete GCP log sinks to prevent logs from being sent to them, thereby removing evidence of their presence in the system.                                                                                                                                                                                                                                                | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Setup UAC bypass by modifying sdclt.exe related shell configuration in the registry using the registry command tool                               | A User Account Control (UAC) bypass has been configured by modifying the 'sdclt.exe' process shell configuration in the registry using the registry command tool.                                                                                                                                                                                                                     | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 3        |
| Shadow copies deleted using the Volume Shadow Copy Service Administration tool<br><br>&#x26A0; Overlaps with Advanced Analytics rule.             | Volume shadow copies have been deleted using the Volume Shadow Copy Service Administration ('vssadmin.exe') process.                                                                                                                                                                                                                                                                  | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| Large amount of badge access failures to different doors for this badge id                                                                        | This badge id has failed to access 5 or more different doors in 1 day.                                                                                                                                                                                                                                                                                                                | [Physical Security](UseCases/uc_physical_security.md)                                                                   | Defense Evasion, Persistence, Privilege Escalation, Initial Access | 2        |
| File added to the print processors registry key                                                                                                   | A file has been added to the print processors registry key, which could indicate malware persistence.                                                                                                                                                                                                                                                                                 | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Insecure design remote JMX access                                                                                                                 | Monitor for application behavior that exposes sensitive functionality without proper controls, such as debug endpoints or unprotected admin interfaces.                                                                                                                                                                                                                               | [](UseCases/uc_.md)                                                                                                     | Initial Access                                                     | 1        |
| Shadow copy creation using WMI<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                             | A Shadow Copy has been created using the Windows Management Instrumentation command line ('wmic.exe') process.                                                                                                                                                                                                                                                                        | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| System Restore disabled through the registry using the registry command tool                                                                      | System Restore has been disabled by modifying the registry using the registry command tool.                                                                                                                                                                                                                                                                                           | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| Disable UAC through the registry                                                                                                                  | User access control(UAC) has been disabled by modifying the corresponding registries                                                                                                                                                                                                                                                                                                  | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| Login hook file created                                                                                                                           | A login hook is a file that points to a specific script to execute with root privileges upon user logon. Attackers can modify the login hook file ('com.apple.loginwindow.plist') to include their own malicious scripts in the login execution, gaining persistence in the system.                                                                                                   | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 1        |
| Failed logins to a large number of endpoints from this endpoint                                                                                   | Failed logins have been observed to 10 or more different destination endpoints from this source endpoint in 10 minutes.                                                                                                                                                                                                                                                               | [Brute Force Attack, lateral Movement](UseCases/uc_brute_force_attack, lateral_movement.md)                             | Credential Access                                                  | 3        |
| WMI powershell invocation on remote endpoint                                                                                                      | Windows Management Instrumentation (WMI) was executed on a remote endpoint using Powershell                                                                                                                                                                                                                                                                                           | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| Windows Defender service disabled using the service console                                                                                       | The Windows Defender service has been disabled using the service console. This causes all Defender operations to stop.                                                                                                                                                                                                                                                                | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Windows event viewer service stopped using the service console                                                                                    | Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by directly shutting down the event logging service, causing event viewer auditing operation to stop.                                                                                                                | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 3        |
| DLL added to the time providers registry key                                                                                                      | A DLL has been added to the time providers registry key, which could indicate malware persistence.                                                                                                                                                                                                                                                                                    | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Powershell remote activation<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                               | Activating Powershell on remote endpoints for lateral movement                                                                                                                                                                                                                                                                                                                        | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| Edge login data file accessed                                                                                                                     | The Microsoft Edge login information database file has been accessed.                                                                                                                                                                                                                                                                                                                 | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| File added to the registry run key                                                                                                                | A file has been added to the registry run key, which could indicate malware persistence.                                                                                                                                                                                                                                                                                              | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| Scheduled task creation on remote endpoint using the scheduled tasks tool<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                  | A scheduled task has been created on a remote system using the scheduled task management process.                                                                                                                                                                                                                                                                                     | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| desktopimgdownldr utility used to download a remote file                                                                                          | User executed desktopimgdownldr utility for downloading a remote file.                                                                                                                                                                                                                                                                                                                | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| RC script file modified using a command                                                                                                           | RC scripts are script files that are used by the Unix system to manage custom services are are executed during startup. Attackers can modify these files (named 'rc.local' and 'rc.common') to gain persistency on in the system and cause malicious code to execute automatically.                                                                                                   | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 1        |
| User added to the local administrators Windows group                                                                                              | A user has been added to the local administrators Windows group.                                                                                                                                                                                                                                                                                                                      | [Account Manipulation](UseCases/uc_account_manipulation.md)                                                             | Persistence                                                        | 2        |
| Windows logon script added to the registry using the registry command tool                                                                        | The 'UserInitLogonScript' is a registry key that stores initialization scripts intended to execute when a user logs in. Attackers can insert their own malicious script to this key, gaining persistence on the system.                                                                                                                                                               | [Malware](UseCases/uc_malware.md)                                                                                       | Malware                                                            | 2        |
| Security log disabled by creating the 'MiniNt' registry key                                                                                       | The Windows Security Log has been disabled by creating the 'MiniNt' registry key. This key causes Windows to malfunction and stop auditing events in the security log. Disabling Windows event logs limits the information recorded by the system, hindering detection efforts.                                                                                                       | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Shadow copies deleted using PowerShell                                                                                                            | Volume shadow copies have been deleted using Powershell.                                                                                                                                                                                                                                                                                                                              | [Ransomware](UseCases/uc_ransomware.md)                                                                                 | Impact                                                             | 2        |
| User added to an administrative AD group using the net command                                                                                    | A user has been added to an administrative Active Directory group using the net command.                                                                                                                                                                                                                                                                                              | [Account Manipulation](UseCases/uc_account_manipulation.md)                                                             | Persistence                                                        | 3        |
| NTDS copied from shadow copy with a command                                                                                                       | A shadowcopy command was used to change the location of the NTDS database via copy.exe process. This is usually a sign of attempting to do a NTDS credentials dump.                                                                                                                                                                                                                   | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 3        |
| A process associated with CVE-2021-44228 was executed<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                      | A process execution with JNDI command line strings related to CVE-2021-44228 has been observed.                                                                                                                                                                                                                                                                                       | [Malware](UseCases/uc_malware.md)                                                                                       | Initial Access                                                     | 2        |
| Modify RDP local port number through the registry                                                                                                 | Remote Desktop Protocol (RDP) local port has been modified via registry                                                                                                                                                                                                                                                                                                               | [Lateral Movement](UseCases/uc_lateral_movement.md)                                                                     | Lateral Movement                                                   | 1        |
| Powershell kerberos ticket request                                                                                                                | Powershell has requested a kerberos ticket which could indicate a forged ticket                                                                                                                                                                                                                                                                                                       | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 1        |
| Windows Defender service stopped                                                                                                                  | The Windows Defender service has been stopped. This causes all Defender operations to stop.                                                                                                                                                                                                                                                                                           | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Large amount of failed USB connections for this user                                                                                              | This user has failed to insert 5 or more USB devices in 12 hours.                                                                                                                                                                                                                                                                                                                     | [Data Exfiltration](UseCases/uc_data_exfiltration.md)                                                                   | Exfiltration                                                       | 2        |
| ETW removed using PowerShell                                                                                                                      | ETWs (event tracing for Windows) are logging components that audit events for applications and services such as Microsoft Defender, PowerShell, and other event viewer logs. By calling the PowerShell function 'Remove-EtwTraceProvider', attackers can disable any ETW, stopping logs from being audited and allowing them to sneak by detections.                                  | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| Windows event viewer cleared using Windows event viewer utility<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                            | Windows event viewer has been cleared using the Windows event viewer utility.                                                                                                                                                                                                                                                                                                         | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| An email subject associated with CVE-2021-44228 was observed<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                               | An email activity containing an email subject with JNDI strings related to CVE-2021-44228 has been observed.                                                                                                                                                                                                                                                                          | [Malware](UseCases/uc_malware.md)                                                                                       | Initial Access                                                     | 1        |
| Arbitrary command assigned to a file association via the registry using the registry command tool                                                 | Arbitrary command was assigned to a file association via the registry using the registry command tool. Attackers can modify the command key values and cause arbitrary commands to execute during file access.                                                                                                                                                                        | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| Base64 executable file stored in the registry                                                                                                     | Attackers can store raw executable files in the registry itself as a stealthy and effective method to access and later drop malware. A big indicator to this activity is if an entire executable header ("MZ") is written to a registry value. The string "TVqQA…" is a base64 encoded MZ header, and can be found typically when attackers hide their encoded malware in the system. | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 3        |
| Security log size reduced through the registry using the registry command tool                                                                    | Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by reducing the size of the security log file, causing incoming events to consistently overwrite older events or even to not be logged at all.                                                                       | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Disable .Net ETW through the registry using the registry command tool                                                                             | The .NET framework maintains an ETW (event tracing for Windows) component that logs .NET related events. Disabling it through the 'ETWEnabled' registry value allows attackers to sneak by .NET detections.                                                                                                                                                                           | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 2        |
| Large number of user switch events observed on this endpoint for this user                                                                        | This user has performed 5 or more user account switch events on the same endpoint in 5 minutes. The rule does not necessarily indicate unique user accounts. It may suggests potential unauthorized account usage or privilege escalation attempts.                                                                                                                                   | [Privilege Escalation, privilege Abuse](UseCases/uc_privilege_escalation, privilege_abuse.md)                           | Initial Access                                                     | 3        |
| Startup folder location changed through the registry using the registry command tool<br><br>&#x26A0; Overlaps with Advanced Analytics rule.       | The location of startup folder has been modified through the registry using the registry command tool. Attackers can leverage start up folders to gain persistency by executing arbitrary malicious code whenever the system performs a startup.                                                                                                                                      | [Malware](UseCases/uc_malware.md)                                                                                       | Persistence                                                        | 2        |
| ETW modified using 'logman.exe'                                                                                                                   | ETWs (event tracing for Windows) are logging components that audit events for applications and services such as Microsoft Defender, PowerShell, and other event viewer logs. By executing the log manager process (logman.exe), attackers can disable any ETW, stopping logs from being audited and allowing them to sneak by detections.                                             | [Evasion](UseCases/uc_evasion.md)                                                                                       | Defense Evasion                                                    | 1        |
| Windows event viewer cleared using WMI<br><br>&#x26A0; Overlaps with Advanced Analytics rule.                                                     | Windows event viewer has been cleared using WMI (Windows Management Instrumentation).                                                                                                                                                                                                                                                                                                 | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Server-side request forgery                                                                                                                       | Identifies outbound HTTP requests from internal servers to internal IP ranges that may indicate SSRF exploitation                                                                                                                                                                                                                                                                     | [](UseCases/uc_.md)                                                                                                     | Initial Access                                                     | 1        |
| Exflitration via printing: Large amount of pages printed for this user                                                                            | A user has been observed printing 100 pages in 12 hours.                                                                                                                                                                                                                                                                                                                              | [Data Exfiltration](UseCases/uc_data_exfiltration.md)                                                                   | Exfiltration                                                       | 3        |
| MMC Dll hijacking via COR_PROFILER registry modification                                                                                          | MMC Dll hijacking via COR_PROFILER registry modification.                                                                                                                                                                                                                                                                                                                             | [Privilege Escalation](UseCases/uc_privilege_escalation.md)                                                             | Privilege Escalation                                               | 2        |
| AWS CloudTrail disabled                                                                                                                           | Attackers can disable AWS CloudTrail logging in a cloud account, stopping audit logs from that account from being recorded and allowing the attackers to evade detection.                                                                                                                                                                                                             | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Chrome login data file database access                                                                                                            | User is trying to access encrypted credentials from Google Chrome browser                                                                                                                                                                                                                                                                                                             | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| LSA registry hive download with a command                                                                                                         | LSA registry hive was downloaded via commandline arguments. LSA secrets can contain credential materials and this activity could be an indication of credential dumping.                                                                                                                                                                                                              | [Compromised Credentials](UseCases/uc_compromised_credentials.md)                                                       | Credential Access                                                  | 2        |
| Security logging and monitoring failures Syslogd                                                                                                  | Alert when syslogd logging services are stopped                                                                                                                                                                                                                                                                                                                                       | [Audit Tampering](UseCases/uc_audit_tampering.md)                                                                       | Defense Evasion                                                    | 2        |
| Large amount of failed mailbox logins for this user                                                                                               | 10 failed mailbox login events have been observed for a single user within 1 minute.                                                                                                                                                                                                                                                                                                  | [Brute Force Attack](UseCases/uc_brute_force_attack.md)                                                                 | Credential Access                                                  | 3        |