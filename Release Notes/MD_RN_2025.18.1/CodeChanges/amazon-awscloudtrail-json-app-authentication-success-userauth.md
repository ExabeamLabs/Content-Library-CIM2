# Code Changes for amazon-awscloudtrail-json-app-authentication-success-userauth (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| changed_parsed_fields | N/A |  | ['account_id', 'app', 'aws_email_address', 'aws_user', 'email_address', 'email_domain', 'event_category', 'key_id', 'operation', 'region', 'role', 'src_host', 'src_ip', 'src_port', 'time', 'url', 'user', 'user_agent'] |
| edit_regex_field | aws_email_address |  | ['"userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', '"userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")', 'exa_json_path=$.additionalEventData.UserName,exa_regex=(({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+)))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))', 'exa_json_path=$.userIdentity.userName,exa_regex=(({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+)))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))', 'exa_regex="userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")'] |
| edit_regex_field | email_address |  | ['"userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', '"userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")', 'exa_json_path=$.additionalEventData.UserName,exa_regex=(({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+)))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))', 'exa_json_path=$.userIdentity.userName,exa_regex=(({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+)))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))', 'exa_regex="userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")'] |
| edit_regex_field | email_domain |  | ['"userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', '"userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")', 'exa_json_path=$.additionalEventData.UserName,exa_regex=(({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+)))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))', 'exa_json_path=$.userIdentity.userName,exa_regex=(({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+)))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))', 'exa_regex="userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")'] |
| edit_regex_field | user |  | ['"userIdentity"\s*:\s*\{[^\}]+(("type"\s*:\s*"Role")[^\}]*?"userName"\s*:\s*"({role}[^"]+)|"userName"\s*:\s*"({aws_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))"', 'exa_json_path=$.additionalEventData.UserName,exa_regex=(({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+)))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))', 'exa_json_path=$.userIdentity.userName,exa_regex=(({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+)))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+(("type"\s*:\s*"Role")[^\}]*?"userName"\s*:\s*"({role}[^"]+)|"userName"\s*:\s*"({aws_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))"'] |
| added_regex_field | url |  | ['"LoginTo":"({url}[^"]+?)"'] |