# Code Changes for amazon-awscloudtrail-json-app-success-awsserviceevent (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| edit_regex_field | account_id |  | ['"awsAccountId":"({account_id}[^"]+)"', '"userIdentity":[^\}]+"accountId":"({account_id}[^"]+)"'] |
| edit_regex_field | aws_email_address |  | ['"userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', '"userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")', 'exa_regex="userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")'] |
| edit_regex_field | aws_user |  | ['"userIdentity"\s*:\s*\{[^\}]+(("type"\s*:\s*"Role")[^\}]*?"userName"\s*:\s*"({role}[^"]+)|"userName"\s*:\s*"({aws_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))"', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+(("type"\s*:\s*"Role")[^\}]*?"userName"\s*:\s*"({role}[^"]+)|"userName"\s*:\s*"({aws_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))"'] |
| edit_regex_field | email_address |  | ['"userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', '"userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")', 'exa_regex="userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")'] |
| edit_regex_field | email_domain |  | ['"userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', '"userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")', 'exa_regex="userIdentity"\s*:\s*\{[^\}]*("type":\s*"AssumedRole")[^\}]+?"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+"principalId"\s*:\s*"([^},]+?(:({aws_email_address}({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))))?)"[^\}]+("type":\s*"AssumedRole")'] |
| edit_regex_field | role |  | ['"arn":\s*"[^"]*?role\/({role}[^\/"]+)[\/"]', '"userIdentity"\s*:\s*\{[^\}]+(("type"\s*:\s*"Role")[^\}]*?"userName"\s*:\s*"({role}[^"]+)|"userName"\s*:\s*"({aws_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))"', 'exa_regex="arn":\s*"[^"]*?role\/({role}[^\/"]+)[\/"]', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+(("type"\s*:\s*"Role")[^\}]*?"userName"\s*:\s*"({role}[^"]+)|"userName"\s*:\s*"({aws_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))"'] |
| edit_regex_field | user |  | ['"userIdentity"\s*:\s*\{[^\}]+(("type"\s*:\s*"Role")[^\}]*?"userName"\s*:\s*"({role}[^"]+)|"userName"\s*:\s*"({aws_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))"', 'exa_regex="userIdentity"\s*:\s*\{[^\}]+(("type"\s*:\s*"Role")[^\}]*?"userName"\s*:\s*"({role}[^"]+)|"userName"\s*:\s*"({aws_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))"'] |