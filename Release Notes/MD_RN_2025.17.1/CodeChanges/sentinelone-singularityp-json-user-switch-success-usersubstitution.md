# Code Changes for sentinelone-singularityp-json-user-switch-success-usersubstitution (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| added_parser | N/A |  | {"Vendor": "SentinelOne", "Product": "Singularity Platform", "TimeFormat": "yyyy-MM-dd'T'HH:mm:ss.SSSZ", "ExtractionType": "json", "Fields": ["\"timestamp\":\"({time}\d\d\d\d\-\d\d\-\d\dT\d\d:\d\d:\d\d\.\d\d\dZ)\"", "\"event\.type\":\"({event_name}[^\"]+)", "\"endpoint\.name\":\"({host}[^\"]+)", "\"task\.path\":\"({file_path}({file_dir}[^\"]+[\\\/]+)?({file_name}[^\\\"]+?(\.({file_ext}[^\\.\"]+?))?))\"", "process\.name\":\"({process_name}[^\"]+)", "\"endpoint.os\":\"({os}[^\"]+)", "\"event\.category\":\"({additional_info}[^\"]+)\"", "\"endpoint\.type\":\"({host_type}[^\"]+)", "\"src\.process\.pid\":({process_id}\d+)", "\"src\.process\.cmdline\":\"({process_command_line}.+?)\",", "\"account\.id\":\"({account_id}[^\"]+)", "\"src.process.user\":\"((({domain}[^\\\"]+))\\+)?(({user}Syst\u00e8me|LOCAL SERVICE|NETWORK SERVICE|[\w\.\-\!\#\^\~]{1,40}\$?))\"", "\"tgt.process.user\":\"((({dest_domain}[^\\\"]+))\\+)?((({dest_user}Syst\u00e8me|LOCAL SERVICE|NETWORK SERVICE|[^\\\"$\s]+?)|({dest_user_full_name}[^\"\s$]+\s[^\"\s$]+)))\"", "exa_json_path=$..timestamp,exa_field_name=time", "exa_json_path=$..['event.type'],exa_field_name=event_name", "exa_json_path=$..['endpoint.name'],exa_field_name=host", "exa_regex=\"task\.path\":\"({file_path}({file_dir}[^\"]+[\\\/]+)?({file_name}[^\\\"]+?(\.({file_ext}[^\\.\"]+?))?))\"", "exa_json_path=$..['src.process.name'],exa_field_name=process_name", "exa_json_path=$..['endpoint.os'],exa_field_name=os", "exa_json_path=$..['event.category'],exa_field_name=additional_info", "exa_json_path=$..['endpoint.type'],exa_field_name=host_type", "exa_json_path=$..['src.process.pid'],exa_field_name=process_id", "exa_json_path=$..['src.process.cmdline'],exa_field_name=process_command_line", "exa_json_path=$..['account.id'],exa_field_name=account_id", "exa_json_path=$..['src.process.user'],exa_regex=((({domain}[^\\\"$]+))\\+)?(({user}Syst\u00e8me|LOCAL SERVICE|NETWORK SERVICE|[\w\.\-\!\#\^\~]{1,40}\$?))($|\")", "exa_json_path=$..['tgt.process.user'],exa_regex=((({dest_domain}[^\\\"$]+))\\+)?((({dest_user}Syst\u00e8me|LOCAL SERVICE|NETWORK SERVICE|[^\\\"$\s]+?)|({dest_user_full_name}[^\"\s$]+\s[^\"\s$]+)))($|\")", "\"os.name\":\"({os}[^\"]+)\"", "\"endpoint.type\":\"({device_type}[^\"]+)\"", "\"src.process.parent.image.path\":\"+\s*({parent_process_path}({parent_process_dir}[^@]+?)[\\\/]*({parent_process_name}[^\"\\\/]+))\"", "\"src.process.image.path\":\"({process_path}({process_dir}(:?[\w:]+)?[^\"]*\\)({process_name}[^\"]+))\"", "\"src.process.pid\":({process_id}\d+)", "\"src.process.cmdline\":\"({process_command_line}.+?)\",", "\"event.id\":\"({event_id}[^\"]+)", "event.name\":\"({operation_type}[^\"]+)", "\"event.login.userName\":\"({user}[\w\.\-\!\#\^\~]{1,40}\$?)\"", "\"src.process.parent.name\":\"({grandparent_process_path}[^\"]+)", "\"src.process.image.md5\":\s*\\?\"+({hash_md5}[^\"\\]+)\"", "\"src\.process\.integrityLevel\":\"({alert_severity}[^\"]+)\"", "exa_json_path=$.['os.name'],exa_field_name=os", "exa_json_path=$.['endpoint.type'],exa_field_name=device_type", "exa_json_path=$.['src.process.parent.image.path'],exa_regex=({parent_process_path}({parent_process_dir}[^@]+?)[\\\/]*({parent_process_name}[^\"\\\/]+))$", "exa_json_path=$.['src.process.image.path'],exa_regex=({process_path}({process_dir}(:?[\w:]+)?[^\"]*\\)({process_name}[^\"]+))$", "exa_json_path=$.['src.process.pid'],exa_field_name=process_id", "exa_json_path=$.['src.process.cmdline'],exa_field_name=process_command_line", "exa_json_path=$.['event.id'],exa_field_name=event_id", "exa_regex=event.name\":\"({operation_type}[^\"]+)", "exa_json_path=$.['userSubstitution.fromUserName'],exa_regex=(({email_address}([A-Za-z0-9]+[!#$%&'+-\/=?^_`~])*[A-Za-z0-9]+@({email_domain}[^\]\s\"\\,\|]+\.[^\]\s\"\\,\|]+?))|({full_name}[^\s\"]+\s[^\"]+)|({user}[\w\.\-\!\#\^\~]{1,40}\$?))", "exa_json_path=$.['userSubstitution.toUserName'],exa_regex=(({dest_email_address}([A-Za-z0-9]+[!#$%&'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s\"\\,\|]+\.[^\]\s\"\\,\|]+?))|({dest_user_full_name}[^\s\"]+\s[^\"]+)|({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?))", "exa_regex=\"event.login.userName\":\"({user}[\w\.\-\!\#\^\~]{1,40}\$?)\"", "exa_json_path=$.['src.process.parent.name'],exa_field_name=grandparent_process_path", "exa_json_path=$.['src.process.image.md5'],exa_field_name=hash_md5", "exa_json_path=$.['src.process.integrityLevel'],exa_field_name=alert_severity", "exa_json_path=$.['account.name'],exa_field_name=account_name"], "Name": "sentinelone-singularityp-json-user-switch-success-usersubstitution", "ParserVersion": "v1.0.0", "Conditions": ["\"dataSource.name\":\"SentinelOne\"", "\"event.category\":\"user_substitution\"", "\"event.type\":\"User Substitution\""]} |