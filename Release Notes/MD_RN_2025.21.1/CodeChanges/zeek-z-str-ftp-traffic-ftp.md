# Code Changes for zeek-z-str-ftp-traffic-ftp (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| changed_parsed_fields | N/A |  | ['arg', 'bytes', 'command', 'dest_ip', 'dest_port', 'id_orig_h', 'id_orig_p', 'id_resp_h', 'id_resp_p', 'mime', 'object', 'password', 'src_ip', 'src_port', 'time', 'user', 'user_uid'] |
| edit_regex_field | arg |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | bytes |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*', '\d{10}\.\d{6}\s([^\s]+\s){8}(?:-|({object}[^\s]+))\s+(?:-|({mime}[^\s]+))\s+(?:-|({bytes}\d+))\s*'] |
| edit_regex_field | command |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | id_orig_h |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | id_orig_p |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | id_resp_h |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | id_resp_p |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | password |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | time |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | user |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| edit_regex_field | user_uid |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| added_regex_field | dest_ip |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| added_regex_field | dest_port |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| added_regex_field | src_ip |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| added_regex_field | src_port |  | ['({time}\d{10})\.\d{6}\s+({user_uid}[^\s]+)\s+(({src_ip}({id_orig_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_orig_p}({src_port}\d+?))|[^\s]+)\s+(({dest_ip}({id_resp_h}(\d{1,3}\.){3}\d{1,3}|([A-Fa-f0-9%.]*:[A-Fa-f0-9%.:]+(th0)?)))|[^\s]+)\s+(({id_resp_p}({dest_port}\d+?))|[^\s]+)\s+({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s+({password}[^\s]+)\s+({command}[^\s]+)\s+({arg}[^\s]+)\s+([^\s]+)\s+({bytes}\d+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+?)\s*'] |
| removed_attribute | DupFields |  | N/A |