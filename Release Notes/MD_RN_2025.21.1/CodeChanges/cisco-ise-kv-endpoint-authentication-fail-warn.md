# Code Changes for cisco-ise-kv-endpoint-authentication-fail-warn (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| changed_parsed_fields | N/A |  | ['additional_info', 'auth_server', 'computer_name', 'dest_host', 'dest_ip', 'dest_mac', 'dest_port', 'domain', 'email_address', 'email_domain', 'event_code', 'event_name', 'failure_reason', 'host', 'location', 'nas_ip_address', 'network', 'protocol', 'src_host', 'src_ip', 'src_mac', 'src_port', 'ssid', 'time', 'user'] |
| edit_regex_field | dest_ip |  | [', AD-Host-Resolved-Identities=((::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[^\s,@]+)[^,]*\s*)', ', Framed-IP-Address=(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?,', 'AD-User-Candidate-Identities=((::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[\w\-.]+)),', 'Called-Station-ID=(({dest_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[\w\-.]+))(:({ssid}[^,]+))?,', 'DestinationIPAddress=(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?', 'DestinationIPAddress=({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?'] |
| edit_regex_field | dest_port |  | [', AD-Host-Resolved-Identities=((::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[^\s,@]+)[^,]*\s*)', ', Framed-IP-Address=(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?,', 'AD-User-Candidate-Identities=((::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[\w\-.]+)),', 'Called-Station-ID=(({dest_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[\w\-.]+))(:({ssid}[^,]+))?,', 'DestinationIPAddress=(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?', 'DestinationIPAddress=({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?', 'DestinationPort=({dest_port}\d+)', 'DestinationPort=({dest_port}\d+),'] |
| edit_regex_field | domain |  | [', User-?Name=((host\/)({src_host}[^,]+)|((::ffff:)?(?!(host\/)))?(({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|((([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(({domain}[^\\\/,]+)[\\\/]+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?))))', ', UserName=host\/[^.]+\.({domain}[^,]+),\s*NAS-IP-Address', 'User-?Name=((?!(host\/[\w\-\.]+))({domain}[^,;]+?)[\\\/]+)?(([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2}|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({user}[\w\.\-\!\#\^\~]{1,40}\$?))|host\/({src_host}[\w\-.]+)),', 'User-Name=(({domain}[^\\=]+)\\\\)?(({email_address}[^@=]+?@[^\.]+\.[^,]+)|([^\/=]+\/({src_host}[^,]+))|(USERNAME|INVALID|Anonymous identity|([\da-fA-F]{2}-){5}[\da-fA-F]{2}|({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] |
| edit_regex_field | email_address |  | [', User-?Name=((host\/)({src_host}[^,]+)|((::ffff:)?(?!(host\/)))?(({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|((([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(({domain}[^\\\/,]+)[\\\/]+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?))))', 'User-?Name=((?!(host\/[\w\-\.]+))({domain}[^,;]+?)[\\\/]+)?(([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2}|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({user}[\w\.\-\!\#\^\~]{1,40}\$?))|host\/({src_host}[\w\-.]+)),', 'User-?Name=(([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2}|host\/({src_host}[\w\-.]+)|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({user}[\w\.\-\!\#\^\~]{1,40}\$?)))\s*(,|;)', 'User-Name=(({domain}[^\\=]+)\\\\)?(({email_address}[^@=]+?@[^\.]+\.[^,]+)|([^\/=]+\/({src_host}[^,]+))|(USERNAME|INVALID|Anonymous identity|([\da-fA-F]{2}-){5}[\da-fA-F]{2}|({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] |
| edit_regex_field | host |  | ['({host}[\w\-.]+)\s({additional_info}CISE_RADIUS_Diagnostics)', '\s(::ffff:)?({host}(?!\d\d:\d\d:\d\d)[\w.\-]+)\s+(\S+\s+){3}(\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d\.\d\d\d)', '\s(::ffff:)?({host}(?!\d\d:\d\d:\d\d)[\w.\-]+)\s+(\S+\s+){4}(\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d\.\d\d\d)'] |
| edit_regex_field | src_host |  | [', Calling-Station-ID=(({src_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?|(::ffff:)?({src_host}[\w\-.]+))', ', User-?Name=((host\/)({src_host}[^,]+)|((::ffff:)?(?!(host\/)))?(({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|((([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(({domain}[^\\\/,]+)[\\\/]+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?))))', 'User-?Name=((?!(host\/[\w\-\.]+))({domain}[^,;]+?)[\\\/]+)?(([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2}|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({user}[\w\.\-\!\#\^\~]{1,40}\$?))|host\/({src_host}[\w\-.]+)),', 'User-?Name=(([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2}|host\/({src_host}[\w\-.]+)|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({user}[\w\.\-\!\#\^\~]{1,40}\$?)))\s*(,|;)', 'User-Name=(({domain}[^\\=]+)\\\\)?(({email_address}[^@=]+?@[^\.]+\.[^,]+)|([^\/=]+\/({src_host}[^,]+))|(USERNAME|INVALID|Anonymous identity|([\da-fA-F]{2}-){5}[\da-fA-F]{2}|({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] |
| edit_regex_field | src_ip |  | [', Calling-Station-ID=(({src_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?|(::ffff:)?({src_host}[\w\-.]+))', ', Device IP Address=(::ffff:)?({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?,', 'Device IP Address=({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?'] |
| edit_regex_field | src_port |  | [', Calling-Station-ID=(({src_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?|(::ffff:)?({src_host}[\w\-.]+))', ', Device IP Address=(::ffff:)?({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?,', 'Device IP Address=({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?', 'Device Port=({src_port}\d+)'] |
| edit_regex_field | time |  | ['({time}\d\d\d\d-\d\d-\d\d\s\d\d:\d\d:\d\d\.\d\d\d\s[+-]\d\d:\d\d)', '\s+\d+\s+({time}\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d)'] |
| edit_regex_field | user |  | [', User-?Name=((host\/)({src_host}[^,]+)|((::ffff:)?(?!(host\/)))?(({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|((([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(({domain}[^\\\/,]+)[\\\/]+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?))))', 'User-?Name=((?!(host\/[\w\-\.]+))({domain}[^,;]+?)[\\\/]+)?(([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2}|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({user}[\w\.\-\!\#\^\~]{1,40}\$?))|host\/({src_host}[\w\-.]+)),', 'User-?Name=(([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2}|host\/({src_host}[\w\-.]+)|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({user}[\w\.\-\!\#\^\~]{1,40}\$?)))\s*(,|;)', 'User-Name=(({domain}[^\\=]+)\\\\)?(({email_address}[^@=]+?@[^\.]+\.[^,]+)|([^\/=]+\/({src_host}[^,]+))|(USERNAME|INVALID|Anonymous identity|([\da-fA-F]{2}-){5}[\da-fA-F]{2}|({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] |
| added_regex_field | auth_server |  | [', Device IP Address=({auth_server}[^,]+),'] |
| added_regex_field | computer_name |  | [', AD-Host-Resolved-Identities=({computer_name}[^@,]+)'] |
| added_regex_field | dest_host |  | [', AD-Host-Resolved-Identities=((::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[^\s,@]+)[^,]*\s*)', 'AD-User-Candidate-Identities=((::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[\w\-.]+)),', 'Called-Station-ID=(({dest_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[\w\-.]+))(:({ssid}[^,]+))?,'] |
| added_regex_field | dest_mac |  | ['Called-Station-ID=(({dest_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[\w\-.]+))(:({ssid}[^,]+))?,'] |
| added_regex_field | email_domain |  | [', User-?Name=((host\/)({src_host}[^,]+)|((::ffff:)?(?!(host\/)))?(({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|((([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(({domain}[^\\\/,]+)[\\\/]+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?))))'] |
| added_regex_field | failure_reason |  | ['FailureReason=({failure_reason}[^,]+?),'] |
| added_regex_field | location |  | [', NetworkDeviceGroups=Location#All Locations#({location}[^,]+)'] |
| added_regex_field | nas_ip_address |  | ['NAS-IP-Address=({nas_ip_address}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))'] |
| added_regex_field | network |  | [', NetworkDeviceName=({network}[^,]+),'] |
| added_regex_field | protocol |  | ['\sProtocol=({protocol}[^,]+),'] |
| added_regex_field | src_mac |  | ['(?i)(MacAddress)=({src_mac}[^,\s]+),', ', Calling-Station-ID=(({src_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?|(::ffff:)?({src_host}[\w\-.]+))'] |
| added_regex_field | ssid |  | ['Called-Station-ID=(({dest_mac}([a-fA-F\d]{2}[-:]){5}[a-fA-F\d]{2})|(::ffff:)?({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?|(::ffff:)?({dest_host}[\w\-.]+))(:({ssid}[^,]+))?,'] |