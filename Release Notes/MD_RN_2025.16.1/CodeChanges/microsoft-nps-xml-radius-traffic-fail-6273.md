# Code Changes for microsoft-nps-xml-radius-traffic-fail-6273 (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| edit_regex_field | auth_server |  | ['(\'|")AuthenticationProvider(\'|")>(?:-|({auth_server}[^\<]+))'] |
| edit_regex_field | dest_host |  | ['<Data Name=(\'|")ClientName(\'|")>({dest_host}[\w\-.]+)<'] |
| edit_regex_field | dest_ip |  | ['(\'|")NASIPv4Address(\'|")>({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?', '(\'|")NASIPv6Address(\'|")>({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?'] |
| edit_regex_field | dest_port |  | ['(\'|")NASIPv4Address(\'|")>({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?', '(\'|")NASIPv6Address(\'|")>({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?'] |
| edit_regex_field | domain |  | ['(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\/+)?({user_group_name}[^\s\<\/]+)(\/([^\/]+))?\/(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[^\s\/<]+\s+[^\s<\/]+))<', '(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\\+)?(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<', '(\'|")SubjectDomainName(\'|")>(?:-|({domain}[^\s\<]+))', '(\'|")SubjectUserName(\'|")>(?:({user_type}host)/)?(({domain}[^\\<]+)\\+)?(({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<'] |
| edit_regex_field | failure_code |  | ['<Data Name=(\'|")ReasonCode(\'|")>({failure_code}[^<]+)<'] |
| edit_regex_field | full_name |  | ['(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\/+)?({user_group_name}[^\s\<\/]+)(\/([^\/]+))?\/(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[^\s\/<]+\s+[^\s<\/]+))<', '(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\\+)?(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<', '(\'|")SubjectUserName(\'|")>(?:(host)/)?(({src_domain}[^\\<]+)\\+)?(([^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({src_user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<', '(\'|")SubjectUserName(\'|")>(?:({user_type}host)/)?(({domain}[^\\<]+)\\+)?(({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<'] |
| edit_regex_field | location |  | ['(\'|")NASIdentifier(\'|")>(?:-|({location}[\w\-.]+))'] |
| edit_regex_field | result_reason |  | ['(\'|")Reason(\'|")>({result_reason}[^<]+)'] |
| edit_regex_field | src_domain |  | ['(\'|")SubjectDomainName(\'|")>(?:-|({src_domain}[^\s\<]+))', '(\'|")SubjectUserName(\'|")>(?:(host)/)?(({src_domain}[^\\<]+)\\+)?(([^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({src_user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<'] |
| edit_regex_field | src_user |  | ['(\'|")SubjectUserName(\'|")>(?:(host)/)?(({src_domain}[^\\<]+)\\+)?(([^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({src_user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<'] |
| edit_regex_field | user |  | ['(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\/+)?({user_group_name}[^\s\<\/]+)(\/([^\/]+))?\/(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[^\s\/<]+\s+[^\s<\/]+))<', '(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\\+)?(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<', '(\'|")SubjectUserName(\'|")>(?:({user_type}host)/)?(({domain}[^\\<]+)\\+)?(({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<'] |
| edit_regex_field | user_group_name |  | ['(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\/+)?({user_group_name}[^\s\<\/]+)(\/([^\/]+))?\/(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[^\s\/<]+\s+[^\s<\/]+))<'] |
| edit_regex_field | user_type |  | ['(\'|")FullyQualifiedSubjectMachineName(\'|")>(?:-|({user_type}.+?))(\/[^\/\s]+)?<', '(\'|")SubjectUserName(\'|")>(?:({user_type}host)/)?(({domain}[^\\<]+)\\+)?(({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<'] |
| edit_regex_field | user_upn |  | ['(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\/+)?({user_group_name}[^\s\<\/]+)(\/([^\/]+))?\/(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[^\s\/<]+\s+[^\s<\/]+))<', '(\'|")FullyQualifiedSubjectUserName(\'|")>(({domain}[^\\\/<]+)\\+)?(?:-|({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<', '(\'|")SubjectUserName(\'|")>(?:({user_type}host)/)?(({domain}[^\\<]+)\\+)?(({user_upn}[^@\s\\\<\/]+@[^@\s\\\<\/]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(\.[\w.]+)?)|({full_name}[\w,-]+?))<'] |