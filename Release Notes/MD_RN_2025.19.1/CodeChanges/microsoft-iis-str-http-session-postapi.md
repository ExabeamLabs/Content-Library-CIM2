# Code Changes for microsoft-iis-str-http-session-postapi (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| added_parser | N/A |  | {"Name": "microsoft-iis-str-http-session-postapi", "Vendor": "Microsoft", "Product": "Microsoft IIS", "TimeFormat": ["epoch_sec", "MMM dd yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss"], "Conditions": [" POST /api"], "VendorMatch": true, "Fields": ["({time}\w+ \d\d \d\d\d\d \d\d:\d\d:\d\d)\s+", "({time}\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})\s({dest_ip}[\da-fA-F.:]+)\s({method}[^\s]+)\s", "\s\d{2}:\d{2}:\d{2}\s([^\s]+\s){2}({uri_path}[^\s]+)\s(-|({uri_query}[^\s]+))\s({dest_port}\d+)\s(({domain}[^\\\"]+)\\)?(-|(S(-\d+){6}-\d+)|({email_address}([A-Za-z0-9]+[!#$%&'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s\"\\,\|]+\.[^\]\s\"\\,\|]+)|(({user}[\w\.\-\!\#\^\~]{1,40}\$?)(@({=domain}[^\s]+))?))\s[^\s]+\s\"?(-|({user_agent}[^\s\"]+))\"?\s\S+\s({http_response_code}\d+)\s([^\s]+\s){3}(?:[\d\.]+,)?(-|({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){1,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4})))", "\s+({http_response_code}\d+)(\s+\d+){3}", "({time}\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})\s({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){1,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))\s({method}POST)?\s*([^\s]+\s){2}({dest_port}\d+)\s(({domain}[^\\\s]+)\\+)?(-|({user}[\w\.\-]{1,40}))?\s*({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){1,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))\s({user_agent}[^\s]+)\s({url}[^\s]+)\s({http_response_code}\d+)", "({time}\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})\s({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){1,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))\s({method}POST)?\s*([^\s]+\s){2}({dest_port}\d+)\s(({domain}[^\\\s]+)\\+)?(-|({user}[\w\.\-]{1,40}))?\s*({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){1,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))\s(-|({user_agent}[^\s\"]+))?\s(-|({url}[^\s]+))\s\S+\s({http_response_code}\d+)\s([^\s]+\s){3}(?:[\d\.]+,)?(((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){1,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))?\s", "\"timestamp\":\"({time}\d{10})"], "ParserVersion": "v1.0.0"} |