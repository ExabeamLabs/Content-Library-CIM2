# Code Changes for okta-amfa-json-app-login-success-signon (Parser)

| Code Change | Field Name | 2025.13.1 | 2025.14.1 |
|-------------|------------|-----------|------------|
| added_parser | N/A | N/A | {"Vendor": "Okta", "Product": "Okta Adaptive MFA", "TimeFormat": "yyyy-MM-dd'T'HH:mm:ss.SSSZ", "ExtractionType": "json", "Fields": ["\"published\":\s*\"({time}\d\d\d\d\-\d\d\-\d\dT\d\d:\d\d:\d\d\.\d+Z)", "({time}\d\d\d\d\-\d\d\-\d\dT\d\d:\d\d:\d\d\.\d+Z)", "\"userAgent\":\s*\{[^\{\}]*?\"rawUserAgent\":\s*\"((?i)unknown|({user_agent}[^\"]+))", "\"ip\":\s*\"({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?\"", "\"request\":\s*\{[^\}]+?\"ip\":\s*\"({src_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({src_port}\d+))?\"", "\"type\":\s*\"({app}[^\"]+)", "({app}Okta)", "destinationServiceName=({app}[^=]+?)\s*\w+=", "\"target\":\s*\[.*?\{.*?\"displayName\":\s*\"({app}[^\"]+)\"[^\{\}]*?\"type\":\s*\"AppInstance\"", "\"type\":\s*\"AppInstance\"(,\s\"[^\"]+\":\s\{[^\}]+\},\s|[^\]\}]*)\"displayName\":\s*\"({app}[^\"]+?)\s*\"", "\"type\":\s*\"AppUser\"[^\}\]]\"alternateId\":\s*\"(({email_address}([A-Za-z0-9]+[!#$%&'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s\"\\,\|]+\.[^\]\s\"\\,\|]+))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))\s*\"", "\"alternateId\":\s*\"(({email_address}([A-Za-z0-9]+[!#$%&'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s\"\\,\|]+\.[^\]\s\"\\,\|]+))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))\",\s*?\"type\":\s*\"AppUser\"", "\"actor\":\s*\{[^\{\}]*?\"displayName\":\s*\"((?i)okta[^\"]*|unknown|({full_name}[^\",]+))\"[^\{\}]*?\"type\":\s*\"User\"", "\"actor\":\s*\{[^\{\}]*?\"type\":\s*\"User\"[^\{\}]*?\"displayName\":\s*\"((?i)okta[^\"]*|unknown|({full_name}[^\",]+))\"", "\"actor\"\":\s*\{[^\{\}]*?\"\"type\"\":\s*\"\"User\"\"[^\{\}]*?\"\"displayName\"\":\s*\"\"((?i)okta[^\"]*|unknown|({last_name}[^,]+),\s*({first_name}[^,\"\}\]]+))\"", "\"actor\":\s*\{[^\{\}]*?\"alternateId\":\s*\"(?:(({user}[\w\.\-\!\#\^\~]{1,40}\$?)@({domain}[^\s\"]+?\.corp))|({email_address}([A-Za-z0-9]+[!#$%&'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s\"\\,;\|]+\.[^\]\s\"\\,;\|]+))|({=user}[\w\.\-\!\#\^\~]{1,40}\$?))\"", "\"userName\":\s*\"({email_address}([A-Za-z0-9]+[!#$%&'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s\"\\,;\|]+\.[^\]\s\"\\,;\|]+))\"", "\"outcome\":\s*\{[^\{\}]*?\"result\":\s*\"({result}[^\"]+)", "outcome\":[^\]]*?\"result\":\"?(null|({result}[^\\"]+))\"?,\"reason\":\"?(null|({result_reason}[^\"]+))", "\"displayMessage\":\s*\"({operation}[^\"]+)\"", "\"displayMessage\"\s*:\s*\"((?i)null|({event_name}[^\",]+))", "\"city\":\s*\"({location_city}[^\"]+)", "\"state\":\s*\"({location_state}[^\"]+)", "\"country\":\s*\"({location_country}[^\"]+)", "\"dtHash\":\"({hash_sha256}[^\"]+)", "\"os\":\s*\"((?i)unknown|({os}[^\"]+))\"", "\"browser\":\s*\"((?i)UNKNOWN|({browser}[^\"]+))\"", "\"domain\":\s*\"(null|\.|({domain}[^\"\\},]+))\"", "\"risk\":\"\{reasons=({failure_reason}[^=]+?),\s\w+=", "exa_json_path=$..published,exa_field_name=time", "exa_regex=({time}\d\d\d\d\-\d\d\-\d\dT\d\d:\d\d:\d\d\.\d+Z)", "exa_json_path=$..client.userAgent.rawUserAgent,exa_field_name=user_agent,exa_match_expr=!Contains($.client.userAgent.rawUserAgent,\"unknown\")", "exa_regex=({app}Okta)", "exa_json_path=$..outcome.result,exa_field_name=result", "exa_json_path=$..outcome.reason,exa_field_name=additional_info", "exa_json_path=$..client.geographicalContext.city,exa_field_name=location_city", "exa_json_path=$..client.geographicalContext.state,exa_field_name=location_state", "exa_json_path=$..client.geographicalContext.country,exa_field_name=location_country", "exa_json_path=$..displayMessage,exa_field_name=operation", "exa_json_path=$..client.userAgent.os,exa_field_name=os,exa_match_expr=!Contains(toLower($.client.userAgent.os),\"unknown\")", "exa_json_path=$..client.userAgent.browser,exa_field_name=browser,exa_match_expr=!Contains(toLower($.client.userAgent.browser),\"unknown\")", "exa_json_path=$..request.ipChain.ip,exa_field_name=src_ip", "exa_json_path=$..actor.displayName,exa_field_name=full_name,exa_match_expr=InList(toLower($.actor.type),\"user\")", "exa_json_path=$..client.ipAddress,exa_field_name=src_ip", "exa_json_path=$..target[*].alternateId,exa_regex=(({email_address}([A-Za-z0-9]+[!#$%&'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s\"\\,\|]+\.[^\]\s\"\\,\|]+)))\s*\"", "exa_json_path=$..target[*].alternateId,exa_regex=(({email_address}([A-Za-z0-9]+[!#$%&'+\/=?^_`~.-])*[A-Za-z0-9]+@({email_domain}[^\]\s\"\\,\|]+\.[^\]\s\"\\,\|]+))|({user}[\w\.\-\!\#\^\~]{1,40}\$?))\",\s*?\"type\":\s*\"AppUser\"", "exa_json_path=$..actor.alternateId,exa_regex=(?:(({user}[\w\.\-\!\#\^\~]{1,40}\$?)@({domain}[^\s\"]+?\.corp))|({email_address}([A-Za-z0-9]+[!#$%&'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s\"\\,;\|]+\.[^\]\s\"\\,;\|]+))|({=user}[\w\.\-\!\#\^\~]{1,40}\$?))", "exa_json_path=$..securityContext.domain,exa_field_name=domain,exa_match_expr=!InList($.securityContext.domain, 'null' , '.' )", "exa_regex=\"target\":\s*\[.*?\{.*?\"displayName\":\s*\"({app}[^\"]+)\"[^\{\}]*?\"type\":\s*\"AppInstance\"", "exa_regex=\"type\":\s*\"AppInstance\"(,\s\"[^\"]+\":\s\{[^\}]+\},\s|[^\]\}]*)\"displayName\":\s*\"({app}[^\"]+?)\s*\"", "\"eventType\":\s*\"({operation}[^\"]+)\"", "\"legacyEventType\":\s*\"({operation_details}[^\"]+)\"", "\"debugData\":.*?\"risk\":\s*\"[^\"]*?level=({severity}[^\"\}]+)(\"|\})", "exa_json_path=$..debugContext.debugData.risk,exa_regex=\s*level=({severity}[^\"\}]+)(\"|\})", "exa_json_path=$..eventType,exa_field_name=operation", "exa_json_path=$..legacyEventType,exa_field_name=operation_details", "exa_json_path=$..debugContext.debugData.dtHash,exa_field_name=hash_sha256", "exa_json_path=$..outcome.result,exa_field_name=result,exa_match_expr=!Contains(toLower($.outcome.result),\"null\")", "exa_json_path=$..outcome.reason,exa_field_name=result_reason,exa_match_expr=!Contains(toLower($.outcome.reason),\"null\")", "exa_json_path=$..displayMessage,exa_field_name=event_name", "exa_json_path=$.detail.client.userAgent.rawUserAgent,exa_field_name=user_agent", "exa_json_path=$.debugContext.debugData.risk,exa_regex=^\{reasons=({failure_reason}[^=]+?),\s\w+=", "\"displayMessage\":\"({additional_info}[^\"]+)"], "Name": "okta-amfa-json-app-login-success-signon", "ParserVersion": "v1.0.0", "Conditions": ["\"eventType\":\"policy.evaluate_sign_on\""]} |