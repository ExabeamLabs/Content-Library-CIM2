# Code Changes for proofpoint-tappod-json-email-send-receive-rcpts (Parser)

| Code Change | Field Name | 2025.13.1 | 2025.14.1 |
|-------------|------------|-----------|------------|
| changed_parsed_fields | N/A | ['action', 'alert_id', 'alert_type', 'attachment_1', 'attachment_10', 'attachment_2', 'attachment_3', 'attachment_4', 'attachment_5', 'attachment_6', 'attachment_7', 'attachment_8', 'attachment_9', 'bytes', 'connection_status', 'country', 'dest_email_address', 'dest_email_domain', 'dest_ip', 'dest_port', 'dest_user', 'dest_user_full_name', 'direction', 'email_address', 'email_attachment', 'email_recipients', 'email_subject', 'file_ext', 'full_name', 'hash_md5', 'hash_sha256', 'host', 'message_id', 'reply_to', 'result', 'rule', 'src_email_address', 'src_ip', 'src_port', 'time', 'virus_name'] | ['action', 'alert_id', 'alert_type', 'attachment_1', 'attachment_10', 'attachment_2', 'attachment_3', 'attachment_4', 'attachment_5', 'attachment_6', 'attachment_7', 'attachment_8', 'attachment_9', 'bytes', 'connection_status', 'country', 'dest_email_address', 'dest_email_domain', 'dest_user', 'dest_user_full_name', 'direction', 'email_address', 'email_attachment', 'email_recipients', 'email_subject', 'file_ext', 'full_name', 'hash_md5', 'hash_sha256', 'host', 'message_id', 'reply_to', 'result', 'rule', 'src_email_address', 'src_ip', 'src_port', 'time', 'virus_name'] |
| edit_regex_field | dest_email_address | ['"msg".+?normalizedHeader":.+?"reply-to":\["(({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|({dest_user}[\w\.\-]{1,40}\$?|({dest_user_full_name}\w+(\s+\w+)+)))"]', '"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)\"]', '"verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)\"]', 'exa_json_path=$.envelope.rcpts[1:],exa_regex=({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)', 'exa_json_path=$.filter.verified.rcpts[1:],exa_regex=({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)', 'exa_regex="rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)\"]', 'exa_regex="verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)\"]'] | ['"msg".+?normalizedHeader":.+?"reply-to":\["(({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|({dest_user}[\w\.\-]{1,40}\$?|({dest_user_full_name}\w+(\s+\w+)+)))"]', '"rcpts"+:\s*\[({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]', '"verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]', 'exa_json_path=$.envelope.rcpts[1:],exa_regex=({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)', 'exa_json_path=$.filter.verified.rcpts[1:],exa_regex=({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)', 'exa_regex="rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)\]', 'exa_regex="verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]'] |
| edit_regex_field | dest_email_domain | ['"msg".+?normalizedHeader":.+?"reply-to":\["(({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|({dest_user}[\w\.\-]{1,40}\$?|({dest_user_full_name}\w+(\s+\w+)+)))"]'] | ['"msg".+?normalizedHeader":.+?"reply-to":\["(({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|({dest_user}[\w\.\-]{1,40}\$?|({dest_user_full_name}\w+(\s+\w+)+)))"]', '"rcpts"+:\s*\[({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]', '"verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]', 'exa_json_path=$.envelope.rcpts[1:],exa_regex=({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)', 'exa_json_path=$.filter.verified.rcpts[1:],exa_regex=({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)', 'exa_regex="rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)\]', 'exa_regex="verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]'] |
| removed_regex_field | dest_ip | ['"ip"+:\s*"+({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?', 'exa_json_path=$.connection.ip,exa_regex=({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?'] | [] |
| removed_regex_field | dest_port | ['"ip"+:\s*"+({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?', 'exa_json_path=$.connection.ip,exa_regex=({dest_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))(:({dest_port}\d+))?'] | [] |
| edit_regex_field | email_recipients | ['"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)\"]', '"verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)\"]', 'exa_json_path=$.envelope.rcpts[1:],exa_regex=({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)', 'exa_json_path=$.filter.verified.rcpts[1:],exa_regex=({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)', 'exa_regex="rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)\"]', 'exa_regex="verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)"*[^\]]*?)\"]'] | ['"rcpts"+:\s*\[({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]', '"verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]', 'exa_json_path=$.envelope.rcpts[1:],exa_regex=({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)', 'exa_json_path=$.filter.verified.rcpts[1:],exa_regex=({email_recipients}"({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)', 'exa_regex="rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)\]', 'exa_regex="verified"+:\{[^\}]*"rcpts"+:\s*\["({email_recipients}({dest_email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))[^\]]*?)"\]'] |