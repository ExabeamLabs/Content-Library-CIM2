# Code Changes for imperva-securesphere-json-database-query-success-sqlerror (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| changed_parsed_fields | N/A |  | ['account', 'app', 'app_user', 'db_name', 'db_operation', 'db_query', 'db_schema', 'db_user', 'dest_ip', 'dest_port', 'domain', 'event_category', 'host', 'policy_id', 'policy_name', 'server_group', 'service_name', 'sql_error', 'src_ip', 'src_port', 'time', 'user', 'user_group_name'] |
| edit_regex_field | account |  | ['"+db-user"+\s*:\s*"+(?:|({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))))(@({domain}[^"]+))?)"+(,|})', '"+db-user"+\s*:\s*"+(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})', '"application-user"\s*:\s*"(|({account}[^"]+))"', 'exa_json_path=$.application-user,exa_regex=(|({app_user}({account}[^"]+)))', 'exa_json_path=$.db-user,exa_regex=(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})'] |
| edit_regex_field | domain |  | ['"+db-user"+\s*:\s*"+(?:|({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))))(@({domain}[^"]+))?)"+(,|})', '"+db-user"+\s*:\s*"+(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})', '"+db-user"+\s*:\s*"+(?:|({domain}[^"]+))"+(,|})', 'exa_json_path=$.db-user,exa_regex=(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})'] |
| edit_regex_field | user |  | ['"+db-user"+\s*:\s*"+(?:|({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))))(@({domain}[^"]+))?)"+(,|})', '"+db-user"+\s*:\s*"+(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})', 'exa_json_path=$.db-user,exa_regex=(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})'] |
| added_regex_field | app_user |  | ['"+db-user"+\s*:\s*"+(?:|({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))))(@({domain}[^"]+))?)"+(,|})', '"+db-user"+\s*:\s*"+(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})', 'exa_json_path=$.application-user,exa_regex=(|({app_user}({account}[^"]+)))', 'exa_json_path=$.db-user,exa_regex=(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})'] |
| added_regex_field | db_user |  | ['"+db-user"+\s*:\s*"+(?:|({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))))(@({domain}[^"]+))?)"+(,|})', '"+db-user"+\s*:\s*"+(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})', 'exa_json_path=$.db-user,exa_regex=(?:|({domain}[^"\\@]+?)(\\+({app_user}({db_user}({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))))?)"+(,|})'] |
| removed_attribute | DupFields |  | N/A |