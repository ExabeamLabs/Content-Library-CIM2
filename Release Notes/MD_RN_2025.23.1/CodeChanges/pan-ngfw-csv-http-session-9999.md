# Code Changes for pan-ngfw-csv-http-session-9999 (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| changed_parsed_fields | N/A |  | ['action', 'alert_id', 'alert_name', 'alert_severity', 'alert_source', 'alert_type', 'app', 'categories', 'category', 'dest_country', 'dest_domain', 'dest_email_address', 'dest_email_domain', 'dest_interface', 'dest_ip', 'dest_network_zone', 'dest_port', 'dest_translated_ip', 'dest_translated_port', 'dest_user', 'dest_user_full_name', 'device_name', 'direction', 'domain', 'email_address', 'email_domain', 'event_category', 'file_name', 'host', 'malware_file_name', 'malware_url', 'method', 'mime', 'network_app', 'protocol', 'referrer', 'result_code', 'rule', 'serial_num', 'session_id', 'severity', 'src_domain', 'src_interface', 'src_ip', 'src_location', 'src_network_zone', 'src_port', 'src_translated_ip', 'src_translated_port', 'src_user', 'threat_category', 'threat_id', 'time', 'uri_path', 'uri_query', 'url', 'user', 'virtual_station_name', 'web_domain'] |
| edit_regex_field | action |  | [',THREAT,([^,]*,){26}({action}[^,]+?),', 'THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] |
| edit_regex_field | alert_id |  | [',THREAT,([^,]*,){28}(|({alert_name}[^\(,]+(\(\w+\))?))\s*\(({alert_id}\d+)?'] |
| edit_regex_field | alert_name |  | [',THREAT,([^,]*,){28}(|({alert_name}[^\(,]+(\(\w+\))?))\s*\(({alert_id}\d+)?', ',THREAT,({alert_type}({alert_name}[^,]+)),'] |
| edit_regex_field | alert_type |  | [',THREAT,({alert_type}({alert_name}[^,]+)),'] |
| edit_regex_field | app |  | [',THREAT,([^,]*,){10}({alert_source}({network_app}({app}[^,]+))),'] |
| edit_regex_field | dest_domain |  | [',THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | dest_email_address |  | [',THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | dest_interface |  | [',THREAT,([^,]*,){15}({dest_interface}[^,]+),'] |
| edit_regex_field | dest_ip |  | [',THREAT,([^,]*,){4}({dest_ip}(?!::)[a-fA-F\d.:]+)', 'THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|([^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |
| edit_regex_field | dest_network_zone |  | [',THREAT,([^,]*,){13}({dest_network_zone}[^,]+?)\s*,'] |
| edit_regex_field | dest_port |  | [',THREAT,([^,]*,){21}({dest_port}\d+),', 'THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),', 'THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|([^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |
| edit_regex_field | dest_translated_ip |  | [',THREAT,([^,]*,){6}({dest_translated_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))'] |
| edit_regex_field | dest_translated_port |  | [',THREAT,([^,]*,){23}({dest_translated_port}\d+)'] |
| edit_regex_field | dest_user |  | [',THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | email_address |  | [',THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | file_name |  | [',THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] |
| edit_regex_field | malware_file_name |  | [',THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] |
| edit_regex_field | malware_url |  | [',THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] |
| edit_regex_field | network_app |  | [',THREAT,([^,]*,){10}({alert_source}({network_app}({app}[^,]+))),'] |
| edit_regex_field | protocol |  | [',THREAT,([^,]*,){25}({protocol}[^,]+?),', 'THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] |
| edit_regex_field | result_code |  | [',THREAT,([^,]*,){24}({result_code}[^,]+),'] |
| edit_regex_field | session_id |  | [',THREAT,([^,]*,){18}({session_id}\d+),'] |
| edit_regex_field | src_domain |  | [',THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] |
| edit_regex_field | src_interface |  | [',THREAT,([^,]*,){14}({src_interface}[^,]+),'] |
| edit_regex_field | src_ip |  | [',THREAT,([^,]*,){3}({src_ip}(?!::)[a-fA-F\d.:]+)'] |
| edit_regex_field | src_network_zone |  | [',THREAT,([^,]*,){12}({src_network_zone}[^,]+?)\s*,'] |
| edit_regex_field | src_port |  | [',THREAT,([^,]*,){20}({src_port}\d+),', 'THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] |
| edit_regex_field | src_translated_ip |  | [',THREAT,([^,]*,){5}({src_translated_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))'] |
| edit_regex_field | src_translated_port |  | [',THREAT,([^,]*,){22}({src_translated_port}\d+)'] |
| edit_regex_field | src_user |  | [',THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] |
| edit_regex_field | threat_category |  | [',THREAT,([^,]*,){65}({threat_category}[^,]+),', '\(9999\),(("[^"]+?"|[^,]*),){36}(N/A|unknown|({threat_category}[^,]+)),'] |
| edit_regex_field | time |  | [',((?:1969-[^,]+?)|({time}\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d\.\d+[\+-]\d+:\d+)),', ',THREAT,([^,]*,){2}({time}[^,]+),'] |
| edit_regex_field | url |  | [',THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))', 'THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|([^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |
| edit_regex_field | user |  | [',THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | virtual_station_name |  | [',THREAT,([^,]*,){11}({virtual_station_name}[^,]+),'] |
| edit_regex_field | web_domain |  | [',THREAT,([^,]*,){27}\\?("+)?.*?({web_domain}[^\/\.\s]+(?i)(\.(com|net|info|edu|org|gov|co|jp|ru|de|ir|it|in|fr|info|pl|nl|es|gr|cz|eu|tv|me|jp|ca|cn|uk|my|cc|id|us|nz|biz|club|io|gg|fi|au|st|tw|asia|sg|ie|li|za|ai|ms|mx))+)[\\\/\s:"]'] |
| added_regex_field | alert_source |  | [',THREAT,([^,]*,){10}({alert_source}({network_app}({app}[^,]+))),'] |