# Code Changes for microsoft-o365-mix-file-success-workload (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| changed_parsed_fields | N/A |  | ['account_name', 'action', 'app', 'auth_method', 'browser', 'bytes', 'correlation_id', 'dest_email_address', 'dest_user', 'domain', 'email_address', 'email_domain', 'external_id', 'file_dir', 'file_ext', 'file_name', 'file_path', 'file_permissions', 'file_type', 'file_url', 'full_name', 'host', 'new_attribute', 'old_sensitivity_label', 'operation', 'operation_details', 'sensitivity_label', 'src_file_dir', 'src_file_ext', 'src_file_name', 'src_file_path', 'src_ip', 'src_port', 'tag', 'time', 'user', 'user_agent', 'user_id', 'user_type'] |
| edit_regex_field | domain |  | ['"UserId\\*\"+:\\*\s*\"+((\w+?_)?(\w+-)?\w+-\w+-\w+-\w+|(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|system|SecurityComplianceAlerts|SecurityComplianceInsights|AAD to SharePoint Sync|(Microsoft\\[^@\s"]+)|EMPTY\.*|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\\s@"]+)\\)?(app@sharepoint|system|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?))(@({=domain}[^\s"]+))?|({full_name}[\w,\s]+?)))"', '\Wsuser=(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|SecurityComplianceAlerts|SecurityComplianceInsights|(Microsoft\\[^@\s"]+)|EMPTY\.*|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|(({user_id}(\w+\-){4}\w+)|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?)(@({domain}[^\s"]+))?)))(\s+\w+=|\s*$)'] |
| edit_regex_field | email_address |  | ['"UserId\\*\"+:\\*\s*\"+((\w+?_)?(\w+-)?\w+-\w+-\w+-\w+|(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|system|SecurityComplianceAlerts|SecurityComplianceInsights|AAD to SharePoint Sync|(Microsoft\\[^@\s"]+)|EMPTY\.*|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\\s@"]+)\\)?(app@sharepoint|system|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?))(@({=domain}[^\s"]+))?|({full_name}[\w,\s]+?)))"', '\Wsproc=({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)', '\Wsuser=(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|SecurityComplianceAlerts|SecurityComplianceInsights|(Microsoft\\[^@\s"]+)|EMPTY\.*|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|(({user_id}(\w+\-){4}\w+)|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?)(@({domain}[^\s"]+))?)))(\s+\w+=|\s*$)'] |
| edit_regex_field | email_domain |  | ['"UserId\\*\"+:\\*\s*\"+((\w+?_)?(\w+-)?\w+-\w+-\w+-\w+|(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|system|SecurityComplianceAlerts|SecurityComplianceInsights|AAD to SharePoint Sync|(Microsoft\\[^@\s"]+)|EMPTY\.*|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\\s@"]+)\\)?(app@sharepoint|system|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?))(@({=domain}[^\s"]+))?|({full_name}[\w,\s]+?)))"', '\Wsuser=(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|SecurityComplianceAlerts|SecurityComplianceInsights|(Microsoft\\[^@\s"]+)|EMPTY\.*|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|(({user_id}(\w+\-){4}\w+)|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?)(@({domain}[^\s"]+))?)))(\s+\w+=|\s*$)'] |
| edit_regex_field | full_name |  | ['"UserId\\*\"+:\\*\s*\"+((\w+?_)?(\w+-)?\w+-\w+-\w+-\w+|(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|system|SecurityComplianceAlerts|SecurityComplianceInsights|AAD to SharePoint Sync|(Microsoft\\[^@\s"]+)|EMPTY\.*|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\\s@"]+)\\)?(app@sharepoint|system|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?))(@({=domain}[^\s"]+))?|({full_name}[\w,\s]+?)))"'] |
| edit_regex_field | operation |  | ['Operation\\*"+:\\*\s*"+({action}({operation}[^"\\,]+))'] |
| edit_regex_field | src_file_dir |  | ['"*ObjectId\\*":\s*\\*"([a-f0-9]{8}(?:-[a-f0-9]{4}){4}[a-f0-9]{8}|({src_file_path}({src_file_dir}[^"]*?)?({src_file_name}[^\/"]+?(\.({src_file_ext}[^\\\/.\s",\']+))?)))"(?!u\d+)', '"*SourceRelativeUrl\\*\"+:\\*\s*\"+({file_dir}({src_file_dir}[^\"]+))'] |
| edit_regex_field | user |  | ['"UserId\\*\"+:\\*\s*\"+((\w+?_)?(\w+-)?\w+-\w+-\w+-\w+|(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|system|SecurityComplianceAlerts|SecurityComplianceInsights|AAD to SharePoint Sync|(Microsoft\\[^@\s"]+)|EMPTY\.*|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\\s@"]+)\\)?(app@sharepoint|system|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?))(@({=domain}[^\s"]+))?|({full_name}[\w,\s]+?)))"', '\Wsuser=(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|SecurityComplianceAlerts|SecurityComplianceInsights|(Microsoft\\[^@\s"]+)|EMPTY\.*|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|(({user_id}(\w+\-){4}\w+)|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?)(@({domain}[^\s"]+))?)))(\s+\w+=|\s*$)'] |
| edit_regex_field | user_id |  | ['\Wsuser=(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|SecurityComplianceAlerts|SecurityComplianceInsights|(Microsoft\\[^@\s"]+)|EMPTY\.*|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|(({user_id}(\w+\-){4}\w+)|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?)(@({domain}[^\s"]+))?)))(\s+\w+=|\s*$)'] |
| added_regex_field | action |  | ['Operation\\*"+:\\*\s*"+({action}({operation}[^"\\,]+))'] |
| added_regex_field | external_id |  | ['"UserId\\*\"+:\\*\s*\"+((\w+?_)?(\w+-)?\w+-\w+-\w+-\w+|(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|system|SecurityComplianceAlerts|SecurityComplianceInsights|AAD to SharePoint Sync|(Microsoft\\[^@\s"]+)|EMPTY\.*|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\\s@"]+)\\)?(app@sharepoint|system|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?))(@({=domain}[^\s"]+))?|({full_name}[\w,\s]+?)))"', '\Wsuser=(urn:spo:guest#)?(NOT-FOUND|Unknown|Sync|AirInvestigation|Sync Client|Office365 Backend Process|Device Registration Service|Microsoft Intune|Microsoft Teams Services|Microsoft Online Services|Office 365 SharePoint Online|anonymous|SecurityComplianceAlerts|SecurityComplianceInsights|(Microsoft\\[^@\s"]+)|EMPTY\.*|(({email_address}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+))|(({user_id}(\w+\-){4}\w+)|({external_id}[^_@"]+?\_[^@"]+#(ext|EXT)#@[^"]+)|({user}[\w\.\-]{1,40}\$?)(@({domain}[^\s"]+))?)))(\s+\w+=|\s*$)'] |
| added_regex_field | file_dir |  | ['"*ObjectId\\*":\s*\\*"([a-f0-9]{8}(?:-[a-f0-9]{4}){4}[a-f0-9]{8}|({file_url}({file_path}({file_dir}[^"]*?)?({file_name}[^\/"]+?(\.({file_ext}[^\\\/.\s",\']+))?))))"(?!u\d+)', '"*SourceRelativeUrl\\*\"+:\\*\s*\"+({file_dir}({src_file_dir}[^\"]+))'] |
| added_regex_field | file_ext |  | ['"*ObjectId\\*":\s*\\*"([a-f0-9]{8}(?:-[a-f0-9]{4}){4}[a-f0-9]{8}|({file_url}({file_path}({file_dir}[^"]*?)?({file_name}[^\/"]+?(\.({file_ext}[^\\\/.\s",\']+))?))))"(?!u\d+)', '\"*SourceFileExtension\\*"+:\\*\s*"+\s*({file_ext}[^"\\,\s\']+)', '\"*SourceFileName\\*\"+:\\*\s*\"+\s*({file_name}[^\"\\]+?(\.({file_ext}\w+))?)(,|\s*\")'] |
| added_regex_field | file_name |  | ['"*ObjectId\\*":\s*\\*"([a-f0-9]{8}(?:-[a-f0-9]{4}){4}[a-f0-9]{8}|({file_url}({file_path}({file_dir}[^"]*?)?({file_name}[^\/"]+?(\.({file_ext}[^\\\/.\s",\']+))?))))"(?!u\d+)', '\"*SourceFileName\\*\"+:\\*\s*\"+\s*({file_name}[^\"\\]+?(\.({file_ext}\w+))?)(,|\s*\")'] |
| added_regex_field | file_path |  | ['"*ObjectId\\*":\s*\\*"([a-f0-9]{8}(?:-[a-f0-9]{4}){4}[a-f0-9]{8}|({file_url}({file_path}({file_dir}[^"]*?)?({file_name}[^\/"]+?(\.({file_ext}[^\\\/.\s",\']+))?))))"(?!u\d+)'] |
| added_regex_field | file_url |  | ['"*ObjectId\\*":\s*\\*"([a-f0-9]{8}(?:-[a-f0-9]{4}){4}[a-f0-9]{8}|({file_url}({file_path}({file_dir}[^"]*?)?({file_name}[^\/"]+?(\.({file_ext}[^\\\/.\s",\']+))?))))"(?!u\d+)'] |
| removed_attribute | DupFields |  | N/A |