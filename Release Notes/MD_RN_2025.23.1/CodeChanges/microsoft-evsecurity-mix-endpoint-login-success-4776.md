# Code Changes for microsoft-evsecurity-mix-endpoint-login-success-4776 (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| changed_parsed_fields | N/A |  | ['account', 'domain', 'email_address', 'email_domain', 'event_code', 'event_name', 'host', 'login_type_text', 'result_code', 'src_host', 'src_ip', 'src_port', 'time', 'user', 'user_upn'] |
| edit_regex_field | domain |  | ['"ComputerName":"(?!(?:[A-Fa-f:\d.]+))[^."]+\.({domain}[^"]+)', '"dhn":"(?!(?:[A-Fa-f:\d.]+))[^".]+\.({domain}[^-".]+)[^"-]*', '(?!(?:[A-Fa-f:\d.]+))[^\s\/.]+\.({domain}[^\s\/.]+)[^\s\/]*\/Microsoft-Windows-Security-Auditing \(4776\)', '(?i)(((audit|success|failure)( |_)(success|audit|failure))|information)\s*(\s|\t|,|#\d+|<[^>]+>)\s*(?!(?:[A-Fa-f:\d.]+))[^\t,#<\s.]+\.({domain}[^\s.",]+)', '<Computer>(?!(?:[A-Fa-f:\d.]+))[^<.]+\.({domain}[^.<]+)[^<]*</Computer>', 'Computer(Name)?\s*(:|=)\s*"?(?!(?:[A-Fa-f:\d.]+))[^\s."]+\.({domain}[^\s".]+)[^\s"]*("|\s)', 'Logon (?:a|A)ccount(:|=)\s*\$?(\\t|\\r|\\n)*(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|(({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))(?:@({domain}[^\s]+).*?)?)|({=account}({=user}[\w\.\-\!\#\^\~]{1,40}\$?)))(\\t|\\r|\\n)*[\s;]*Source Workstation(:|=)', 'Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))((?-i)\\+[rnt])*(?:@({domain}[^\s\\]+).*?)?\s*Source Workstation)', 'Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)),({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))((?-i)\\+[rnt])*(?:@({domain}[^\s]+).*?)?\s*Source Workstation)'] |
| edit_regex_field | email_address |  | ['Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)),({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))((?-i)\\+[rnt])*(?:@({domain}[^\s]+).*?)?\s*Source Workstation)'] |
| edit_regex_field | email_domain |  | ['Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)),({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))((?-i)\\+[rnt])*(?:@({domain}[^\s]+).*?)?\s*Source Workstation)'] |
| edit_regex_field | user |  | ['"StringInserts":.+?\w+.+?"(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))', 'Logon (?:a|A)ccount(:|=)\s*\$?(\\t|\\r|\\n)*(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|(({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))(?:@({domain}[^\s]+).*?)?)|({=account}({=user}[\w\.\-\!\#\^\~]{1,40}\$?)))(\\t|\\r|\\n)*[\s;]*Source Workstation(:|=)', 'Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))((?-i)\\+[rnt])*(?:@({domain}[^\s\\]+).*?)?\s*Source Workstation)', 'Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)),({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))((?-i)\\+[rnt])*(?:@({domain}[^\s]+).*?)?\s*Source Workstation)'] |
| edit_regex_field | user_upn |  | ['"StringInserts":.+?\w+.+?"(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))', 'Logon (?:a|A)ccount(:|=)\s*\$?(\\t|\\r|\\n)*(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|(({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))(?:@({domain}[^\s]+).*?)?)|({=account}({=user}[\w\.\-\!\#\^\~]{1,40}\$?)))(\\t|\\r|\\n)*[\s;]*Source Workstation(:|=)', 'Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))((?-i)\\+[rnt])*(?:@({domain}[^\s\\]+).*?)?\s*Source Workstation)'] |
| added_regex_field | account |  | ['"StringInserts":.+?\w+.+?"(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))', 'Logon (?:a|A)ccount(:|=)\s*\$?(\\t|\\r|\\n)*(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|(({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?))(?:@({domain}[^\s]+).*?)?)|({=account}({=user}[\w\.\-\!\#\^\~]{1,40}\$?)))(\\t|\\r|\\n)*[\s;]*Source Workstation(:|=)', 'Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*(({user_upn}([A-Za-z0-9]+[!#$%&\'+-\/=?^_`~])*[A-Za-z0-9]+@[^\]\s"\\,\|]+\.[^\]\s"\\,\|]+)|({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)))((?-i)\\+[rnt])*(?:@({domain}[^\s\\]+).*?)?\s*Source Workstation)', 'Logon (?:a|A)ccount:(?:\s+Source Workstation|\s*((?-i)\\+[rnt])*({account}({user}[\w\.\-\!\#\^\~]{1,40}\$?)),({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))((?-i)\\+[rnt])*(?:@({domain}[^\s]+).*?)?\s*Source Workstation)'] |
| removed_attribute | DupFields |  | N/A |