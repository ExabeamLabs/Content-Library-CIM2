# Code Changes for microsoft-evsecurity-kv-user-switch-success-4648-2 (Parser)

| Code Change | Field Name | Before | After |
|-------------|------------|--------|-------|
| edit_regex_field | dest_domain |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))', '\sTargetDomainName=(NT AUTHORITY|({dest_domain}[^=]+?))\s\w+='] |
| edit_regex_field | dest_service_name |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))', '\sTargetServerName=({dest_service_name}[^=]+?)\s\w+='] |
| edit_regex_field | dest_user |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))', '\sTargetUserName=(SYSTEM|({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?))'] |
| edit_regex_field | domain |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))'] |
| edit_regex_field | login_id |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))', '\sSubjectLogonId=({login_id}[^=]+?)\s\w+='] |
| edit_regex_field | process_dir |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))', '\sProcessName=({process_path}({process_dir}(?:[^"=]+)?[\\\/])?({process_name}[^\\\/"=]+?))\s\w+='] |
| edit_regex_field | process_name |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))', '\sProcessName=({process_path}({process_dir}(?:[^"=]+)?[\\\/])?({process_name}[^\\\/"=]+?))\s\w+='] |
| edit_regex_field | process_path |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))', '\sProcessName=({process_path}({process_dir}(?:[^"=]+)?[\\\/])?({process_name}[^\\\/"=]+?))\s\w+='] |
| edit_regex_field | user |  | ['Message=.+?\s({user}[\w\.\-\!\#\^\~]{1,40}\$?)\s({domain}[^\s]+)\s({login_id}[^\s]+)\s\{([^\}]+)\}\s({dest_user}[^\s]+)\s({dest_domain}[^\s]+)\s\{.*?\}\s({dest_service_name}[^\s]+)\w.*?\s.*?\s({process_path}({process_dir}[^\s]+[\\\/]+)({process_name}[^\s\\\/]+))'] |