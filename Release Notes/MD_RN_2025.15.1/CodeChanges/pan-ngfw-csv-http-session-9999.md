# Code Changes for pan-ngfw-csv-http-session-9999 (Parser)

| Code Change | Field Name | 2025.14.1 | 2025.15.1 |
|-------------|------------|-----------|------------|
| edit_regex_field | action | ['THREAT,([^,]*,){26}({action}[^,]+?),', 'THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] | [',THREAT,([^,]*,){26}({action}[^,]+?),', ',THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] |
| edit_regex_field | alert_id | ['THREAT,([^,]*,){28}(|({alert_name}[^\(,]+(\(\w+\))?))\s*\(({alert_id}\d+)?'] | [',THREAT,([^,]*,){28}(|({alert_name}[^\(,]+(\(\w+\))?))\s*\(({alert_id}\d+)?'] |
| edit_regex_field | alert_name | ['THREAT,([^,]*,){28}(|({alert_name}[^\(,]+(\(\w+\))?))\s*\(({alert_id}\d+)?', 'THREAT,({alert_type}({alert_name}[^,]+)),'] | [',THREAT,([^,]*,){28}(|({alert_name}[^\(,]+(\(\w+\))?))\s*\(({alert_id}\d+)?', ',THREAT,({alert_type}({alert_name}[^,]+)),'] |
| edit_regex_field | alert_severity | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,'] | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,(([^,]*,){35}"+\s*({=categories}({=category}[^,\n"]+)\s*[^"]*)"+,)?'] |
| edit_regex_field | alert_type | ['THREAT,({alert_type}({alert_name}[^,]+)),'] | [',THREAT,({alert_type}({alert_name}[^,]+)),'] |
| edit_regex_field | app | ['THREAT,([^,]*,){10}({network_app}({app}[^,]+?))\s*,'] | [',THREAT,([^,]*,){10}({network_app}({app}[^,]+?))\s*,'] |
| edit_regex_field | categories | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,'] | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,(([^,]*,){35}"+\s*({=categories}({=category}[^,\n"]+)\s*[^"]*)"+,)?'] |
| edit_regex_field | category | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,'] | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,(([^,]*,){35}"+\s*({=categories}({=category}[^,\n"]+)\s*[^"]*)"+,)?'] |
| edit_regex_field | dest_country | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,'] | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,(([^,]*,){35}"+\s*({=categories}({=category}[^,\n"]+)\s*[^"]*)"+,)?'] |
| edit_regex_field | dest_domain | ['THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', ',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | dest_email_address | ['THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', ',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | dest_email_domain | ['THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | dest_interface | ['THREAT,([^,]*,){15}({dest_interface}[^,]+),'] | [',THREAT,([^,]*,){15}({dest_interface}[^,]+),'] |
| edit_regex_field | dest_ip | ['THREAT,([^,]*,){4}({dest_ip}(?!::)[a-fA-F\d.:]+)', 'THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] | [',THREAT,([^,]*,){4}({dest_ip}(?!::)[a-fA-F\d.:]+)', ',THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |
| edit_regex_field | dest_network_zone | ['THREAT,([^,]*,){13}({dest_network_zone}[^,]+?)\s*,'] | [',THREAT,([^,]*,){13}({dest_network_zone}[^,]+?)\s*,'] |
| edit_regex_field | dest_port | ['THREAT,([^,]*,){21}({dest_port}\d+),', 'THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),', 'THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] | [',THREAT,([^,]*,){21}({dest_port}\d+),', ',THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),', ',THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |
| edit_regex_field | dest_translated_ip | ['THREAT,([^,]*,){6}({dest_translated_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))'] | [',THREAT,([^,]*,){6}({dest_translated_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))'] |
| edit_regex_field | dest_translated_port | ['THREAT,([^,]*,){23}({dest_translated_port}\d+)'] | [',THREAT,([^,]*,){23}({dest_translated_port}\d+)'] |
| edit_regex_field | dest_user | ['THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,([^,]*,){9}\s*(({dest_email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({dest_domain}[^\s,\\]+)\\*)?({dest_user}[^\s,]+)),', ',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | dest_user_full_name | ['THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | device_name | ['THREAT,url,([^,]*,){26}("[^"]+")?,([^,]*,){27}({device_name}({host}[^",]+))'] | [',THREAT,url,([^,]*,){26}("[^"]+")?,([^,]*,){27}({device_name}({host}[^",]+))'] |
| edit_regex_field | direction | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,'] | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,(([^,]*,){35}"+\s*({=categories}({=category}[^,\n"]+)\s*[^"]*)"+,)?'] |
| edit_regex_field | domain | ['THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | email_address | ['THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),', ',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | email_domain | ['THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | file_name | ['THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] | [',THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] |
| edit_regex_field | host | ['THREAT,url,([^,]*,){26}("[^"]+")?,([^,]*,){27}({device_name}({host}[^",]+))', '\w+\s+\d+\s+\d+:\d+:\d+\s+({host}[\w\-.]+)\s+\d+,'] | [',THREAT,url,([^,]*,){26}("[^"]+")?,([^,]*,){27}({device_name}({host}[^",]+))', '\w+\s+\d+\s+\d+:\d+:\d+\s+({host}[\w\-.]+)\s+\d+,'] |
| edit_regex_field | malware_file_name | ['THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] | [',THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] |
| edit_regex_field | malware_url | ['THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] | [',THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))'] |
| edit_regex_field | network_app | ['THREAT,([^,]*,){10}({network_app}({app}[^,]+?))\s*,'] | [',THREAT,([^,]*,){10}({network_app}({app}[^,]+?))\s*,'] |
| edit_regex_field | protocol | ['THREAT,([^,]*,){25}({protocol}[^,]+?),', 'THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] | [',THREAT,([^,]*,){25}({protocol}[^,]+?),', ',THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] |
| edit_regex_field | result | ['THREAT,([^,]*,){24}({result}[^,]+?),'] | [',THREAT,([^,]*,){24}({result}[^,]+?),'] |
| edit_regex_field | rule | ['THREAT,([^,]*,){7}({rule}[^,]+?)\s*,'] | [',THREAT,([^,]*,){7}({rule}[^,]+?)\s*,'] |
| edit_regex_field | session_id | ['THREAT,([^,]*,){18}({session_id}\d+),'] | [',THREAT,([^,]*,){18}({session_id}\d+),'] |
| edit_regex_field | severity | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,'] | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,(([^,]*,){35}"+\s*({=categories}({=category}[^,\n"]+)\s*[^"]*)"+,)?'] |
| edit_regex_field | src_domain | ['THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] | [',THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] |
| edit_regex_field | src_interface | ['THREAT,([^,]*,){14}({src_interface}[^,]+),'] | [',THREAT,([^,]*,){14}({src_interface}[^,]+),'] |
| edit_regex_field | src_ip | ['THREAT,([^,]*,){3}({src_ip}(?!::)[a-fA-F\d.:]+)'] | [',THREAT,([^,]*,){3}({src_ip}(?!::)[a-fA-F\d.:]+)'] |
| edit_regex_field | src_location | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,'] | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,(([^,]*,){35}"+\s*({=categories}({=category}[^,\n"]+)\s*[^"]*)"+,)?'] |
| edit_regex_field | src_network_zone | ['THREAT,([^,]*,){12}({src_network_zone}[^,]+?)\s*,'] | [',THREAT,([^,]*,){12}({src_network_zone}[^,]+?)\s*,'] |
| edit_regex_field | src_port | ['THREAT,([^,]*,){20}({src_port}\d+),', 'THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] | [',THREAT,([^,]*,){20}({src_port}\d+),', ',THREAT,url,([^,]*,){19}(|({src_port}\d+)),(|({dest_port}\d+)),([^,]*,){3}(|({protocol}[^,]+)),(|({action}[^,]*)),'] |
| edit_regex_field | src_translated_ip | ['THREAT,([^,]*,){5}({src_translated_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))'] | [',THREAT,([^,]*,){5}({src_translated_ip}((([0-9a-fA-F.]{0,4}):{1,2}){1,7}([0-9a-fA-F]){0,4})|(((25[0-5]|(2[0-4]|1\d|[0-9]|)\d)\.?\b){4}))'] |
| edit_regex_field | src_translated_port | ['THREAT,([^,]*,){22}({src_translated_port}\d+)'] | [',THREAT,([^,]*,){22}({src_translated_port}\d+)'] |
| edit_regex_field | src_user | ['THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] | [',THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),'] |
| edit_regex_field | threat_category | ['THREAT,([^,]*,){65}({threat_category}[^,]+),', '\(9999\),(("[^"]+?"|[^,]*),){36}(N/A|unknown|({threat_category}[^,]+)),'] | [',THREAT,([^,]*,){65}({threat_category}[^,]+),', '\(9999\),(("[^"]+?"|[^,]*),){36}(N/A|unknown|({threat_category}[^,]+)),'] |
| edit_regex_field | threat_id | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,'] | [',({threat_id}[^,]+?)?,({categories}({category}[^,]+?))?,({severity}({alert_severity}(?i)(low|medium|high|critical|informational))),({direction}[^,]+?)?,([^,]*,){2}({src_location}[^,]+?)?,({dest_country}[^,]+?)?,(([^,]*,){35}"+\s*({=categories}({=category}[^,\n"]+)\s*[^"]*)"+,)?'] |
| edit_regex_field | time | ['((?:1969-[^,]+?)|({time}\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d\.\d+[\+-]\d+:\d+))', 'THREAT,([^,]*,){2}({time}[^,]+),'] | ['((?:1969-[^,]+?)|({time}\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d\.\d+[\+-]\d+:\d+))', ',THREAT,([^,]*,){2}({time}[^,]+),'] |
| edit_regex_field | uri_path | ['THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] | [',THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |
| edit_regex_field | uri_query | ['THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] | [',THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |
| edit_regex_field | url | ['THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))', 'THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] | [',THREAT,([^,]*,){27}([\\"]*(({url}({malware_url}[^<>".,]+(?:\.[^<>\/\s,]+)?\/[^<>]*?))|({file_name}({malware_file_name}[^<>,]+?)|[^,]*?)[\\\/]*"+,))', ',THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |
| edit_regex_field | user | ['THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),', 'THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] | [',THREAT,([^,]*,){8}\s*(({email_address}[^@,]+@[^\.]+\.[^,]+)|(?:({src_domain}[^\s,\\]+)\\*)?({src_user}({user}[\w\.\-\!\#\^\~]{1,40}\$?))),', ',THREAT,url,\d+,[^,]*,([A-Fa-f0-9:.]+,){2,4}[^,]*,(|x-fwd-for: [^,]+|({email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({domain}[^\\,]+)\\+)?({user}[\w\.\-\!\#\^\~]{1,40}\$?)),(|({dest_email_address}([A-Za-z0-9]+[!#$%&\'+\/=?^_`~.\-])*[A-Za-z0-9]+@({dest_email_domain}[^\]\s"\\,;\|]+\.[^\]\s"\\,;\|]+))|(({dest_domain}[^\\,]+)\\+)?({dest_user}[\w\.\-\!\#\^\~]{1,40}\$?)|({dest_user_full_name}([^\s,]+[\s,])+[^,]+)),'] |
| edit_regex_field | virtual_station_name | ['THREAT,([^,]*,){11}({virtual_station_name}[^,]+?)\s*,'] | [',THREAT,([^,]*,){11}({virtual_station_name}[^,]+?)\s*,'] |
| edit_regex_field | web_domain | ['THREAT,([^,]*,){27}\\?("+)?.*?({web_domain}[^\/\.\s]+(?i)(\.(com|net|info|edu|org|gov|co|jp|ru|de|ir|it|in|fr|info|pl|nl|es|gr|cz|eu|tv|me|jp|ca|cn|uk|my|cc|id|us|nz|biz|club|io|gg|fi|au|st|tw|asia|sg|ie|li|za|ai|ms|mx))+)[\\\/\s:"]', 'THREAT,([^,]*,){27}\\?("+)?.*?({web_domain}[^\/\.\s]+(?i)(\.(com|net|info|edu|org|gov|co|jp|ru|de|ir|it|in|fr|info|pl|nl|es|gr|cz|eu|tv|me|jp|ca|cn|uk|my|cc|id|us|nz|biz|club|io|gg|fi|au|st|tw|asia|sg|ie|li|za|ai|ms|mx))+)[\\\/\s:"]', 'THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] | [',THREAT,([^,]*,){27}\\?("+)?({web_domain}[^\/\s]+(?i)(\.(com|net|info|edu|org|gov|co|jp|ru|de|ir|it|in|fr|info|pl|nl|es|gr|cz|eu|tv|me|jp|ca|cn|uk|my|cc|id|us|nz|biz|club|io|gg|fi|au|st|tw|asia|sg|ie|li|za|ai|ms|mx))+)[\\\/\s:"]', ',THREAT,([^,]*,){27}\\?("+)?.*?({web_domain}[^\/\.\s]+(?i)(\.(com|net|info|edu|org|gov|co|jp|ru|de|ir|it|in|fr|info|pl|nl|es|gr|cz|eu|tv|me|jp|ca|cn|uk|my|cc|id|us|nz|biz|club|io|gg|fi|au|st|tw|asia|sg|ie|li|za|ai|ms|mx))+)[\\\/\s:"]', ',THREAT,url,.+?"+(?:\\|({url}(({dest_ip}\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|({web_domain}[^\\\/\s:,"]+))(:({dest_port}\d+))?({uri_path}\/[^\?\s]*?)?(\/|({uri_query}\?[^\s]*?))?))\\?"*,(9999)?\(9999\),'] |