 Security Content c2304.1_63.6 Changelog
========================================

This Changelog document  includes updates to Correlation Rules  from content package c2206.2_97_63.5 to c2304.1_63.6.
* This log lists updates to the available correlation rules. It includes the name of the rule that changed, the date of the change, and a description of the modification.

Correlation Rules
-----------------

|                                                  Correlation Rule                                                  |                                                                                                                                                                                          Description                                                                                                                                                                                           | Change Status | Change&nbsp;Date |      Activity Type       |
|:------------------------------------------------------------------------------------------------------------------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:-----------:|:-----------:|:------------------------:|
|                                    NTDS copied from shadow copy with a command.                                    |                                                                                                              A shadowcopy command was used to change the location of the NTDS database via copy.exe process. This is usually a sign of attempting to do a NTDS credentials dump.                                                                                                               |     New     | 2023-07-03  |      process-create      |
|                                      UBA: Multiple VPN logins from single IP.                                      |                                                                                                                                                Multiple VPN login attempts were detected from a single IP address within a specific time frame.                                                                                                                                                |     New     | 2023-10-10  |        vpn-login         |
|                               Bitsadmin 'setnotifycmdline' persistent task executed.                               |                                                                    Bitsadmin setmodifycmdline persistence task was executed. Actors can use the BITS SetNotifyCmdLine method to execute a program that runs after a job finishes transferring data or after a job enters a specified state in order to persist on a system.                                                                    |     New     | 2023-07-03  |      process-create      |
|                         Arbitrary command assigned to a file association via the registry                          |                                                                                                         Arbitrary command was assigned to a file association via the registry. Attackers can modify the command key values and cause arbitrary commands to execute during file access.                                                                                                         |     New     | 2023-02-10  |     registry-modify      |
|                                         AWS CloudWatch log stream deleted                                          |                                                                                                                       Attackers can delete AWS CloudWatch streams to stop logs from being sent to those streams, thus removing evidence of their presence in the system.                                                                                                                       |     New     | 2023-05-31  |                          |
|                  Disable windows crash dumps through the registry with the registry command tool.                  |                        Windows crash dumps was disable through the registry via the registry command tool. Crash dumps are created whenever the system experiences a crash, and contain a dump of the its memory. Attackers can disable crash dumps through the 'CrashDumpEnabled' registry value, thus making sure no traces are left when or if a crash will occurs.                         |     New     | 2023-07-31  |     registry-create      |
|                     File added to the active setup registry key with the registry command tool                     |                                                                            Active Setup is a Windows mechanism that is used to execute programs when a user logs in. Attacker can change the program list via the registry, gaining persistency by causing their own malicious programs to be executed at a logon.                                                                             |     New     | 2023-03-22  |      process-create      |
|                                         GCP instance logon script creation                                         |                                                                 GCP instances can be assigned a logon script from the compute service by modifying the metadata keys of an instance. Attackers can leverage this feature to include their own malicious script and gain elevated permissions and persistency on the instance.                                                                  |     New     | 2023-05-31  |                          |
|                               Large amount of outgoing emails sent to a single user                                |                                                                                                                                         A large amount of outgoing emails was sent to a single user which could be an indication of data exfiltration.                                                                                                                                         |     New     | 2023-02-10  |        email-send        |
|                                          UBA: Internet settings modified.                                          |                                                                                                                         Internet settings were modified on the system. Modifying settings can allow attackers to gain unauthorized access to our computer or network.                                                                                                                          |     New     | 2023-10-10  |                          |
|                      SilentCleanup UAC bypass by manually activating the SilentCleanup task.                       |                                                                                         UAC bypass SilentCleanup was performed by manually activating the SilentCleanup task. The attacker abused the silentcleanup task schedule to gain high privilege execution bypassing the User control account.                                                                                         |     New     | 2023-09-04  |      process-create      |
|                                                    Shutdown UFC                                                    |                                                                                                          The UFC (Uncomplicated Firewall) can be disabled through the command line, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                                                                          |     New     | 2023-05-30  |      process-create      |
|                                            SAM copied from shadow copy                                             |                                                                                                  A Security Accounts Manager(SAM) was copied from a shadow copy. SAM tables contain password hashes of users on the system and can be used in credential dumps to avoid file access defenses.                                                                                                  |     New     | 2023-06-01  |        file-copy         |
|                                           NTDS copied from shadow copy.                                            |                                                                                                                      A shadowcopy command was used to change the location of the NTDS database via file activity. This activity may be an attempt at credential dumping.                                                                                                                       |     New     | 2023-07-03  |        file-copy         |
|                                              Azure event hub deleted.                                              |                                                                                                             Azure event hub was deleted. Attackers can delete Azure event hubs to stop logs from being sent to those hubs, thus removing evidence of their presence in the system.                                                                                                             |     New     | 2023-09-04  |                          |
|                                                 Lsass process dump                                                 |                                                                                                                                             LSASS can store credentials and the memory can be dumped to harvest encrypted or plaintext passwords.                                                                                                                                              |     New     | 2023-03-22  |      process-create      |
|                                     Sensitive database copy with esentutl.exe                                      |                                                                                                                                                                           Sensitive database copy with esentutl.exe.                                                                                                                                                                           |     New     | 2023-03-29  |      process-create      |
|       MMC Dll hijacking and UAC bypass via COR_PROFILER registry modification with the registry command tool       |                                                                                                                                            MMC Dll hijacking and UAC bypass via COR_PROFILER registry modification with the registry command tool.                                                                                                                                             |     New     | 2023-03-29  |      process-create      |
|                                 Domain controller SPN added to an endpoint object                                  |                                                            A new active directory object has been created indicating a brand new domain controller. When this occurs, all active directory information and secrets are copied to the new domain controller. This is notable as the specific events observed do not occur regularly.                                                            |     New     | 2023-06-01  |                          |
|                     Windows logon script added to the registry with the registry command tool                      |                                                                                     The 'UserInitLogonScript' is a registry key that stores initialization scripts intended to execute when a user logins. Attackers can insert their own malicious script to this key, gaining persistence on the system.                                                                                     |     New     | 2023-03-29  |      process-create      |
|                                           Modify an ETW with logman.exe                                            |                           ETWs (event tracing for Windows) are logging components that audit events for applications and services such as Microsoft Defender, PowerShell, and other event viewer logs. By executing the log manager process (logman.exe), attackers can disable any ETW, stopping logs from being audited and allowing them to sneak by detections.                            |     New     | 2023-05-30  |      process-create      |
|                                   UAC bypass by masquerading trusted directories                                   |                                                                                                                     User access control (UAC) bypass was setup by masquerading trusted directories which could be indication of elevation abuse and privilege escalation.                                                                                                                      |     New     | 2023-02-10  |      process-create      |
|                                 Add an 'allow' rule in Microsoft Defender firewall                                 |                                                                                        The command line tool netsh.exe allows attackers do create Microsoft Defender firewall network rules, possibly enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                                                        |     New     | 2023-05-30  |      process-create      |
|                                       UBA: User access from multiple hosts.                                        |                                                                                                                                                                         A single user logged in from multiple devices.                                                                                                                                                                         |     New     | 2023-11-01  |                          |
|                                  Lsass process dump with rundll minidump library                                   |                                                                                                                                             LSASS can store credentials and the memory can be dumped to harvest encrypted or plaintext passwords.                                                                                                                                              |     New     | 2023-03-22  |      process-create      |
|         Wreset UAC bypass by modifying shell configuration in the registry with the registry command tool          |                                                                                                       User access control(UAC) bypass has been set up by modifying shell configuration in the registry with the registry command tool. Bypassing UAC can be used to elevate privileges.                                                                                                        |     New     | 2023-03-22  |      process-create      |
|                                        Shadow copy creation with vssadmin.                                         |                                                                                           A Shadow Copy was created using operating systems utilities which could indicate possible credential theft. This process can be considered normal behavior but it is still notable to track such activity.                                                                                           |     New     | 2023-07-03  |      process-create      |
|          Arbitrary command assigned to a file association via the registry with the registry command tool          |                                                                                         Arbitrary command was assigned to a file association via the registry with the registry command tool. Attackers can modify the command key values and cause arbitrary commands to execute during file access.                                                                                          |     New     | 2023-02-10  |      process-create      |
|             Windows event viewer log disabled by modifying the audit policy using the audit policy CLI             |                                                            Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by using the 'auditpol.exe', which can directly disable or limit important event logs such as security.                                                            |     New     | 2023-03-29  |      process-create      |
|                         Disabling the security log by creating the 'MiniNt' registry key.                          | Windows Security Log was disabled by creating the 'MiniNt' registry key. Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by creating the 'MiniNt' registry key. Creating this key causes Windows to malfunction and the system will stop auditing events to the security log. |     New     | 2023-09-04  |     registry-create      |
|                                        Windows event viewer service stopped                                        |                                                             Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by directly shutting down the event logging service, causing event viewer auditing operation to stop.                                                             |     New     | 2023-05-29  |       service-stop       |
|                                         AWS instance logon script creation                                         |                                                          AWS instances can be assigned a logon script from the EC2 service by modifying the 'userdata' property in the instance attributes. Attackers can leverage this feature to include their own malicious script and gain elevated permissions and persistency on the instance.                                                           |     New     | 2023-05-31  |                          |
|                                         Cached Credential Dump via Cmdkey                                          |                                                                                                          Cmdkey.exe was used to look for cached credentials. Attackers may dump credentials to get account logins from the operation system and software to perform lateral movement.                                                                                                          |     New     | 2023-06-01  |      process-create      |
|                             Multiple badge access failures detected on multiple doors.                             |                                                                                                                                                    Multiple badge access failures detected on multiple doors within a specified time frame.                                                                                                                                                    |     New     | 2023-11-01  | physical_location-access |
|                                          Lsass dump creation with taskmgr                                          |                                                                                                                                             LSASS can store credentials and the memory can be dumped to harvest encrypted or plaintext passwords.                                                                                                                                              |     New     | 2023-03-22  |        file-write        |
|                             UBA: Multiple failed VPN login attempts from a single IP.                              |                                                                                                                                  Multiple failed login attempts were detected from a single IP address via VPN accounts, which indicates brute-force attack.                                                                                                                                   |     New     | 2023-10-10  |        vpn-login         |
|                            Recycle bin autostart persistence via registry modification                             |                                                                                                                                                     Recycle bin registry object has been modified which could indicate malware persistence                                                                                                                                                     |   Updated   | 2023-04-12  |     registry-create      |
|                                           Shadow copy creation with WMI.                                           |                                                                                  A Shadow Copy was created using operating systems utilities via the wmic.exe which could indicate possible credential theft. This process can be considered normal behavior but it is still notable to track such activity.                                                                                   |     New     | 2023-07-03  |      process-create      |
|                                   Powershell keylogging using SetWindowsHook API                                   |                                                                                                                                                      User tried to access credentials from keylogging using Powershell SetWindowsHook API                                                                                                                                                      |   Updated   | 2023-04-12  |      script-execute      |
|                    System restore disabled through the registry with the registry command tool                     |                                                                                                                                                          System restore disabled through the registry with the registry command tool.                                                                                                                                                          |     New     | 2023-03-29  |      process-create      |
|                                                GCP log sink deleted                                                |                                                                                                                          Attackers can delete GCP log sinks to stop logs from being sent to those log sinks, thus removing evidence of their presence in the system.                                                                                                                           |     New     | 2023-05-31  |                          |
|                                 Disable windows crash dumps through the registry.                                  |                                       Windows crash dumps was disabled through the registry. Crash dumps are created whenever the system experiences a crash, and contain a dump of the its memory. Attackers can disable crash dumps through the 'CrashDumpEnabled' registry value, thus making sure no traces are left when or if a crash will occurs.                                       |     New     | 2023-07-31  |      process-create      |
|               Recycle bin autostart persistence via registry modification with registry command tool               |                                                                                                                                       Recycle bin registry object has been modified using registry command tool which could indicate malware persistence                                                                                                                                       |   Updated   | 2023-04-12  |      process-create      |
|                                               AWS role brute force.                                                |                                                                                                                               An AWS role is assumed by user. Roles are used to delegate access to users or services and should not be easily granted to users.                                                                                                                                |     New     | 2023-07-03  |       role-assume        |
|                                Disable Microsoft Defender firewall in the registry.                                |                                               Microsoft Defender firewall in the registry was disabled. The Defender firewall registry value 'EnableFirewall' allows attackers to disable the Microsoft Defender firewall by setting it to 0, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                |     New     | 2023-09-04  |     registry-create      |
|                Disable Microsoft Defender firewall in the registry with the registry command tool.                 |                                Microsoft Defender firewall in the registry was disabled via the registry command tool. The Defender firewall registry value 'EnableFirewall' allows attackers to disable the Microsoft Defender firewall by setting it to 0, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                 |     New     | 2023-07-31  |      process-create      |
|                                     Native windows network sniffing with netsh                                     |                                                                                                                                     Native windows network sniffing with netsh was performed which could be an indicator of credentials being compromised.                                                                                                                                     |     New     | 2023-02-10  |      process-create      |
|                                           AWS powerful policy creation.                                            |                                              Policy was created with critical permissions. Policies in AWS are the documents that dictates what permissions are granted to identites and resources. By creating a new policy or modifying existing one, an attacker might provide himself arbitrary permissions and perform privilege escalation.                                              |   Updated   | 2023-11-30  |      policy-create       |
|                                    File added to the active setup registry key                                     |                                                                            Active Setup is a Windows mechanism that is used to execute programs when a user logs in. Attacker can change the program list via the registry, gaining persistency by causing their own malicious programs to be executed at a logon.                                                                             |     New     | 2023-03-22  |     registry-create      |
|                                     Bitsadmin remote download with powershell.                                     |                                                                                                                   User downloaded BITSAdmin tool remotely using Powershell. BITS jobs could be used for persisting or evading detection after executing malicious payloads.                                                                                                                    |     New     | 2023-07-03  |      script-execute      |
|          Disabling the security log by creating the 'MiniNt' registry key with the registry command tool.          |                                     Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by creating the 'MiniNt' registry key. Creating this key causes Windows to malfunction and the system will stop auditing events to the security log.                                      |     New     | 2023-07-31  |      process-create      |
|                                           UBA: Netcat process detected.                                            |                                                                                                                             The netcat process was detected on a system. This can allow attackers to steal sensitive data from untrusted clients over the network.                                                                                                                             |     New     | 2023-11-01  |      process-create      |
|                Setup UAC bypass by modifying sdclt.exe related shell configuration in the registry                 |                                                                                                      User access control (UAC) bypass was setup by modifying sdclt.exe related shell configuration in the registry which could be indication of elevation abuse and privilege escalation.                                                                                                      |     New     | 2023-02-10  | registry-create:success  |
|                           Windows event viewer service stopped using the service console                           |                                                             Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by directly shutting down the event logging service, causing event viewer auditing operation to stop.                                                             |     New     | 2023-05-29  |      process-create      |
| Setup UAC bypass by modifying sdclt.exe related shell configuration in the registry with the registry command tool |                                                                                              User access control(UAC) bypass has been set up by modifying sdclt.exe related shell configuration in the registry with the registry command tool. Bypassing UAC can be used to elevate privileges.                                                                                               |     New     | 2023-03-22  |      process-create      |
|              Reduce the size of the security log through the registry with the registry command tool.              |                                        Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by reducing the size of the security log file, causing incoming events to consistently overwrite older events or even to not be logged at all.                                         |     New     | 2023-07-31  |      process-create      |
|              SilentCleanup UAC bypass by windir registry modification with the registry command tool               |                                                                                                               User access control(UAC) bypass has been set up by modifying the windir registry with the registry command tool. Bypassing UAC can be used to elevate privileges.                                                                                                                |     New     | 2023-03-22  |      process-create      |
|                                       Shadow copies deleted with powershell                                        |                                                                                                                                                                    Volume shadow copies have been deleted using Powershell                                                                                                                                                                     |   Updated   | 2023-04-12  |      script-execute      |
|                          Windows event viewer service disabled using the service console                           |                                                             Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by directly shutting down the event logging service, causing event viewer auditing operation to stop.                                                             |     New     | 2023-05-29  |      process-create      |
|                                         UBA: Data exfiltration by e-mail.                                          |                                                                                                                                                        User has sent over 13MB of data. This indicates possible exfiltration by email.                                                                                                                                                         |     New     | 2023-10-11  |        email-send        |
|                                         Disable powershell command history                                         |                                                                                        PowerShell automatically records command history and stores them in a system file. This configuration can be disabled with PowerShell command, allowing malicious command to avoid being tracked by the program.                                                                                        |     New     | 2023-05-30  |      script-execute      |
|                                               WinRM network traffic                                                |                                                                                      WinRM network traffic was seen. Windows Remote Management (WinRM) allows users to interact with remove systems to run executables or modify services. It can be leverages by adversaries to act as a logged-on user.                                                                                      |     New     | 2023-03-22  |                          |
|                                     SAM copied from shadow copy with a command                                     |                                                                                         A Security Accounts Manager(SAM) was copied from a shadow copy via command line. SAM tables contain password hashes of users on the system and can be used in credential dumps to avoid file access defenses.                                                                                          |     New     | 2023-06-01  |      process-create      |
|                               Large amount of failed connections from a user per app                               |                                                                                                              An application has received a large amount of failed login attempts from a single user. This could indicate a brute force password guessing attack is taking place.                                                                                                               |     New     | 2023-03-29  |                          |
|                   Setup UAC bypass by modifying MS settings shell configuration in the registry                    |                                                                                                        User access control (UAC) bypass was setup by modifying MS settings shell configurations in the registry which could be indication of elevation abuse and privilege escalation.                                                                                                         |     New     | 2023-02-10  | registry-create:success  |
|                                    Windows logon script added to the registry.                                     |                                                                                    The 'UserInitLogonScript' is a registry key that stores initialization scripts intended to execute when a user logs in. Attackers can insert their own malicious script to this key, gaining persistence on the system.                                                                                     |     New     | 2023-09-04  |     registry-create      |
|                                          UBA: Data exfiltration by print.                                          |                                                                                                                                            A user sends a large amount of data for print. This indicates an attempt at data exfiltration by print.                                                                                                                                             |     New     | 2023-10-11  |     printer-activity     |
|                    Installation of a password filter DLL via the notification packages registry                    |                                                                                                                A password filter DLL was installed via the notification packages registry. Attacks can use these password filters to get credentials from computers or domains.                                                                                                                |     New     | 2023-02-10  |     registry-modify      |
|                              Disable Microsoft Defender firewall in the command line                               |                                                                                                 The command line tool netsh.exe allows attackers do disable the Microsoft Defender firewall, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                                                                 |     New     | 2023-03-29  |      process-create      |
|                                         Disable history collection in Unix                                         |                                                                                        History collection can be disabled in unix shells by modifying the history environment variables. With the history disabled, attackers can perform malicious commands that will not be tracked by the collector.                                                                                        |     New     | 2023-05-29  |      process-create      |
|                              Create symbolic link for a shadow copy using mklink.exe                               |                                                                                                 Attacker can create symbolic link to shadow copy and used this symbolic link for access files in the shadow copy including sensitive files , System Boot Key and browser offline credentials.                                                                                                  |     New     | 2023-05-29  |      process-create      |
|               Windows event viewer audit policy reverted to default state using the audit policy CLI               |                                Windows event logs can be disabled by attackers to limit the information that's being recorded by the system and used for detections. One way to achieve this is by using the 'auditpol.exe', which can clear the logging policy, stopping critical logs there were enabled beforehand from being recorded by the event viewer.                                 |     New     | 2023-05-29  |      process-create      |
|                                         Multiple password resets by user.                                          |                                                                                                  Multiple password resets by user across multiple data sources. Password reset may aid adversaries in maintaining access to credentials and certain permission levels within an environment.                                                                                                   |     New     | 2023-11-01  |   user-password-reset    |
|                                Disable Microsoft Defender firewall with powershell                                 |                                                                                         The PowerShell command “Set-NetFirewallProfile” allows attackers do disable the Microsoft Defender firewall, enabling potentially malicious network communications to be allowed into and out of the endpoint.                                                                                         |     New     | 2023-03-29  |      process-create      |
|                                        Shadow copy creation with PowerShell                                        |                                                                                                                                                                             Shadow copy creation with PowerShell.                                                                                                                                                                              |     New     | 2023-03-29  |      process-create      |
|                                          AWS CloudWatch log group deleted                                          |                                                                                                                        Attackers can delete AWS CloudWatch groups to stop logs from being sent to those groups, thus removing evidence of their presence in the system.                                                                                                                        |     New     | 2023-05-31  |                          |
|                                 Login hook file created with the defaults command.                                 |                             Login hook file created with the defaults command. A login hook is a file that points to a specific script to execute with root privileges upon user logon. Attackers can modify the login hook file ('com.apple.loginwindow.plist') to include their own malicious scripts in the login execution, gaining persistence in the system.                             |     New     | 2023-07-03  |      process-create      |
|                                          Remove an ETW through PowerShell                                          |                      ETWs (event tracing for Windows) are logging components that audit events for applications and services such as Microsoft Defender, PowerShell, and other event viewer logs. By calling the PowerShell function 'Remove-EtwTraceProvider', attackers can disable any ETW, stopping logs from being audited and allowing them to sneak by detections.                      |     New     | 2023-05-30  |      script-execute      |
|                                     File association changed with 'assoc.exe'                                      |                                                                                                                 File association was changed with 'assoc.exe'. Attackers can change the association of a file to cause execution of malicious code upon opening a normal file.                                                                                                                 |     New     | 2023-02-10  |      process-create      |
|                                            NTDS dump with ntds utility.                                            |                                                                                       The ntds.dit was dumped via ntdsutil.exe. NTDS file acts as a database for Active Directory and stores all its data including all the credentials and this activity could be an indication of credentials dumping.                                                                                       |     New     | 2023-07-03  |      process-create      |
|                                            Enable WinRM with powershell                                            |                                                                                    WinRM was enabled using powershell. Windows Remote Management (WinRM) allows users to interact with remove systems to run executables or modify services. It can be leverages by adversaries to act as a logged-on user.                                                                                    |     New     | 2023-03-22  |      script-execute      |
|                                              AWS CloudTrail disabled                                               |                                                                                                           Attackers can disable AWS CloudTrail logging in a cloud account, stopping audit logs from that account from being recorded and allowing the attackers to evade detection.                                                                                                            |     New     | 2023-05-31  |                          |
|                                     LSA registry hive download with a command                                      |                                                                                                            LSA registry hive was downloaded via commandline arguments. LSA secrets can contain credential materials and this activity could be an indication of credential dumping.                                                                                                            |     New     | 2023-02-10  |      process-create      |
|                                      UBA: Attempts bruteforce authentication.                                      |                                                                                                                                                      A user has a large number of failed login attempts, indicates a brute force attack.                                                                                                                                                       |     New     | 2023-11-01  |                          |

